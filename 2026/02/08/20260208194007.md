# Commit: 8fb7231efad7f70bb157635261ae62c42ffa1259
## Message: Debug: Hide drop table in non-debug builds
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/debug/DatabaseTableDebugFragment.kt

app/src/main/res/xml/debug_preferences_database_table.xml

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/debug/DatabaseTableDebugFragment.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/debug/DatabaseTableDebugFragment.kt
index 24e34afb0b..2a9a1fabd0 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/debug/DatabaseTableDebugFragment.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/debug/DatabaseTableDebugFragment.kt
@@ -18,6 +18,7 @@ import androidx.preference.PreferenceViewHolder
 import com.google.android.material.datepicker.CalendarConstraints
 import com.google.android.material.datepicker.MaterialDatePicker
 import com.google.android.material.dialog.MaterialAlertDialogBuilder
+import nodomain.freeyourgadget.gadgetbridge.BuildConfig
 import nodomain.freeyourgadget.gadgetbridge.GBApplication
 import nodomain.freeyourgadget.gadgetbridge.R
 import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils
@@ -65,7 +66,10 @@ class DatabaseTableDebugFragment : AbstractDebugFragment() {
 
         onClick(PREF_DEBUG_CLEAR_TABLE) { clearTable(tableName) }
 
-        onClick(PREF_DEBUG_DROP_TABLE) { dropTable(tableName) }
+        if (BuildConfig.DEBUG) {
+            findPreference<Preference>(PREF_DEBUG_DROP_TABLE)?.isVisible = true
+            onClick(PREF_DEBUG_DROP_TABLE) { dropTable(tableName) }
+        }
 
         val ddl = getTableDdl(tableName)
 
diff --git a/app/src/main/res/xml/debug_preferences_database_table.xml b/app/src/main/res/xml/debug_preferences_database_table.xml
index 5c03a1bd79..81234bed37 100644
--- a/app/src/main/res/xml/debug_preferences_database_table.xml
+++ b/app/src/main/res/xml/debug_preferences_database_table.xml
@@ -36,13 +36,15 @@
             android:summary="Warning! By pushing this button all data from the table will be deleted."
             android:title="Clear table" />
 
+        <!-- only in debug builds -->
         <Preference
             android:dependency="dangerous_actions"
             android:icon="@drawable/ic_delete_forever"
             android:key="pref_debug_drop_table"
             android:persistent="false"
             android:summary="Warning! By pushing this button the table will be dropped to the database and must be re-created."
-            android:title="Drop table" />
+            android:title="Drop table"
+            app:isPreferenceVisible="false" />
     </PreferenceCategory>
 
     <PreferenceCategory
```
-----------------------------------
