# Commit: 8d4727b01c305ec827a1813ae5b4bcfa9373e5ef
## Message: Garmin: Experimental app configuration support
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfig.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigActivity.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigFragment.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventAppConfig.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/AppConfigHandler.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/UuidUtil.java

app/src/main/proto/garmin/gdi_app_config_service.proto

app/src/main/AndroidManifest.xml

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AbstractAppManagerFragment.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AppManagerFragmentInstalledWatchfaces.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEvent.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/EventHandler.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminCoordinator.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceApp.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DeviceService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/AbstractDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/ServiceDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/ProtocolBufferHandler.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/http/GarminJson.java

app/src/main/proto/garmin/gdi_smart_proto.proto

## Diff:
```
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
index 72be617bea..b573d14ada 100644
--- a/app/src/main/AndroidManifest.xml
+++ b/app/src/main/AndroidManifest.xml
@@ -301,6 +301,11 @@
             android:label="@string/title_activity_appmanager"
             android:launchMode="singleTop"
             android:parentActivityName=".activities.ControlCenterv2" />
+        <activity
+            android:name=".activities.appmanager.config.DynamicAppConfigActivity"
+            android:label="@string/app_configure"
+            android:launchMode="singleTop"
+            android:parentActivityName=".activities.appmanager.AppManagerActivity" />
         <activity
             android:name=".activities.appmanager.RebbleAppStoreActivity"
             android:label="@string/activity_title_rebble_app_store"
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AbstractAppManagerFragment.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AbstractAppManagerFragment.java
index 2e63debcd6..5a4eeaa308 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AbstractAppManagerFragment.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AbstractAppManagerFragment.java
@@ -235,6 +235,7 @@ public abstract class AbstractAppManagerFragment extends Fragment {
 
             GBDeviceApp app = new GBDeviceApp(uuid, appName, appCreator, appVersion, appType, previewImage);
             app.setConfigurable(appFromIntent.isConfigurable());
+            app.setCanBeStarted(appFromIntent.isCanBeStarted());
             app.setUpToDate(appFromIntent.isUpToDate());
             app.setOnDevice(true);
 
@@ -591,6 +592,10 @@ public abstract class AbstractAppManagerFragment extends Fragment {
         if (!selectedApp.isOnDevice() || selectedApp.getType() != GBDeviceApp.Type.APP_GENERIC) {
             menu.removeItem(R.id.appmanager_app_start);
         }
+        if (!selectedApp.isCanBeStarted()) {
+            menu.removeItem(R.id.appmanager_watchface_activate);
+            menu.removeItem(R.id.appmanager_app_start);
+        }
         if (!selectedApp.isInCache()) {
             menu.removeItem(R.id.appmanager_app_edit);
             menu.removeItem(R.id.appmanager_app_reinstall);
@@ -714,6 +719,7 @@ public abstract class AbstractAppManagerFragment extends Fragment {
             final Intent startIntent = new Intent(requireContext().getApplicationContext(), appConfigurationActivity);
             startIntent.putExtra(DeviceService.EXTRA_APP_UUID, selectedApp.getUUID());
             startIntent.putExtra(GBDevice.EXTRA_DEVICE, mGBDevice);
+            startIntent.putExtra("app_name", selectedApp.getName()); // FIXME: use constant
             startActivity(startIntent);
             return true;
         } else if (itemId == R.id.appmanager_app_openinstore) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AppManagerFragmentInstalledWatchfaces.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AppManagerFragmentInstalledWatchfaces.java
index 20faeb8bee..eb7a159904 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AppManagerFragmentInstalledWatchfaces.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/AppManagerFragmentInstalledWatchfaces.java
@@ -54,9 +54,6 @@ public class AppManagerFragmentInstalledWatchfaces extends AbstractAppManagerFra
 
     @Override
     protected boolean filterApp(GBDeviceApp gbDeviceApp) {
-        if (gbDeviceApp.getType() == GBDeviceApp.Type.WATCHFACE) {
-            return true;
-        }
-        return false;
+        return gbDeviceApp.getType() == GBDeviceApp.Type.WATCHFACE;
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfig.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfig.kt
new file mode 100644
index 0000000000..e2ea4de884
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfig.kt
@@ -0,0 +1,27 @@
+package nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config
+
+import android.os.Parcelable
+import kotlinx.parcelize.Parcelize
+
+@Parcelize
+sealed class DynamicAppConfig(open val key: String) : Parcelable {
+    class AppConfigBoolean(
+        override val key: String,
+        val value: Boolean,
+    ) : DynamicAppConfig(key)
+
+    class AppConfigString(
+        override val key: String,
+        val value: String,
+    ) : DynamicAppConfig(key)
+
+    class AppConfigInteger(
+        override val key: String,
+        val value: Int,
+    ) : DynamicAppConfig(key)
+
+    class AppConfigFloat(
+        override val key: String,
+        val value: Float,
+    ) : DynamicAppConfig(key)
+}
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigActivity.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigActivity.kt
new file mode 100644
index 0000000000..ed5b485052
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigActivity.kt
@@ -0,0 +1,55 @@
+package nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config
+
+import android.content.Intent
+import android.os.Bundle
+import android.widget.Toast
+import androidx.preference.PreferenceFragmentCompat
+import nodomain.freeyourgadget.gadgetbridge.R
+import nodomain.freeyourgadget.gadgetbridge.activities.AbstractPreferenceFragment
+import nodomain.freeyourgadget.gadgetbridge.activities.AbstractSettingsActivityV2
+import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice
+import nodomain.freeyourgadget.gadgetbridge.model.DeviceService
+import nodomain.freeyourgadget.gadgetbridge.util.GB
+import java.util.UUID
+
+class DynamicAppConfigActivity : AbstractSettingsActivityV2() {
+    private lateinit var device: GBDevice
+    private lateinit var appId: String
+    private lateinit var appName: String
+
+    override fun newFragment(): PreferenceFragmentCompat {
+        return DynamicAppConfigFragment.newInstance(device, appId, appName)
+    }
+
+    override fun onCreate(savedInstanceState: Bundle?) {
+        device = intent.getParcelableExtra<GBDevice?>(GBDevice.EXTRA_DEVICE)!!
+        appId = (intent.getSerializableExtra(DeviceService.EXTRA_APP_UUID) as UUID).toString()
+        appName = intent.getStringExtra("app_name") ?: getString(R.string.unknown)
+
+        super.onCreate(savedInstanceState)
+
+        if (!device.isInitialized) {
+            GB.toast(getString(R.string.watch_not_connected), Toast.LENGTH_SHORT, GB.INFO)
+            finish()
+        }
+    }
+
+    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
+        super.onActivityResult(requestCode, resultCode, data)
+
+        this.fragment?.refreshFromDevice()
+    }
+
+    private val fragment: DynamicAppConfigFragment?
+        get() {
+            val fragmentManager = supportFragmentManager
+            val fragment =
+                fragmentManager.findFragmentByTag(AbstractPreferenceFragment.FRAGMENT_TAG) ?: return null
+
+            if (fragment is DynamicAppConfigFragment) {
+                return fragment
+            }
+
+            return null
+        }
+}
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigFragment.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigFragment.kt
new file mode 100644
index 0000000000..352daa48cf
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/appmanager/config/DynamicAppConfigFragment.kt
@@ -0,0 +1,293 @@
+/*  Copyright (C) 2026 José Rebelo
+
+    This file is part of Gadgetbridge.
+
+    Gadgetbridge is free software: you can redistribute it and/or modify
+    it under the terms of the GNU Affero General Public License as published
+    by the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    Gadgetbridge is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU Affero General Public License for more details.
+
+    You should have received a copy of the GNU Affero General Public License
+    along with this program.  If not, see <https://www.gnu.org/licenses/>. */
+package nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config
+
+import android.content.BroadcastReceiver
+import android.content.Context
+import android.content.Intent
+import android.content.IntentFilter
+import android.os.Bundle
+import android.text.InputType
+import android.widget.Toast
+import androidx.localbroadcastmanager.content.LocalBroadcastManager
+import androidx.preference.DialogPreference
+import androidx.preference.EditTextPreference
+import androidx.preference.Preference
+import androidx.preference.PreferenceScreen
+import androidx.preference.SwitchPreferenceCompat
+import nodomain.freeyourgadget.gadgetbridge.GBApplication
+import nodomain.freeyourgadget.gadgetbridge.R
+import nodomain.freeyourgadget.gadgetbridge.activities.AbstractPreferenceFragment
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigBoolean
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigFloat
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigInteger
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigString
+import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventAppConfig
+import nodomain.freeyourgadget.gadgetbridge.devices.garmin.GarminPreferences
+import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice
+import nodomain.freeyourgadget.gadgetbridge.util.GB
+import org.slf4j.Logger
+import org.slf4j.LoggerFactory
+import java.util.UUID
+
+class DynamicAppConfigFragment : AbstractPreferenceFragment() {
+    private lateinit var device: GBDevice
+    private lateinit var appId: UUID
+    private lateinit var appName: String
+
+    private val preferences: MutableList<DynamicAppConfig> = mutableListOf()
+
+    private val mReceiver: BroadcastReceiver = object : BroadcastReceiver() {
+        override fun onReceive(context: Context?, intent: Intent) {
+            val action = intent.action
+            if (action == null) {
+                LOG.error("Got null action")
+                return
+            }
+
+            when (action) {
+                ACTION_APP_CONFIG_EVENT -> {
+                    val intentDevice = intent.getParcelableExtra<GBDevice?>(GBDevice.EXTRA_DEVICE)!!
+                    if (intentDevice != device) {
+                        LOG.debug("Ignoring intent for device {}, we are {}", intentDevice, device)
+                        return
+                    }
+                    val event = intent.getParcelableExtra<GBDeviceEventAppConfig>(GBDeviceEventAppConfig.EXTRA_EVENT)!!
+                    if (event.uuid != appId) {
+                        LOG.debug("Ignoring intent for app {}, we are {}", event.uuid, appId)
+                        return
+                    }
+
+                    when (event.event) {
+                        GBDeviceEventAppConfig.Event.APP_CONFIG_GET_SUCCESS -> {
+                            preferences.clear()
+                            preferences.addAll(event.configs)
+                        }
+
+                        GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED -> {
+                            GB.toast("Failed to get app configs", Toast.LENGTH_SHORT, GB.INFO)
+                            requireActivity().finish()
+                        }
+
+                        GBDeviceEventAppConfig.Event.APP_CONFIG_SET_SUCCESS -> {
+                            setPrefsEnabled(true)
+                        }
+
+                        GBDeviceEventAppConfig.Event.APP_CONFIG_SET_FAILED -> {
+                            GB.toast("Failed to set app config", Toast.LENGTH_SHORT, GB.INFO)
+                        }
+                    }
+                }
+
+                else -> {
+                    LOG.error("Unknown action {}", action)
+                    return
+                }
+            }
+
+            reload()
+        }
+    }
+
+    private fun setArgs(device: GBDevice, appId: String, appName: String?) {
+        val args: Bundle = arguments ?: Bundle()
+        args.putParcelable(GBDevice.EXTRA_DEVICE, device)
+        args.putString(EXTRA_APP_ID, appId)
+        args.putString(EXTRA_APP_NAME, appName)
+        setArguments(args)
+    }
+
+    override fun onCreatePreferences(savedInstanceState: Bundle?, rootKey: String?) {
+        val arguments = arguments ?: return
+        this.device = arguments.getParcelable<GBDevice?>(GBDevice.EXTRA_DEVICE)!!
+        this.appId = UUID.fromString(arguments.getString(EXTRA_APP_ID, null))!!
+        this.appName = arguments.getString(EXTRA_APP_NAME, null)!!
+
+        LOG.info("Open app config for {}", appId)
+
+        preferenceManager.setSharedPreferencesName("app_config_" + device.address + "_" + appId)
+        setPreferencesFromResource(R.xml.garmin_realtime_settings, rootKey)
+
+        val filter = IntentFilter()
+        filter.addAction(ACTION_APP_CONFIG_EVENT)
+        LocalBroadcastManager.getInstance(requireContext()).registerReceiver(mReceiver, filter)
+    }
+
+    override fun onResume() {
+        super.onResume()
+        reload()
+    }
+
+    override fun onDestroyView() {
+        LocalBroadcastManager.getInstance(requireContext()).unregisterReceiver(mReceiver)
+        super.onDestroyView()
+    }
+
+    fun refreshFromDevice() {
+        preferences.clear()
+        reload()
+        GBApplication.deviceService(device).onAppConfigRequest(appId)
+    }
+
+    fun reload() {
+        val activity = getActivity()
+        if (activity == null) {
+            LOG.error("Activity is null")
+            return
+        }
+
+        val prefScreen = findPreference<PreferenceScreen?>(GarminPreferences.PREF_GARMIN_REALTIME_SETTINGS)
+        if (prefScreen == null) {
+            LOG.error("Preference screen for {} is null", GarminPreferences.PREF_GARMIN_REALTIME_SETTINGS)
+            activity.finish()
+            return
+        }
+
+        if (preferences.isEmpty()) {
+            (activity as DynamicAppConfigActivity).setActionBarTitle(activity.getString(R.string.loading))
+
+            // Disable all existing preferences while loading
+            setPrefsEnabled(false)
+
+            GBApplication.deviceService(device).onAppConfigRequest(appId)
+
+            return
+        }
+
+        prefScreen.removeAll()
+
+        (activity as DynamicAppConfigActivity).setActionBarTitle(appName)
+
+        prefScreen.addPreference(Preference(requireActivity()).apply {
+            key = "header_warning"
+            summary = "Values are not checked, invalid values might break the app"
+            setIcon(R.drawable.ic_warning_gray)
+            isSelectable = false
+            isPersistent = false
+        })
+
+        for (preference in preferences) {
+            val pref: Preference
+            when (preference) {
+                is AppConfigBoolean -> {
+                    pref = SwitchPreferenceCompat(requireActivity())
+                    pref.layoutResource = R.layout.preference_checkbox
+                    pref.setChecked(preference.value)
+                    pref.setOnPreferenceChangeListener { _: Preference?, newValue: Any? ->
+                        LOG.debug("Pref {} bool changed to {}", pref, newValue)
+                        setPrefsEnabled(false)
+                        preferences[preferences.indexOf(preference)] =
+                            AppConfigBoolean(preference.key, newValue as Boolean)
+                        GBApplication.deviceService(device).onAppConfigSet(appId, ArrayList(preferences))
+                        true
+                    }
+                }
+
+                is AppConfigString -> {
+                    pref = EditTextPreference(activity)
+                    pref.dialogTitle = preference.key
+                    pref.setText(preference.value)
+                    pref.summary = preference.value
+                    pref.setOnBindEditTextListener {
+                        it.setInputType(InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS)
+                        it.setSelection(it.getText().length)
+                    }
+                    pref.setOnPreferenceChangeListener { _: Preference?, newValue: Any? ->
+                        LOG.debug("Pref {} string changed to {}", pref, newValue)
+                        setPrefsEnabled(false)
+                        pref.isEnabled = false
+                        preferences[preferences.indexOf(preference)] =
+                            AppConfigString(preference.key, newValue as String)
+                        GBApplication.deviceService(device).onAppConfigSet(appId, ArrayList(preferences))
+                        true
+                    }
+                }
+
+                is AppConfigFloat -> {
+                    pref = EditTextPreference(activity)
+                    pref.dialogTitle = preference.key
+                    pref.setText(preference.value.toString())
+                    pref.summary = preference.value.toString()
+                    pref.setOnBindEditTextListener {
+                        it.setInputType(InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS or InputType.TYPE_CLASS_NUMBER or InputType.TYPE_NUMBER_FLAG_DECIMAL or InputType.TYPE_NUMBER_FLAG_SIGNED)
+                        it.setSelection(it.getText().length)
+                    }
+                    pref.setOnPreferenceChangeListener { _: Preference?, newValue: Any? ->
+                        LOG.debug("Pref {} float changed to {}", pref, newValue)
+                        pref.isEnabled = false
+                        preferences[preferences.indexOf(preference)] =
+                            AppConfigFloat(preference.key, (newValue as String).toFloat())
+                        GBApplication.deviceService(device).onAppConfigSet(appId, ArrayList(preferences))
+                        true
+                    }
+                }
+
+                is AppConfigInteger -> {
+                    pref = EditTextPreference(activity)
+                    pref.dialogTitle = preference.key
+                    pref.setText(preference.value.toString())
+                    pref.summary = preference.value.toString()
+                    pref.setOnBindEditTextListener {
+                        it.setInputType(InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS or InputType.TYPE_CLASS_NUMBER or InputType.TYPE_NUMBER_FLAG_SIGNED)
+                        it.setSelection(it.getText().length)
+                    }
+                    pref.setOnPreferenceChangeListener { _: Preference?, newValue: Any? ->
+                        LOG.debug("Pref {} int changed to {}", pref, newValue)
+                        setPrefsEnabled(false)
+                        preferences[preferences.indexOf(preference)] =
+                            AppConfigInteger(preference.key, (newValue as String).toInt())
+                        GBApplication.deviceService(device).onAppConfigSet(appId, ArrayList(preferences))
+                        true
+                    }
+                }
+            }
+
+            pref.isIconSpaceReserved = false
+            pref.isPersistent = false
+            pref.title = preference.key
+            pref.setKey(preference.key)
+            prefScreen.addPreference(pref)
+        }
+    }
+
+    fun setPrefsEnabled(enabled: Boolean) {
+        val prefScreen = findPreference<PreferenceScreen?>(GarminPreferences.PREF_GARMIN_REALTIME_SETTINGS)
+        if (prefScreen == null) {
+            LOG.error("Preference screen for {} is null", GarminPreferences.PREF_GARMIN_REALTIME_SETTINGS)
+            requireActivity().finish()
+            return
+        }
+        for (i in 0..<prefScreen.preferenceCount) {
+            prefScreen.getPreference(i).isEnabled = enabled
+        }
+    }
+
+    companion object {
+        private val LOG: Logger = LoggerFactory.getLogger(DynamicAppConfigFragment::class.java)
+
+        const val ACTION_APP_CONFIG_EVENT: String = "nodomain.freeyourgadget.gadgetbridge.app_config_event"
+
+        const val EXTRA_APP_ID: String = "app_id"
+        const val EXTRA_APP_NAME: String = "app_name"
+
+        fun newInstance(device: GBDevice, appId: String, appName: String?): DynamicAppConfigFragment {
+            val fragment = DynamicAppConfigFragment()
+            fragment.setArgs(device, appId, appName)
+            return fragment
+        }
+    }
+}
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEvent.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEvent.java
index de1c9e9632..671d6313ce 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEvent.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEvent.java
@@ -44,7 +44,7 @@ public abstract class GBDeviceEvent {
         return getClass().getSimpleName() + ": ";
     }
 
-    public abstract void evaluate(final Context context, final GBDevice device);
+    public abstract void evaluate(@NonNull final Context context, @NonNull final GBDevice device);
 
     /**
      * Helper method to run specific actions configured in the device preferences, upon wear state
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventAppConfig.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventAppConfig.kt
new file mode 100644
index 0000000000..06de2a3102
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventAppConfig.kt
@@ -0,0 +1,66 @@
+/*  Copyright (C) 2026 José Rebelo
+
+    This file is part of Gadgetbridge.
+
+    Gadgetbridge is free software: you can redistribute it and/or modify
+    it under the terms of the GNU Affero General Public License as published
+    by the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    Gadgetbridge is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU Affero General Public License for more details.
+
+    You should have received a copy of the GNU Affero General Public License
+    along with this program.  If not, see <https://www.gnu.org/licenses/>. */
+package nodomain.freeyourgadget.gadgetbridge.deviceevents
+
+import android.content.Context
+import android.content.Intent
+import android.os.Parcelable
+import androidx.localbroadcastmanager.content.LocalBroadcastManager
+import kotlinx.parcelize.Parcelize
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfigFragment
+import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice
+import java.util.UUID
+
+@Parcelize
+class GBDeviceEventAppConfig(
+    val uuid: UUID,
+    val event: Event,
+    val configs: ArrayList<DynamicAppConfig> = ArrayList()
+) : GBDeviceEvent(), Parcelable {
+    override fun toString(): String {
+        val sb = StringBuilder(super.toString())
+        sb.append("event: $event")
+        if (!configs.isEmpty()) {
+            sb.append(", configs: ")
+            for (pref in configs) {
+                sb.append(pref.key).append(", ")
+            }
+            sb.setLength(sb.length - 2)
+        }
+
+        return sb.toString()
+    }
+
+    override fun evaluate(context: Context, device: GBDevice) {
+        val intent = Intent(DynamicAppConfigFragment.ACTION_APP_CONFIG_EVENT)
+        intent.putExtra(GBDevice.EXTRA_DEVICE, device)
+        intent.putExtra(EXTRA_EVENT, this)
+        LocalBroadcastManager.getInstance(context).sendBroadcast(intent)
+    }
+
+    enum class Event {
+        APP_CONFIG_GET_SUCCESS,
+        APP_CONFIG_GET_FAILED,
+        APP_CONFIG_SET_SUCCESS,
+        APP_CONFIG_SET_FAILED,
+    }
+
+    companion object {
+        const val EXTRA_EVENT = "app_config_event"
+    }
+}
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/EventHandler.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/EventHandler.java
index 8134405d67..be881923c8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/EventHandler.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/EventHandler.java
@@ -27,6 +27,7 @@ import androidx.annotation.NonNull;
 import java.util.ArrayList;
 import java.util.UUID;
 
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.capabilities.loyaltycards.LoyaltyCard;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventCameraRemote;
 import nodomain.freeyourgadget.gadgetbridge.model.Alarm;
@@ -96,6 +97,10 @@ public interface EventHandler {
 
     void onAppConfiguration(UUID appUuid, String config, Integer id);
 
+    void onAppConfigRequest(final UUID uuid);
+
+    void onAppConfigSet(final UUID uuid, final ArrayList<DynamicAppConfig> configs);
+
     void onAppReorder(UUID[] uuids);
 
     void onFetchRecordedData(int dataTypes);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminCoordinator.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminCoordinator.java
index 535c4b628e..5fd410fde4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminCoordinator.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminCoordinator.java
@@ -18,6 +18,7 @@ import de.greenrobot.dao.Property;
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.R;
 import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.AppManagerActivity;
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfigActivity;
 import nodomain.freeyourgadget.gadgetbridge.activities.devicesettings.DeviceSpecificSettings;
 import nodomain.freeyourgadget.gadgetbridge.activities.devicesettings.DeviceSpecificSettingsCustomizer;
 import nodomain.freeyourgadget.gadgetbridge.activities.devicesettings.DeviceSpecificSettingsScreen;
@@ -326,6 +327,12 @@ public abstract class GarminCoordinator extends AbstractBLEDeviceCoordinator {
         return AppManagerActivity.class;
     }
 
+    @Nullable
+    @Override
+    public Class<? extends Activity> getAppConfigurationActivity(final GBDevice device) {
+        return DynamicAppConfigActivity.class;
+    }
+
     @Override
     public boolean supportsAppListFetching(@NonNull final GBDevice device) {
         return true;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceApp.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceApp.java
index f43ea41e8c..c689db00d3 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceApp.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceApp.java
@@ -37,6 +37,7 @@ public class GBDeviceApp implements Parcelable {
     private final boolean inCache;
     private boolean isOnDevice;
     private boolean configurable;
+    private boolean canBeStarted = true;
     private final Bitmap previewImage;
     private boolean isUpToDate = true;
 
@@ -105,6 +106,7 @@ public class GBDeviceApp implements Parcelable {
         this.inCache = in.readInt() != 0;
         this.isOnDevice = in.readInt() != 0;
         this.configurable = in.readInt() != 0;
+        this.canBeStarted = in.readInt() != 0;
         this.previewImage = in.readParcelable(GBDeviceApp.class.getClassLoader());
         this.isUpToDate = in.readInt() != 0;
     }
@@ -184,6 +186,14 @@ public class GBDeviceApp implements Parcelable {
         return isUpToDate;
     }
 
+    public boolean isCanBeStarted() {
+        return canBeStarted;
+    }
+
+    public void setCanBeStarted(boolean canBeStarted) {
+        this.canBeStarted = canBeStarted;
+    }
+
     @Override
     public int describeContents() {
         return 0;
@@ -199,6 +209,7 @@ public class GBDeviceApp implements Parcelable {
         dest.writeInt(inCache ? 1 : 0);
         dest.writeInt(isOnDevice ? 1 : 0);
         dest.writeInt(configurable ? 1 : 0);
+        dest.writeInt(canBeStarted ? 1 : 0);
         dest.writeParcelable(previewImage, 0);
         dest.writeInt(isUpToDate ? 1 : 0);
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceService.java
index 969081d550..5af6794371 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/impl/GBDeviceService.java
@@ -41,6 +41,7 @@ import java.util.UUID;
 
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.R;
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.capabilities.loyaltycards.LoyaltyCard;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventCameraRemote;
 import nodomain.freeyourgadget.gadgetbridge.model.Alarm;
@@ -370,6 +371,23 @@ public class GBDeviceService implements DeviceService {
         invokeService(intent);
     }
 
+    @Override
+    public void onAppConfigRequest(final UUID uuid) {
+        Intent intent = createIntent().setAction(ACTION_APP_CONFIG_REQUEST)
+                .putExtra(EXTRA_APP_UUID, uuid);
+
+        invokeService(intent);
+    }
+
+    @Override
+    public void onAppConfigSet(final UUID uuid, final ArrayList<DynamicAppConfig> configs) {
+        Intent intent = createIntent().setAction(ACTION_APP_CONFIG_SET)
+                .putExtra(EXTRA_APP_UUID, uuid)
+                .putParcelableArrayListExtra(EXTRA_APP_CONFIG, configs);
+
+        invokeService(intent);
+    }
+
     @Override
     public void onAppReorder(UUID[] uuids) {
         Intent intent = createIntent().setAction(ACTION_APP_REORDER)
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DeviceService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DeviceService.java
index a854bf77fb..f2e596ad46 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DeviceService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DeviceService.java
@@ -48,6 +48,8 @@ public interface DeviceService extends EventHandler {
     String ACTION_DOWNLOADAPP = PREFIX + ".action.downloadapp";
     String ACTION_DELETEAPP = PREFIX + ".action.deleteapp";
     String ACTION_APP_CONFIGURE = PREFIX + ".action.app_configure";
+    String ACTION_APP_CONFIG_REQUEST = PREFIX + ".action.app_config_request";
+    String ACTION_APP_CONFIG_SET = PREFIX + ".action.app_config_set";
     String ACTION_APP_REORDER = PREFIX + ".action.app_reorder";
     String ACTION_INSTALL = PREFIX + ".action.install";
     String ACTION_RESET = PREFIX + ".action.reset";
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/AbstractDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/AbstractDeviceSupport.java
index b781d0582e..b76f75932f 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/AbstractDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/AbstractDeviceSupport.java
@@ -34,6 +34,7 @@ import java.util.ArrayList;
 import java.util.UUID;
 
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.activities.devicesettings.DeviceSettingsPreferenceConst;
 import nodomain.freeyourgadget.gadgetbridge.capabilities.loyaltycards.LoyaltyCard;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEvent;
@@ -425,6 +426,16 @@ public abstract class AbstractDeviceSupport implements DeviceSupport {
 
     }
 
+    @Override
+    public void onAppConfigRequest(final UUID appId) {
+
+    }
+
+    @Override
+    public void onAppConfigSet(final UUID appId, final ArrayList<DynamicAppConfig> configs) {
+        
+    }
+
     /**
      * If apps on the device can be reordered, this method can be
      * overridden and implemented by the device support class.
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java
index 2cba6c7067..0e1a950d8e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/DeviceCommunicationService.java
@@ -73,6 +73,7 @@ import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.GBException;
 import nodomain.freeyourgadget.gadgetbridge.R;
 import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.capabilities.loyaltycards.LoyaltyCard;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventCameraRemote;
 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;
@@ -1116,6 +1117,17 @@ public class DeviceCommunicationService extends Service implements SharedPrefere
                 deviceSupport.onAppConfiguration(uuid, config, id);
                 break;
             }
+            case ACTION_APP_CONFIG_REQUEST: {
+                UUID uuid = (UUID) intentCopy.getSerializableExtra(EXTRA_APP_UUID);
+                deviceSupport.onAppConfigRequest(uuid);
+                break;
+            }
+            case ACTION_APP_CONFIG_SET: {
+                UUID uuid = (UUID) intentCopy.getSerializableExtra(EXTRA_APP_UUID);
+                ArrayList<DynamicAppConfig> configs = intentCopy.getParcelableArrayListExtra(EXTRA_APP_CONFIG);
+                deviceSupport.onAppConfigSet(uuid, configs);
+                break;
+            }
             case ACTION_APP_REORDER: {
                 UUID[] uuids = (UUID[]) intentCopy.getSerializableExtra(EXTRA_APP_UUID);
                 deviceSupport.onAppReorder(uuids);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/ServiceDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/ServiceDeviceSupport.java
index c9c561a457..86ec1f1901 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/ServiceDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/ServiceDeviceSupport.java
@@ -33,6 +33,7 @@ import java.util.ArrayList;
 import java.util.EnumSet;
 import java.util.UUID;
 
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.capabilities.loyaltycards.LoyaltyCard;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventCameraRemote;
 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;
@@ -300,6 +301,22 @@ public class ServiceDeviceSupport implements DeviceSupport {
         delegate.onAppConfiguration(uuid, config, id);
     }
 
+    @Override
+    public void onAppConfigRequest(final UUID uuid) {
+        if (checkBusy("app config request")) {
+            return;
+        }
+        delegate.onAppConfigRequest(uuid);
+    }
+
+    @Override
+    public void onAppConfigSet(final UUID uuid, final ArrayList<DynamicAppConfig> configs) {
+        if (checkBusy("app config set")) {
+            return;
+        }
+        delegate.onAppConfigSet(uuid, configs);
+    }
+
     @Override
     public void onAppReorder(UUID[] uuids) {
         if (checkBusy("app reorder")) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/AppConfigHandler.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/AppConfigHandler.kt
new file mode 100644
index 0000000000..f7e041bb61
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/AppConfigHandler.kt
@@ -0,0 +1,168 @@
+package nodomain.freeyourgadget.gadgetbridge.service.devices.garmin
+
+import com.google.gson.JsonElement
+import com.google.gson.JsonObject
+import com.google.gson.JsonPrimitive
+import com.google.protobuf.ByteString
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigBoolean
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigFloat
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigInteger
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig.AppConfigString
+import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventAppConfig
+import nodomain.freeyourgadget.gadgetbridge.proto.garmin.GdiAppConfigService
+import nodomain.freeyourgadget.gadgetbridge.proto.garmin.GdiAppConfigService.AppConfigService.AppConfig
+import nodomain.freeyourgadget.gadgetbridge.proto.garmin.GdiSmartProto
+import nodomain.freeyourgadget.gadgetbridge.service.devices.garmin.http.GarminJson
+import nodomain.freeyourgadget.gadgetbridge.service.devices.garmin.http.GarminJsonException
+import nodomain.freeyourgadget.gadgetbridge.util.UuidUtil
+import nodomain.freeyourgadget.gadgetbridge.util.protobuf.buildWith
+import org.slf4j.LoggerFactory
+import java.util.UUID
+
+class AppConfigHandler(private val deviceSupport: GarminSupport) {
+    fun process(appConfigService: GdiAppConfigService.AppConfigService): Boolean {
+        if (appConfigService.hasAppConfigSetStatus()) {
+            val uuid = UuidUtil.fromBytes(appConfigService.appConfigSetStatus.appId.toByteArray())
+            val status = appConfigService.appConfigSetStatus.status
+            LOG.debug("Got app config set status for {}: {}", uuid, status)
+            if (status != 1) {
+                LOG.warn("Failed to get configs for {}, status={}", uuid, status)
+                evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_SET_FAILED)
+            } else {
+                evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_SET_SUCCESS)
+            }
+            return true
+        }
+
+        if (appConfigService.hasAppConfigGetStatus()) {
+            val uuid = UuidUtil.fromBytes(appConfigService.appConfigGetStatus.appId.toByteArray())
+            val status = appConfigService.appConfigGetStatus.status
+            LOG.debug("Got app config get status for {}: {}", uuid, status)
+            if (status != 1) {
+                LOG.warn("Failed to get configs for {}, status={}", uuid, status)
+                evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED)
+            }
+            // On success we just wait, we'll get the configs in a future command
+            return true
+        }
+
+        if (!appConfigService.hasAppConfigRet()) {
+            LOG.warn("Got unknown app settings response")
+            return false
+        }
+
+        val settings: AppConfig = appConfigService.appConfigRet
+        val uuid = UuidUtil.fromBytes(settings.appId.toByteArray())
+
+        LOG.debug("Got app config ret for {}", uuid)
+
+        val jsonElement: JsonElement = try {
+            GarminJson.decode(settings.appConfig.toByteArray())
+        } catch (e: Exception) {
+            LOG.error("Failed to decode app settings for {}", uuid, e)
+            evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED)
+            return true
+        }
+
+        LOG.debug("Got app settings for {}: {}", uuid, jsonElement)
+
+        if (jsonElement !is JsonObject) {
+            LOG.error(
+                "App settings for {} are not a JSON object: {}",
+                uuid,
+                jsonElement.javaClass
+            )
+            evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED)
+            return true
+        }
+        val configs = jsonElement.keySet().map { key ->
+            LOG.debug("App setting {}: {}", key, jsonElement.get(key))
+
+            val value = jsonElement.get(key)
+            if (value !is JsonPrimitive) {
+                LOG.error(
+                    "App setting value for {} is not a json primitive: {}",
+                    key,
+                    value.javaClass
+                )
+                evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED)
+                return true
+            }
+
+            if (value.isBoolean) {
+                return@map AppConfigBoolean(key, value.getAsBoolean())
+            } else if (value.isNumber) {
+                val num = value.getAsNumber()
+                val doubleValue = num.toDouble()
+                val longValue = num.toLong()
+                if (doubleValue != longValue.toDouble() || num is Float || num is Double) {
+                    return@map AppConfigFloat(key, num.toFloat())
+                } else {
+                    return@map AppConfigInteger(key, num.toInt())
+                }
+            } else if (value.isString) {
+                return@map AppConfigString(key, value.getAsString())
+            } else {
+                LOG.error("Unknown app setting type: {}", value)
+                evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_FAILED)
+                return true
+            }
+        }.toList()
+
+        evaluateEvent(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_GET_SUCCESS, ArrayList(configs))
+
+        return true
+    }
+
+    fun evaluateEvent(uuid: UUID, event: GBDeviceEventAppConfig.Event, configs: ArrayList<DynamicAppConfig> = ArrayList()) {
+        deviceSupport.evaluateGBDeviceEvent(GBDeviceEventAppConfig(uuid, event, configs))
+    }
+
+    fun onAppConfigRequest(uuid: UUID): GdiSmartProto.Smart {
+        LOG.debug("Encoding app config request for {}", uuid)
+        return GdiSmartProto.Smart.newBuilder().buildWith {
+            appConfigService = GdiAppConfigService.AppConfigService.newBuilder().buildWith {
+                appConfigGet = AppConfig.newBuilder().buildWith {
+                    appId = ByteString.copyFrom(UuidUtil.toBytes(uuid))
+                }
+            }
+        }
+    }
+
+    fun onAppConfigSet(uuid: UUID, configs: List<DynamicAppConfig>): GdiSmartProto.Smart? {
+        LOG.debug("Encoding app config set for {} with {} configs", uuid, configs.size)
+
+        val jsonObject = JsonObject()
+        for (config in configs) {
+            when (config) {
+                is AppConfigBoolean -> jsonObject.addProperty(config.key, config.value)
+                is AppConfigString -> jsonObject.addProperty(config.key, config.value)
+                is AppConfigFloat -> jsonObject.addProperty(config.key, config.value)
+                is AppConfigInteger -> jsonObject.addProperty(config.key, config.value)
+            }
+        }
+
+        val configsBytes: ByteArray
+        try {
+            configsBytes = GarminJson.encode(jsonObject)
+        } catch (e: GarminJsonException) {
+            LOG.error("Failed to encode configs to garmin json", e)
+            deviceSupport.evaluateGBDeviceEvent(GBDeviceEventAppConfig(uuid, GBDeviceEventAppConfig.Event.APP_CONFIG_SET_FAILED))
+            return null
+        }
+
+        return GdiSmartProto.Smart.newBuilder().buildWith {
+            appConfigService = GdiAppConfigService.AppConfigService.newBuilder().buildWith {
+                appConfigSet = AppConfig.newBuilder().buildWith {
+                    appId = ByteString.copyFrom(UuidUtil.toBytes(uuid))
+                    appConfig = ByteString.copyFrom(configsBytes)
+                }
+            }
+        }
+    }
+
+    companion object {
+        private val LOG = LoggerFactory.getLogger(AppConfigHandler::class.java)
+    }
+}
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
index 609608e645..9d8b18cf59 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
@@ -50,6 +50,7 @@ import java.util.stream.Collectors;
 
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.R;
+import nodomain.freeyourgadget.gadgetbridge.activities.appmanager.config.DynamicAppConfig;
 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEvent;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEventAppInfo;
@@ -121,6 +122,7 @@ import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;
 import nodomain.freeyourgadget.gadgetbridge.util.GB;
 import nodomain.freeyourgadget.gadgetbridge.util.MediaManager;
 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;
+import nodomain.freeyourgadget.gadgetbridge.util.UuidUtil;
 import nodomain.freeyourgadget.gadgetbridge.util.notifications.GBProgressNotification;
 
 import static nodomain.freeyourgadget.gadgetbridge.GBApplication.ACTION_APP_IS_IN_BACKGROUND;
@@ -584,39 +586,51 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
         );
     }
 
+    @Override
+    public void onAppConfigRequest(final UUID uuid) {
+        sendOutgoingMessage("app config request " + uuid, protocolBufferHandler.prepareProtobufRequest(
+                protocolBufferHandler.getAppConfigHandler().onAppConfigRequest(uuid)
+        ));
+    }
+
+    @Override
+    public void onAppConfigSet(final UUID uuid, final ArrayList<DynamicAppConfig> configs) {
+        sendOutgoingMessage("app config set " + uuid, protocolBufferHandler.prepareProtobufRequest(
+                protocolBufferHandler.getAppConfigHandler().onAppConfigSet(uuid, configs)
+        ));
+    }
+
     public void onAppListReceived(final List<GdiInstalledAppsService.InstalledAppsService.InstalledApp> apps) {
         installedApps.clear();
 
         final List<GBDeviceApp> gbApps = new ArrayList<>(apps.size());
 
         for (final GdiInstalledAppsService.InstalledAppsService.InstalledApp installedApp : apps) {
-            GBDeviceApp.Type type;
+            final boolean isSystemApp = !installedApp.hasFileName();
+            final GBDeviceApp.Type type = switch (installedApp.getType()) {
+                case WATCH_FACE -> isSystemApp ? GBDeviceApp.Type.WATCHFACE_SYSTEM : GBDeviceApp.Type.WATCHFACE;
+                case DATA_FIELD, ACTIVITY -> isSystemApp ? GBDeviceApp.Type.UNKNOWN /* otherwise too many appear */: GBDeviceApp.Type.APP_ACTIVITYTRACKER;
+                case AUDIO_CONTENT_PROVIDER -> isSystemApp ? GBDeviceApp.Type.APP_SYSTEM : GBDeviceApp.Type.APP_GENERIC;
+                case WATCH_APP -> isSystemApp ? GBDeviceApp.Type.APP_SYSTEM : GBDeviceApp.Type.APP_GENERIC;
+                default -> GBDeviceApp.Type.UNKNOWN;
+            };
 
-            switch (installedApp.getType()) {
-                case WATCH_FACE:
-                    type = GBDeviceApp.Type.WATCHFACE;
-                    break;
-                case DATA_FIELD:
-                case ACTIVITY:
-                    type = GBDeviceApp.Type.APP_ACTIVITYTRACKER;
-                    break;
-                default:
-                    // FIXME we set everything else as app generic otherwise they get filtered, add new types
-                    type = GBDeviceApp.Type.APP_GENERIC;
-            }
-
-            final UUID uuid = UUID.nameUUIDFromBytes(installedApp.getStoreAppId().toByteArray());
+            final UUID uuid = UuidUtil.fromBytes(installedApp.getStoreAppId().toByteArray());
             installedApps.put(uuid, installedApp);
-            gbApps.add(new GBDeviceApp(
+            final GBDeviceApp gbDeviceApp = new GBDeviceApp(
                     uuid,
-                    installedApp.getName() + " (" + installedApp.getType() + ")",
+                    installedApp.getName(),
                     "",
-                    String.valueOf(installedApp.getVersion()),
+                    installedApp.getVersion() != 0 ? String.valueOf(installedApp.getVersion()) : null,
                     type
-            ));
-            gbApps.sort(Comparator.comparing(GBDeviceApp::getName));
+            );
+            gbDeviceApp.setConfigurable(type == GBDeviceApp.Type.APP_GENERIC);
+            gbDeviceApp.setCanBeStarted(false); // we do not support starting
+            gbApps.add(gbDeviceApp);
         }
 
+        gbApps.sort(Comparator.comparing(GBDeviceApp::getName));
+
         final GBDeviceEventAppInfo appInfoCmd = new GBDeviceEventAppInfo();
         appInfoCmd.apps = gbApps.toArray(new GBDeviceApp[0]);
         evaluateGBDeviceEvent(appInfoCmd);
@@ -1430,7 +1444,7 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
             @Override
             public void onMessage(final byte[] value) {
                 if (!started) {
-                    if (!ArrayUtils.equals(new byte[]{0,0,0}, value, 0)) {
+                    if (!ArrayUtils.equals(new byte[]{0, 0, 0}, value, 0)) {
                         LOG.error("Got unexpected first message");
                         if (currentlyDownloading != null && currentlyDownloading.getSyncFile() != null) {
                             transferNotification.incrementTotalProgress(currentlyDownloading.getSyncFile().getSize());
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/ProtocolBufferHandler.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/ProtocolBufferHandler.java
index 75183edf22..1a499dfb3c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/ProtocolBufferHandler.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/ProtocolBufferHandler.java
@@ -66,6 +66,7 @@ public class ProtocolBufferHandler implements MessageHandler {
     private final Map<Integer, ProtobufFragment> chunkedFragmentsMap;
     private final int maxChunkSize = 375; //tested on Vívomove Style
     private int lastProtobufRequestId;
+    private final AppConfigHandler appConfigHandler;
     private final HttpHandler httpHandler;
     private final DataTransferHandler dataTransferHandler;
     private final FileSyncServiceHandler fileSyncServiceHandler;
@@ -76,6 +77,7 @@ public class ProtocolBufferHandler implements MessageHandler {
     public ProtocolBufferHandler(GarminSupport deviceSupport) {
         this.deviceSupport = deviceSupport;
         chunkedFragmentsMap = new HashMap<>();
+        appConfigHandler = new AppConfigHandler(deviceSupport);
         httpHandler = new HttpHandler(deviceSupport);
         dataTransferHandler = new DataTransferHandler();
         fileSyncServiceHandler = new FileSyncServiceHandler(deviceSupport);
@@ -219,6 +221,9 @@ public class ProtocolBufferHandler implements MessageHandler {
                     LOG.warn("Ignoring zip transfer service - new sync protocol is disabled");
                 }
             }
+            if (smart.hasAppConfigService()) {
+                processed = appConfigHandler.process(smart.getAppConfigService());
+            }
             if (processed) {
                 message.setStatusMessage(new ProtobufStatusMessage(
                         message.getMessageType(),
@@ -659,6 +664,10 @@ public class ProtocolBufferHandler implements MessageHandler {
         return fileSyncServiceHandler;
     }
 
+    public AppConfigHandler getAppConfigHandler() {
+        return appConfigHandler;
+    }
+
     private class ProtobufFragment {
         private final byte[] fragmentBytes;
         private final int totalLength;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/http/GarminJson.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/http/GarminJson.java
index 0310b53963..9f2406bcdd 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/http/GarminJson.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/http/GarminJson.java
@@ -162,6 +162,10 @@ public class GarminJson {
     }
 
     public static JsonElement decode(final byte[] bytes) throws GarminJsonException {
+        if (bytes.length < 4 + 4 + 1) {
+            throw new GarminJsonException("Not enough bytes for GarminJson in " + GB.hexdump(bytes));
+        }
+
         final ByteBuffer buffer = ByteBuffer.wrap(bytes).order(ByteOrder.BIG_ENDIAN);
 
         // Parse string section if present
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/UuidUtil.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/UuidUtil.java
new file mode 100644
index 0000000000..fa189196ee
--- /dev/null
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/UuidUtil.java
@@ -0,0 +1,20 @@
+package nodomain.freeyourgadget.gadgetbridge.util;
+
+import java.nio.ByteBuffer;
+import java.util.UUID;
+
+public class UuidUtil {
+    public static UUID fromBytes(final byte[] bytes) {
+        final ByteBuffer buf = ByteBuffer.wrap(bytes);
+        final long high = buf.getLong();
+        final long low = buf.getLong();
+        return new UUID(high, low);
+    }
+
+    public static byte[] toBytes(final UUID uuid) {
+        final ByteBuffer buf = ByteBuffer.allocate(16);
+        buf.putLong(uuid.getMostSignificantBits());
+        buf.putLong(uuid.getLeastSignificantBits());
+        return buf.array();
+    }
+}
diff --git a/app/src/main/proto/garmin/gdi_app_config_service.proto b/app/src/main/proto/garmin/gdi_app_config_service.proto
new file mode 100644
index 0000000000..f9a35e17b7
--- /dev/null
+++ b/app/src/main/proto/garmin/gdi_app_config_service.proto
@@ -0,0 +1,23 @@
+syntax = "proto2";
+
+package garmin_vivomovehr;
+
+option java_package = "nodomain.freeyourgadget.gadgetbridge.proto.garmin";
+
+message AppConfigService {
+  optional AppConfig appConfigGet = 1;
+  optional appConfigStatus appConfigGetStatus = 2;
+  optional AppConfig appConfigSet = 3;
+  optional appConfigStatus appConfigSetStatus = 4;
+  optional AppConfig appConfigRet = 5;
+
+  message appConfigStatus {
+    required bytes appId = 1;
+    optional uint32 status = 2; // 1 if it has settings / set was success, 2 app not installed / does not have settings
+  }
+
+  message AppConfig {
+    required bytes appId = 1;
+    optional bytes appConfig = 2;
+  }
+}
diff --git a/app/src/main/proto/garmin/gdi_smart_proto.proto b/app/src/main/proto/garmin/gdi_smart_proto.proto
index 3c29e285b5..d1fecf1ea9 100644
--- a/app/src/main/proto/garmin/gdi_smart_proto.proto
+++ b/app/src/main/proto/garmin/gdi_smart_proto.proto
@@ -10,6 +10,7 @@ import "garmin/gdi_file_sync_service.proto";
 import "garmin/gdi_find_my_watch.proto";
 import "garmin/gdi_core.proto";
 import "garmin/gdi_http_service.proto";
+import "garmin/gdi_app_config_service.proto";
 import "garmin/gdi_installed_apps_service.proto";
 import "garmin/gdi_data_transfer_service.proto";
 import "garmin/gdi_sms_notification.proto";
@@ -21,6 +22,7 @@ import "garmin/gdi_ecg_service.proto";
 message Smart {
     optional CalendarService calendar_service = 1;
     optional HttpService http_service = 2;
+    optional AppConfigService app_config_service = 4;
     optional InstalledAppsService installed_apps_service = 3;
     optional DataTransferService data_transfer_service = 7;
     optional DeviceStatusService device_status_service = 8;
```
-----------------------------------
