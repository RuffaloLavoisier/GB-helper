# Commit: 60abef3544d43161ac1bc800b0a78de860dae016
## Message: Fix call mute command in non-mainline build flavors
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventCallControl.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/externalevents/PhoneCallReceiver.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/receivers/GBCallControlReceiver.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventCallControl.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventCallControl.java
index 74f800135a..357f01ba76 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventCallControl.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/deviceevents/GBDeviceEventCallControl.java
@@ -45,7 +45,7 @@ public class GBDeviceEventCallControl extends GBDeviceEvent {
         LOG.info("Got event for CALL_CONTROL");
         if (event == GBDeviceEventCallControl.Event.IGNORE) {
             LOG.info("Sending intent for mute");
-            final Intent broadcastIntent = new Intent(context.getPackageName() + ".MUTE_CALL");
+            final Intent broadcastIntent = new Intent("nodomain.freeyourgadget.gadgetbridge.MUTE_CALL");
             broadcastIntent.setPackage(context.getPackageName());
             context.sendBroadcast(broadcastIntent);
             return;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/externalevents/PhoneCallReceiver.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/externalevents/PhoneCallReceiver.java
index cab966e3f1..b8377b8939 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/externalevents/PhoneCallReceiver.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/externalevents/PhoneCallReceiver.java
@@ -56,8 +56,10 @@ public class PhoneCallReceiver extends BroadcastReceiver {
             mSavedNumber = intent.getExtras().getString("android.intent.extra.PHONE_NUMBER");
         } else if ("nodomain.freeyourgadget.gadgetbridge.MUTE_CALL".equals(intent.getAction())) {
             // Handle the mute request only if the phone is currently ringing
-            if (mLastState != TelephonyManager.CALL_STATE_RINGING)
+            if (mLastState != TelephonyManager.CALL_STATE_RINGING) {
+                LOG.warn("Last state was not ringing ({}), ignoring mute", mLastState);
                 return;
+            }
 
             AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
             mLastRingerMode = audioManager.getRingerMode();
@@ -78,9 +80,12 @@ public class PhoneCallReceiver extends BroadcastReceiver {
 
     public void onCallStateChanged(Context context, int state, String number) {
         if (mLastState == state) {
+            LOG.debug("Call state changed to same state {}, ignoring", state);
             return;
         }
 
+        LOG.info("Call state changed to {}", state);
+
         int callCommand = CallSpec.CALL_UNDEFINED;
         switch (state) {
             case TelephonyManager.CALL_STATE_RINGING:
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/receivers/GBCallControlReceiver.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/receivers/GBCallControlReceiver.java
index 197c487e5e..9d0add0d61 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/receivers/GBCallControlReceiver.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/receivers/GBCallControlReceiver.java
@@ -45,6 +45,8 @@ public class GBCallControlReceiver extends BroadcastReceiver {
     public void onReceive(Context context, Intent intent) {
         GBDeviceEventCallControl.Event callCmd = GBDeviceEventCallControl.Event.values()[intent.getIntExtra("event", 0)];
 
+        LOG.debug("Got call control event: {}", callCmd);
+
         if (GBApplication.isRunningPieOrLater()) {
             handleCallCmdTelecomManager(callCmd);
         } else {
```
-----------------------------------
