# Commit: 05de74dbc7d48bff691249911dba2065c14c31f0
## Message: Fix raw details path between Gb versions
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutDetailsFragment.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/healthconnect/syncers/RecordedWorkoutSyncer.kt

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutDetailsFragment.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutDetailsFragment.kt
index 1c84535583..c2bb8d24c6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutDetailsFragment.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutDetailsFragment.kt
@@ -596,7 +596,7 @@ class WorkoutDetailsFragment : Fragment(), MenuProvider {
 
             R.id.activity_action_dev_inspect_file -> {
                 val intent = Intent(requireContext(), FitViewerActivity::class.java).apply {
-                    putExtra(FitViewerActivity.EXTRA_PATH, workout.summary.rawDetailsPath)
+                    putExtra(FitViewerActivity.EXTRA_PATH, File(workout.summary.rawDetailsPath).absolutePath)
                 }
                 startActivity(intent)
                 true
@@ -663,7 +663,7 @@ class WorkoutDetailsFragment : Fragment(), MenuProvider {
 
         val hasGpx = workoutHasGps(workout.summary)
         val hasRawSummary = workout.summary.rawSummaryData != null
-        val hasRawDetails = workout.summary.rawDetailsPath?.let { File(it).exists() } ?: false
+        val hasRawDetails = workout.summary.rawDetailsPath?.let { FileUtils.tryFixPath(File(it)) != null } ?: false
 
         val overflowMenu = menu.findItem(R.id.activity_detail_overflowMenu)?.subMenu
         if (overflowMenu != null) {
@@ -808,9 +808,14 @@ class WorkoutDetailsFragment : Fragment(), MenuProvider {
             GB.toast(requireContext(), "No raw details in this activity", Toast.LENGTH_LONG, GB.WARN)
             return
         }
+        val file = FileUtils.tryFixPath(File(workout.summary.rawDetailsPath))
+        if (file == null) {
+            GB.toast(requireContext(), "No raw details in this activity", Toast.LENGTH_LONG, GB.WARN)
+            return
+        }
 
         try {
-            AndroidUtils.shareFile(requireContext(), File(workout.summary.rawDetailsPath))
+            AndroidUtils.shareFile(requireContext(), file)
         } catch (e: Exception) {
             GB.toast(
                 requireContext(),
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/healthconnect/syncers/RecordedWorkoutSyncer.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/healthconnect/syncers/RecordedWorkoutSyncer.kt
index 62dc76871b..5ee169b70e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/healthconnect/syncers/RecordedWorkoutSyncer.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/healthconnect/syncers/RecordedWorkoutSyncer.kt
@@ -46,6 +46,7 @@ import nodomain.freeyourgadget.gadgetbridge.entities.BaseActivitySummary
 import nodomain.freeyourgadget.gadgetbridge.entities.BaseActivitySummaryDao
 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice
 import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind
+import nodomain.freeyourgadget.gadgetbridge.util.FileUtils
 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs
 import nodomain.freeyourgadget.gadgetbridge.util.Prefs
 import nodomain.freeyourgadget.gadgetbridge.util.healthconnect.HealthConnectUtils
@@ -240,8 +241,8 @@ internal object RecordedWorkoutSyncer {
             return null
         }
 
-        val trackFile = File(trackFilePath)
-        if (!trackFile.exists() || !trackFile.canRead()) {
+        val trackFile = FileUtils.tryFixPath(File(trackFilePath))
+        if (trackFile == null || (!trackFile.exists() || !trackFile.canRead())) {
             LOG.warn("Track file does not exist or cannot be read: $trackFilePath")
             return null
         }
```
-----------------------------------
