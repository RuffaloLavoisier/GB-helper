# Commit: af701ec81433225fe34b8f31cc9690681624fdba
## Message: Only include activity summaries that contain VO2max values when querying for VO2max

Otherwise limiting to one result for getting the first / latest sample
does not work if the latest activity has no VO2max value, e.g. because
it was not an activity type for which VO2max was calculated.
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/WorkoutVo2MaxSampleProvider.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/WorkoutVo2MaxSampleProvider.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/WorkoutVo2MaxSampleProvider.java
index aacee1a43f..9bf71b72ad 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/WorkoutVo2MaxSampleProvider.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/WorkoutVo2MaxSampleProvider.java
@@ -76,6 +76,7 @@ public class WorkoutVo2MaxSampleProvider implements Vo2MaxSampleProvider<Vo2MaxS
         qb.where(BaseActivitySummaryDao.Properties.DeviceId.eq(dbDevice.getId()))
                 .where(BaseActivitySummaryDao.Properties.StartTime.gt(new Date(timestampFrom)))
                 .where(BaseActivitySummaryDao.Properties.StartTime.lt(new Date(timestampTo)))
+                .where(BaseActivitySummaryDao.Properties.SummaryData.like("%" + ActivitySummaryEntries.MAXIMUM_OXYGEN_UPTAKE + "%"))
                 .orderAsc(BaseActivitySummaryDao.Properties.StartTime);
 
         final List<BaseActivitySummary> samples = qb.build().list();
@@ -123,6 +124,7 @@ public class WorkoutVo2MaxSampleProvider implements Vo2MaxSampleProvider<Vo2MaxS
         }
 
         qb.where(BaseActivitySummaryDao.Properties.DeviceId.eq(dbDevice.getId()))
+                .where(BaseActivitySummaryDao.Properties.SummaryData.like("%" + ActivitySummaryEntries.MAXIMUM_OXYGEN_UPTAKE + "%"))
                 .orderDesc(BaseActivitySummaryDao.Properties.StartTime)
                 .limit(1);
 
@@ -195,6 +197,7 @@ public class WorkoutVo2MaxSampleProvider implements Vo2MaxSampleProvider<Vo2MaxS
 
         final QueryBuilder<BaseActivitySummary> qb = summaryDao.queryBuilder();
         qb.where(BaseActivitySummaryDao.Properties.DeviceId.eq(dbDevice.getId()))
+                .where(BaseActivitySummaryDao.Properties.SummaryData.like("%" + ActivitySummaryEntries.MAXIMUM_OXYGEN_UPTAKE + "%"))
                 .orderAsc(BaseActivitySummaryDao.Properties.StartTime)
                 .limit(1);
 
```
-----------------------------------
