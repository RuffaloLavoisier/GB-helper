# Commit: 69874ad535f0a615afc6377df22705baf8822bce
## Message: btle+br: use modernized TransactionBuilder methods (#5101)
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/smaq2oss/SMAQ2OSSSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btbr/AbstractBTBRDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/battery/BatteryInfoProfile.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/deviceinfo/DeviceInfoProfile.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/healthThermometer/HealthThermometerProfile.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/heartrate/HeartRateProfile.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/aawireless/AAWirelessSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/asteroidos/AsteroidOSDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/atcbleoepl/ATCBLEOEPLDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWBLEProfile.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWPSeriesDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/banglejs/BangleJSDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/binary_sensor/BinarySensorSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/BasicCasio2C2DSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/Casio2C2DSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/CasioGB6900DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/InitOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/SetAlarmOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/CasioGBX100DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/FetchStepCountDataOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/GetConfigurationOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/InitOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/SetConfigurationOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfDataUploader.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfPreferences.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfWatchProSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cycling_sensor/support/CyclingSensorSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/domyos/DomyosT540Support.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1SideManager.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/femometer/FemometerVinca2DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/fitpro/FitProDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/flipper/zero/support/FlipperZeroSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v1/CommunicatorV1.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v2/CommunicatorV2.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gatt_client/BleGattClientSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitFetcher.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitSupport.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gree/GreeAcSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hama/fit6900/HamaFit6900DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hplus/HPlusSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/HuamiSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/amazfitneo/AmazfitNeoSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation2021.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation2020.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperationNew.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/AbstractZeppOsService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrTransactionBuilder.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleTransactionBuilder.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsTransactionBuilder.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsAgpsUpdateOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsFirmwareUpdateOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsGpxRouteUploadOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsMusicUploadOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAlarmsService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAssistantService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsCannedMessagesService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsConfigService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsHeartRateService.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferImpl.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferV3.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiFreebudsSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiSupportProvider.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/AbstractID115Operation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/FetchActivityOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/ID115Support.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/SendNotificationOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/idasen/IdasenDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/itag/ITagSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/BFH16DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/JYouSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/LefunDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/requests/MultiFetchRequest.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/operations/InitOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/watchxplus/WatchXPlusDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/makibeshr3/MakibesHR3DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/marstek/MarstekB2500DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/MiBandSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBand1Operation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBandOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/FetchActivityOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/UpdateFirmwareOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/mijia_lywsd/MijiaLywsdSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiCompositionScaleDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiSmartScaleDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchDataOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchWorkoutsV2Operation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/MoyoungDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/QuerySettingsOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/TrainingFinishedDataOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/no1f1/No1F1Support.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/nut/NutSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/pinetime/PineTimeJFSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/polar/PolarH10DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/QHybridSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/fossil/FossilWatchAdapter.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/misfit/MisfitWatchAdapter.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FilePutRawRequest.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FirmwareFilePutRequest.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/authentication/VerifyPrivateKeyRequest.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/file/FileEncryptedPutRequest.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/soflow/SoFlowSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sony/wena3/SonyWena3DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sonyswr12/SonySWR12DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/supercars/SuperCarsSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/thermalprinter/GenericThermalPrinterSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/tlw64/TLW64Support.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/ultrahuman/UltrahumanDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/um25/Support/UM25Support.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vesc/VescDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vibratissimo/VibratissimoSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/waspos/WaspOSDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/Watch9DeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/operations/InitOperation.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/withingssteelhr/WithingsSteelHRDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiBleSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiCharacteristic.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppProtocolV2.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xwatch/XWatchSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/yawell/ring/YawellRingDeviceSupport.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/zetime/ZeTimeDeviceSupport.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/smaq2oss/SMAQ2OSSSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/smaq2oss/SMAQ2OSSSupport.java
index 1a35db8670..b453835e86 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/smaq2oss/SMAQ2OSSSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/smaq2oss/SMAQ2OSSSupport.java
@@ -63,7 +63,7 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
         normalWriteCharacteristic = getCharacteristic(SMAQ2OSSConstants.UUID_CHARACTERISTIC_WRITE_NORMAL);
         normalWriteCharacteristic.setWriteType(BluetoothGattCharacteristic.WRITE_TYPE_DEFAULT);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         setTime(builder)
                 .setInitialized(builder);
@@ -71,7 +71,7 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
 
-        builder.notify(getCharacteristic(SMAQ2OSSConstants.UUID_CHARACTERISTIC_NOTIFY_NORMAL), true);
+        builder.notify(SMAQ2OSSConstants.UUID_CHARACTERISTIC_NOTIFY_NORMAL, true);
 
         return builder;
     }
@@ -172,7 +172,7 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
 
             builder.write(normalWriteCharacteristic,createMessage(SMAQ2OSSConstants.MSG_NOTIFICATION,notification.build().toByteArray()));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending notification", ex);
         }
@@ -203,7 +203,7 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
 
             builder.write(normalWriteCharacteristic,createMessage(SMAQ2OSSConstants.MSG_CALL_NOTIFICATION,callnotif.build().toByteArray()));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending call state", ex);
         }
@@ -231,7 +231,7 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
 
             builder.write(normalWriteCharacteristic,createMessage(SMAQ2OSSConstants.MSG_SET_MUSIC_INFO,musicInfo.build().toByteArray()));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending music info", ex);
         }
@@ -279,14 +279,14 @@ public class SMAQ2OSSSupport extends AbstractBTLESingleDeviceSupport {
             }
 
             builder.write(normalWriteCharacteristic,createMessage(SMAQ2OSSConstants.MSG_SET_WEATHER,setWeather.build().toByteArray()));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending current weather", ex);
         }
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     byte[] createMessage(byte msgid, byte[] data){
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btbr/AbstractBTBRDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btbr/AbstractBTBRDeviceSupport.java
index fd760a8c56..bc9a39ede6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btbr/AbstractBTBRDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btbr/AbstractBTBRDeviceSupport.java
@@ -162,7 +162,7 @@ public abstract class AbstractBTBRDeviceSupport extends AbstractDeviceSupport im
 
     public void onConnectionEstablished() {
         try {
-            initializeDevice(createTransactionBuilder("Initializing device")).queue(getQueue());
+            initializeDevice(createTransactionBuilder("Initializing device")).queue();
         } catch (final Exception ex) {
             final GBDevice device = getDevice();
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/battery/BatteryInfoProfile.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/battery/BatteryInfoProfile.java
index 755b9eb0e1..d9df042723 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/battery/BatteryInfoProfile.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/battery/BatteryInfoProfile.java
@@ -50,12 +50,12 @@ public class BatteryInfoProfile<T extends AbstractBTLESingleDeviceSupport> exten
     }
 
     public void requestBatteryInfo(TransactionBuilder builder) {
-        builder.read(getCharacteristic(UUID_CHARACTERISTIC_BATTERY_LEVEL));
+        builder.read(UUID_CHARACTERISTIC_BATTERY_LEVEL);
     }
 
     @Override
     public void enableNotify(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(BatteryInfoProfile.UUID_CHARACTERISTIC_BATTERY_LEVEL), enable);
+        builder.notify(UUID_CHARACTERISTIC_BATTERY_LEVEL, enable);
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/deviceinfo/DeviceInfoProfile.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/deviceinfo/DeviceInfoProfile.java
index 73cdce495a..a2875be7d6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/deviceinfo/DeviceInfoProfile.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/deviceinfo/DeviceInfoProfile.java
@@ -58,15 +58,15 @@ public class DeviceInfoProfile<T extends AbstractBTLESingleDeviceSupport> extend
     }
 
     public void requestDeviceInfo(final TransactionBuilder builder) {
-        builder.read(getCharacteristic(UUID_CHARACTERISTIC_MANUFACTURER_NAME_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_MODEL_NUMBER_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_SERIAL_NUMBER_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_HARDWARE_REVISION_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_FIRMWARE_REVISION_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_SOFTWARE_REVISION_STRING))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_SYSTEM_ID))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_IEEE_11073_20601_REGULATORY_CERTIFICATION_DATA_LIST))
-                .read(getCharacteristic(UUID_CHARACTERISTIC_PNP_ID));
+        builder.read(UUID_CHARACTERISTIC_MANUFACTURER_NAME_STRING)
+                .read(UUID_CHARACTERISTIC_MODEL_NUMBER_STRING)
+                .read(UUID_CHARACTERISTIC_SERIAL_NUMBER_STRING)
+                .read(UUID_CHARACTERISTIC_HARDWARE_REVISION_STRING)
+                .read(UUID_CHARACTERISTIC_FIRMWARE_REVISION_STRING)
+                .read(UUID_CHARACTERISTIC_SOFTWARE_REVISION_STRING)
+                .read(UUID_CHARACTERISTIC_SYSTEM_ID)
+                .read(UUID_CHARACTERISTIC_IEEE_11073_20601_REGULATORY_CERTIFICATION_DATA_LIST)
+                .read(UUID_CHARACTERISTIC_PNP_ID);
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/healthThermometer/HealthThermometerProfile.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/healthThermometer/HealthThermometerProfile.java
index 1f6ef30c35..645f86e8fc 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/healthThermometer/HealthThermometerProfile.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/healthThermometer/HealthThermometerProfile.java
@@ -59,16 +59,16 @@ public class HealthThermometerProfile <T extends AbstractBTLESingleDeviceSupport
     }
 
     public void requestMeasurementInterval(TransactionBuilder builder) {
-        builder.read(getCharacteristic(UUID_CHARACTERISTIC_MEASUREMENT_INTERVAL));
+        builder.read(UUID_CHARACTERISTIC_MEASUREMENT_INTERVAL);
     }
 
     public void setMeasurementInterval(TransactionBuilder builder, byte[] value) {
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_MEASUREMENT_INTERVAL), value);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_MEASUREMENT_INTERVAL, value);
     }
 
     @Override
     public void enableNotify(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_TEMPERATURE_MEASUREMENT), enable);
+        builder.notify(UUID_CHARACTERISTIC_TEMPERATURE_MEASUREMENT, enable);
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/heartrate/HeartRateProfile.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/heartrate/HeartRateProfile.java
index 9810c056c9..bd2111d698 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/heartrate/HeartRateProfile.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/btle/profiles/heartrate/HeartRateProfile.java
@@ -53,7 +53,7 @@ public class HeartRateProfile<T extends AbstractBTLESingleDeviceSupport> extends
     }
 
     protected void writeToControlPoint(byte[] value, TransactionBuilder builder) {
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), value);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, value);
     }
 
     public void requestBodySensorLocation(TransactionBuilder builder) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/aawireless/AAWirelessSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/aawireless/AAWirelessSupport.java
index 38a0d3c77f..2923d9e152 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/aawireless/AAWirelessSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/aawireless/AAWirelessSupport.java
@@ -160,7 +160,7 @@ public class AAWirelessSupport extends AbstractBTBRDeviceSupport {
     private void sendCommand(final String taskName, final short command, final byte[] payload) {
         final TransactionBuilder builder = createTransactionBuilder(taskName);
         sendCommand(builder, command, payload);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void handleCommand(final short command, final byte[] payload) throws Exception {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/asteroidos/AsteroidOSDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/asteroidos/AsteroidOSDeviceSupport.java
index 8a96147124..655be2d516 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/asteroidos/AsteroidOSDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/asteroidos/AsteroidOSDeviceSupport.java
@@ -104,12 +104,12 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
 
-        builder.notify(getCharacteristic(AsteroidOSConstants.MEDIA_COMMANDS_CHAR), true);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.notify(AsteroidOSConstants.MEDIA_COMMANDS_CHAR, true);
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         batteryInfoProfile.requestBatteryInfo(builder);
         batteryInfoProfile.enableNotify(builder, true);
@@ -123,7 +123,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         AsteroidOSNotification notif = new AsteroidOSNotification(notificationSpec);
         TransactionBuilder builder = createTransactionBuilder("send notification");
         safeWriteToCharacteristic(builder, AsteroidOSConstants.NOTIFICATION_UPDATE_CHAR, notif.toString().getBytes(StandardCharsets.UTF_8));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -131,14 +131,14 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         AsteroidOSNotification notif = new AsteroidOSNotification(id);
         TransactionBuilder builder = createTransactionBuilder("delete notification");
         safeWriteToCharacteristic(builder, AsteroidOSConstants.NOTIFICATION_UPDATE_CHAR, notif.toString().getBytes(StandardCharsets.UTF_8));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
     public void onSetTime() {
         TransactionBuilder builder = createTransactionBuilder("set time");
         onSetTime(builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void onSetTime(TransactionBuilder builder) {
@@ -159,7 +159,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         AsteroidOSNotification call = new AsteroidOSNotification(callSpec);
         TransactionBuilder builder = createTransactionBuilder("send call");
         safeWriteToCharacteristic(builder, AsteroidOSConstants.NOTIFICATION_UPDATE_CHAR, call.toString().getBytes(StandardCharsets.UTF_8));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -170,7 +170,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         } else {
             safeWriteToCharacteristic(builder, AsteroidOSConstants.MEDIA_PLAYING_CHAR, new byte[]{0});
         }
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -203,7 +203,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 artist_bytes = "\"\"".getBytes(StandardCharsets.UTF_8);
             safeWriteToCharacteristic(builder, AsteroidOSConstants.MEDIA_ARTIST_CHAR, artist_bytes);
         }
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -211,7 +211,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         TransactionBuilder builder = createTransactionBuilder("send volume information");
         byte volByte = (byte) Math.round(volume);
         safeWriteToCharacteristic(builder, AsteroidOSConstants.MEDIA_VOLUME_CHAR, new byte[]{volByte});
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -236,7 +236,7 @@ public class AsteroidOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         // Send max temps
         safeWriteToCharacteristic(builder, AsteroidOSConstants.WEATHER_MAX_TEMPS_CHAR, asteroidOSWeather.getMaxTemps());
         // Flush queue
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/atcbleoepl/ATCBLEOEPLDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/atcbleoepl/ATCBLEOEPLDeviceSupport.java
index 8277122816..3cd8a1bad6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/atcbleoepl/ATCBLEOEPLDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/atcbleoepl/ATCBLEOEPLDeviceSupport.java
@@ -82,13 +82,13 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.INITIALIZING, getContext()));
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
         builder.requestMtu(512);
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_MAIN), true);
+        builder.notify(UUID_CHARACTERISTIC_MAIN, true);
         builder.wait(300);
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), COMMAND_GET_CONFIGURATION);
+        builder.write(UUID_CHARACTERISTIC_MAIN, COMMAND_GET_CONFIGURATION);
         return builder;
     }
 
@@ -187,11 +187,11 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
             GB.toast(getContext().getString(R.string.same_image_already_on_device), Toast.LENGTH_LONG, GB.WARN);
         }
         final TransactionBuilder builder = createTransactionBuilder("finish upload");
-        builder.setProgress(R.string.sending_image, false, 100, getContext());
+        builder.setProgress(R.string.sending_image, false, 100);
         if (!is_firmware) {
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), new byte[]{0x00, 0x03});
+            builder.write(UUID_CHARACTERISTIC_MAIN, new byte[]{0x00, 0x03});
         }
-        builder.queue(getQueue());
+        builder.queue();
 
         if (getDevice().isBusy()) {
             getDevice().unsetBusyTask();
@@ -205,14 +205,14 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     private void handleNextBlockRequest(byte[] value) {
         final TransactionBuilder builder = createTransactionBuilder("send image start");
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), new byte[]{0x00, 0x02});
+        builder.write(UUID_CHARACTERISTIC_MAIN, new byte[]{0x00, 0x02});
         current_chunk = 0;
         current_block = value[11];
         block_data = encodeBlock(image_payload, current_block);
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), encodeImageChunk(block_data, current_block, current_chunk));
+        builder.write(UUID_CHARACTERISTIC_MAIN, encodeImageChunk(block_data, current_block, current_chunk));
         int progressPercent = (int) ((((float) current_block) / blocks_total) * 100);
-        builder.setProgress(R.string.sending_image, true, progressPercent, getContext());
-        builder.queue(getQueue());
+        builder.setProgress(R.string.sending_image, true, progressPercent);
+        builder.queue();
     }
 
     private void handleNextChunkRequest(boolean success) {
@@ -220,8 +220,8 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
         if (success) {
             current_chunk++; // only send next chunk when successful, else resend last chunk
         }
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), encodeImageChunk(block_data, current_block, current_chunk));
-        builder.queue(getQueue());
+        builder.write(UUID_CHARACTERISTIC_MAIN, encodeImageChunk(block_data, current_block, current_chunk));
+        builder.queue();
     }
 
     private void handleConfigResponse(byte[] value) {
@@ -264,8 +264,8 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
         editor.apply();
 
         final TransactionBuilder builder = createTransactionBuilder("set initialized");
-        builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.INITIALIZED, getContext()));
-        builder.queue(getQueue());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
+        builder.queue();
     }
 
     @Override
@@ -282,26 +282,26 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     String display_model = sharedPrefs.getString(DeviceSettingsPreferenceConst.PREF_ATC_BLE_OEPL_MODEL, "1");
                     int model = Integer.parseInt(display_model);
                     if (model == 10000) {// HACK: this is for the HS 213 BWRY JD type
-                        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), COMMAND_CONFIGURE_HS_154_BWRY_JD);
+                        builder.write(UUID_CHARACTERISTIC_MAIN, COMMAND_CONFIGURE_HS_154_BWRY_JD);
                     } else {
-                        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), new byte[]{0x00, 0x04, 0x00, (byte) model});
+                        builder.write(UUID_CHARACTERISTIC_MAIN, new byte[]{0x00, 0x04, 0x00, (byte) model});
                     }
                 }
                 if (DeviceSettingsPreferenceConst.PREF_ATC_BLE_OEPL_BLE_ADV_INTERVAL.equals(config)) {
                     String bt_adv_interval = sharedPrefs.getString(DeviceSettingsPreferenceConst.PREF_ATC_BLE_OEPL_BLE_ADV_INTERVAL, "1000");
                     int interval = Integer.parseInt(bt_adv_interval);
-                    builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), new byte[]{0x00, 0x08, (byte) ((interval >> 8) & 0xff), (byte) (interval & 0xff)});
+                    builder.write(UUID_CHARACTERISTIC_MAIN, new byte[]{0x00, 0x08, (byte) ((interval >> 8) & 0xff), (byte) (interval & 0xff)});
                 }
                 if (DeviceSettingsPreferenceConst.PREF_ATC_BLE_OEPL_OEPL_PROTOCOL_ENABLE.equals(config)) {
                     boolean enable_oepl_protocol = sharedPrefs.getBoolean(DeviceSettingsPreferenceConst.PREF_ATC_BLE_OEPL_OEPL_PROTOCOL_ENABLE, true);
                     if (enable_oepl_protocol) {
-                        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), COMMAND_ENABLE_OEPL);
+                        builder.write(UUID_CHARACTERISTIC_MAIN, COMMAND_ENABLE_OEPL);
                     } else {
-                        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), COMMAND_DISABLE_OEPL);
+                        builder.write(UUID_CHARACTERISTIC_MAIN, COMMAND_DISABLE_OEPL);
                     }
                 }
 
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
             }
@@ -457,9 +457,9 @@ public class ATCBLEOEPLDeviceSupport extends AbstractBTLESingleDeviceSupport {
             buf.putShort((byte) 0x00);
 
             final TransactionBuilder builder = createTransactionBuilder("send image prepare");
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), buf.array());
-            builder.setBusyTask(getDevice(), R.string.sending_image, getContext());
-            builder.queue(getQueue());
+            builder.write(UUID_CHARACTERISTIC_MAIN, buf.array());
+            builder.setBusyTask(R.string.sending_image);
+            builder.queue();
             blocks_total = image_payload.length / 4096 + 1;
 
         } catch (FileNotFoundException e) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWBLEProfile.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWBLEProfile.java
index d7a93f4318..a8d6593f90 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWBLEProfile.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWBLEProfile.java
@@ -56,22 +56,22 @@ public class BandWBLEProfile<T extends AbstractBTLESingleDeviceSupport> extends
 
     public void setAncModeState(final TransactionBuilder builder, final boolean mode) throws IOException {
         BandWPSeriesRequest req = new BandWPSeriesRequest((byte) 0x03, (byte) 0x02).addToPayload(mode ? ANC_MODE_ON : ANC_MODE_OFF);
-        builder.write(getCharacteristic(UUID_RPC_REQUEST_CHARACTERISTIC), req.finishAndGetBytes());
+        builder.write(UUID_RPC_REQUEST_CHARACTERISTIC, req.finishAndGetBytes());
     }
 
     public void setVptLevel(final TransactionBuilder builder, final int level) throws IOException {
         BandWPSeriesRequest req = new BandWPSeriesRequest((byte) 0x03, (byte) 0x04).addToPayload(level);
-        builder.write(getCharacteristic(UUID_RPC_REQUEST_CHARACTERISTIC), req.finishAndGetBytes());
+        builder.write(UUID_RPC_REQUEST_CHARACTERISTIC, req.finishAndGetBytes());
     }
 
     public void setVptEnabled(final TransactionBuilder builder, final boolean mode) throws IOException {
         BandWPSeriesRequest req = new BandWPSeriesRequest((byte) 0x03, (byte) 0x06).addToPayload(mode);
-        builder.write(getCharacteristic(UUID_RPC_REQUEST_CHARACTERISTIC), req.finishAndGetBytes());
+        builder.write(UUID_RPC_REQUEST_CHARACTERISTIC, req.finishAndGetBytes());
     }
 
     public void setWearSensorEnabled(final TransactionBuilder builder, final boolean mode) throws IOException {
         BandWPSeriesRequest req = new BandWPSeriesRequest((byte) 0x0a, (byte) 0x02).addToPayload(mode);
-        builder.write(getCharacteristic(UUID_RPC_REQUEST_CHARACTERISTIC), req.finishAndGetBytes());
+        builder.write(UUID_RPC_REQUEST_CHARACTERISTIC, req.finishAndGetBytes());
     }
 
     private void sendRequest(final TransactionBuilder builder, byte namespace, byte commandID) {
@@ -82,7 +82,7 @@ public class BandWBLEProfile<T extends AbstractBTLESingleDeviceSupport> extends
             LOG.error("Failed to send request: namespace {}, commandID {}", namespace, commandID);
             return;
         }
-        builder.write(getCharacteristic(UUID_RPC_REQUEST_CHARACTERISTIC), req.finishAndGetBytes());
+        builder.write(UUID_RPC_REQUEST_CHARACTERISTIC, req.finishAndGetBytes());
     }
 
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWPSeriesDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWPSeriesDeviceSupport.java
index 99b45da22b..f90ebd6d26 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWPSeriesDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/bandwpseries/BandWPSeriesDeviceSupport.java
@@ -54,7 +54,7 @@ public class BandWPSeriesDeviceSupport extends AbstractBTLESingleDeviceSupport {
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         // mark the device as initializing
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         getDevice().setBatteryLabel(R.string.left_earbud, 0);
         getDevice().setBatteryLabel(R.string.right_earbud, 1);
@@ -68,10 +68,10 @@ public class BandWPSeriesDeviceSupport extends AbstractBTLESingleDeviceSupport {
         }
 
         // mark the device as initialized
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
-        builder.notify(getCharacteristic(UUID_RPC_RESPONSE_CHARACTERISTIC), true);
-        builder.notify(getCharacteristic(UUID_RPC_NOTIFICATION_CHARACTERISTIC), true);
+        builder.notify(UUID_RPC_RESPONSE_CHARACTERISTIC, true);
+        builder.notify(UUID_RPC_NOTIFICATION_CHARACTERISTIC, true);
         BandWBLEProfile.requestFirmware(builder);
         BandWBLEProfile.requestDeviceName(builder);
         BandWBLEProfile.requestBatteryLevels(builder);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/banglejs/BangleJSDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/banglejs/BangleJSDeviceSupport.java
index 1ba35f9804..6759441ff5 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/banglejs/BangleJSDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/banglejs/BangleJSDeviceSupport.java
@@ -290,7 +290,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
                             try {
                                 TransactionBuilder builder = performInitialized("TX");
                                 uartTx(builder, data);
-                                builder.queue(queue);
+                                builder.queue();
                             } catch (IOException e) {
                                 GB.toast(getContext(), "Error in TX: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
                             }
@@ -341,7 +341,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
                         try {
                             TransactionBuilder builder = performInitialized("TX");
                             uartTx(builder, data);
-                            builder.queue(getQueue());
+                            builder.queue();
                         } catch (IOException e) {
                             GB.toast(getContext(), "Error in TX: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
                         }
@@ -362,7 +362,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
             sleepAsAndroidSender = new SleepAsAndroidSender(gbDevice);
         }
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         rxCharacteristic = getCharacteristic(BangleJSConstants.UUID_CHARACTERISTIC_NORDIC_UART_RX);
         txCharacteristic = getCharacteristic(BangleJSConstants.UUID_CHARACTERISTIC_NORDIC_UART_TX);
@@ -370,7 +370,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
             // https://codeberg.org/Freeyourgadget/Gadgetbridge/issues/2996 - sometimes we get
             // initializeDevice called but no characteristics have been fetched - try and reconnect in that case
             LOG.warn("RX/TX characteristics are null, will attempt to reconnect");
-            builder.setUpdateState(gbDevice, GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
         builder.setCallback(this);
@@ -390,7 +390,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         //sendSettings(builder);
 
         // get version
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         if (getDevice().getFirmwareVersion() == null) {
             getDevice().setFirmwareVersion("N/A");
             getDevice().setFirmwareVersion2("N/A");
@@ -513,7 +513,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized(taskName);
             uartTxJSON(builder, json);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error in "+taskName+": " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1551,7 +1551,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
             //TODO: once we have a common strategy for sending events (e.g. EventHandler), remove this call from here. Meanwhile it does no harm.
             // = we should generalize the pebble calender code
             forceCalendarSync();
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             GB.toast(getContext(), "Error setting time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1835,7 +1835,7 @@ public class BangleJSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             final TransactionBuilder builder = performInitialized("screenshot");
             uartTx(builder, "\u0010g.dump()\n");
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final IOException e) {
             GB.toast(getContext(), "Failed to get screenshot: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/binary_sensor/BinarySensorSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/binary_sensor/BinarySensorSupport.java
index cf0eb66e61..5df51ec117 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/binary_sensor/BinarySensorSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/binary_sensor/BinarySensorSupport.java
@@ -147,8 +147,8 @@ public class BinarySensorSupport extends BinarySensorBaseSupport {
             if (parameter instanceof SensorState) {
                 if(getDevice().getState() != GBDevice.State.INITIALIZED){
                     createTransactionBuilder("set device state")
-                            .setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext())
-                            .queue(getQueue());
+                            .setDeviceState(GBDevice.State.INITIALIZED)
+                            .queue();
                 }
 
                 SensorState stateParameter = (SensorState) parameter;
@@ -167,13 +167,13 @@ public class BinarySensorSupport extends BinarySensorBaseSupport {
         fullData[0] = 0x00;
         System.arraycopy(data, 0, fullData, 1, data.length);
 
-        builder.write(getCharacteristic(UUID.fromString(BINARY_SENSOR_CONTROL_CHARACTERISTIC_UUID)), fullData);
+        builder.write(UUID.fromString(BINARY_SENSOR_CONTROL_CHARACTERISTIC_UUID), fullData);
     }
 
     private void sendPacketToDevice(byte[] data) {
         TransactionBuilder builder = createTransactionBuilder("BSS control");
         sendPacketToDevice(data, builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -189,8 +189,8 @@ public class BinarySensorSupport extends BinarySensorBaseSupport {
         logger.debug("initializing device");
 
         builder
-                .setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext())
-                .notify(getCharacteristic(UUID.fromString(BINARY_SENSOR_RESPONSE_CHARACTERISTIC_UUID)), true)
+                .setDeviceState(GBDevice.State.INITIALIZING)
+                .notify(UUID.fromString(BINARY_SENSOR_RESPONSE_CHARACTERISTIC_UUID), true)
         ;
 
         SetSensorRequest setSensorRequest = new SetSensorRequest(SensorType.SENSOR_TYPE_OPENING_CLOSING, ReportState.REPORT_STATUS_ENABLED);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/BasicCasio2C2DSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/BasicCasio2C2DSupport.java
index 0fb76b1b4b..95451210c4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/BasicCasio2C2DSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/BasicCasio2C2DSupport.java
@@ -35,7 +35,7 @@ public abstract class BasicCasio2C2DSupport extends Casio2C2DSupport {
             return builder;
         }
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         super.initializeDevice(builder);
 
@@ -62,10 +62,10 @@ public abstract class BasicCasio2C2DSupport extends Casio2C2DSupport {
         requestFeatures(builder, requests, responses -> {
             TransactionBuilder clockBuilder = createTransactionBuilder("setClocks");
             setClocks(clockBuilder, responses);
-            clockBuilder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
-            clockBuilder.queue(getQueue());
+            clockBuilder.setDeviceState(GBDevice.State.INITIALIZED);
+            clockBuilder.queue();
         });
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void setClocks(TransactionBuilder builder, Map<FeatureRequest, byte[]> responses) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/Casio2C2DSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/Casio2C2DSupport.java
index 23c7c855ca..97f39e4c82 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/Casio2C2DSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/Casio2C2DSupport.java
@@ -267,7 +267,7 @@ public abstract class Casio2C2DSupport extends CasioSupport {
     }
 
     public void requestFeature(TransactionBuilder builder, FeatureRequest request, ResponseHandler handler) {
-        builder.notify(getCharacteristic(CasioConstants.CASIO_ALL_FEATURES_CHARACTERISTIC_UUID), true);
+        builder.notify(CasioConstants.CASIO_ALL_FEATURES_CHARACTERISTIC_UUID, true);
         writeAllFeaturesRequest(builder, request.getData());
         builder.run(() -> requests.add(new RequestWithHandler(request, handler)));
     }
@@ -481,7 +481,7 @@ public abstract class Casio2C2DSupport extends CasioSupport {
             writeAllFeatures(builder, data);
         }
         builder.run(() -> GB.toast(getContext(), getContext().getString(R.string.user_feedback_set_settings_ok), Toast.LENGTH_SHORT, GB.INFO));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public abstract class DeviceItems<Item> extends DeviceSetting {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/CasioGB6900DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/CasioGB6900DeviceSupport.java
index 3bf81f4e83..21e2f1e684 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/CasioGB6900DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/CasioGB6900DeviceSupport.java
@@ -231,8 +231,8 @@ public class CasioGB6900DeviceSupport extends CasioSupport {
     public void readTxPowerLevel() {
         try {
             TransactionBuilder builder = performInitialized("readTxPowerLevel");
-            builder.read(getCharacteristic(CasioConstants.TX_POWER_LEVEL_CHARACTERISTIC_UUID));
-            builder.queue(getQueue());
+            builder.read(CasioConstants.TX_POWER_LEVEL_CHARACTERISTIC_UUID);
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("readTxPowerLevel failed: " + e.getMessage());
         }
@@ -464,7 +464,7 @@ public class CasioGB6900DeviceSupport extends CasioSupport {
 
             builder.writeLegacy(getCharacteristic(CasioConstants.ALERT_CHARACTERISTIC_UUID), msg);
             LOG.info("Showing notification, title: " + title + " message (not sent): " + message);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("showNotification failed: " + e.getMessage());
         }
@@ -512,7 +512,7 @@ public class CasioGB6900DeviceSupport extends CasioSupport {
             TransactionBuilder builder = performInitialized("SetTime");
             writeCasioLocalTimeInformation(builder);
             writeCasioCurrentTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.warn("onSetTime failed: " + e.getMessage());
         }
@@ -564,7 +564,7 @@ public class CasioGB6900DeviceSupport extends CasioSupport {
             arr[2] = 1;
             System.arraycopy(bInfo, 0, arr, 3, len);
             builder.writeLegacy(getCharacteristic(CasioConstants.MORE_ALERT_FOR_LONG_UUID), arr);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("sendMusicInfo failed: " + e.getMessage());
         }
@@ -598,7 +598,7 @@ public class CasioGB6900DeviceSupport extends CasioSupport {
                 BluetoothGattCharacteristic charact = service.getCharacteristic(CasioConstants.ALERT_LEVEL_CHARACTERISTIC_UUID);
                 builder.writeLegacy(charact, value);
                 LOG.info("onFindDevice sent");
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 LOG.warn("showNotification failed: " + e.getMessage());
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/InitOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/InitOperation.java
index 4eb3ad1712..875c220ac8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/InitOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/InitOperation.java
@@ -45,10 +45,10 @@ public class InitOperation extends AbstractBTLEOperation<CasioGB6900DeviceSuppor
 
     @Override
     protected void doPerform() throws IOException {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         TransactionBuilder builder = getSupport().createTransactionBuilder("readBleSettings");
         builder.setCallback(this);
-        builder.read(getCharacteristic(CasioConstants.CASIO_SETTING_FOR_BLE_CHARACTERISTIC_UUID));
+        builder.read(CasioConstants.CASIO_SETTING_FOR_BLE_CHARACTERISTIC_UUID);
         getSupport().performImmediately(builder);
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/SetAlarmOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/SetAlarmOperation.java
index a985beccba..6390d83214 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/SetAlarmOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gb6900/SetAlarmOperation.java
@@ -53,8 +53,8 @@ public class SetAlarmOperation extends AbstractBTLEOperation<CasioGB6900DeviceSu
             try {
                 TransactionBuilder builder = performInitialized("getSettingForAlarm");
                 builder.setCallback(this);
-                builder.read(getCharacteristic(CasioConstants.CASIO_SETTING_FOR_ALM_CHARACTERISTIC_UUID));
-                builder.queue(getQueue());
+                builder.read(CasioConstants.CASIO_SETTING_FOR_ALM_CHARACTERISTIC_UUID);
+                builder.queue();
             } catch (IOException ex) {
                 LOG.info("Error retrieving alarm settings: " + ex.getMessage());
             }
@@ -75,7 +75,7 @@ public class SetAlarmOperation extends AbstractBTLEOperation<CasioGB6900DeviceSu
                 TransactionBuilder builder = performInitialized("finished operation");
                 builder.wait(0);
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.info("Error resetting Gatt callback: " + ex.getMessage());
             }
@@ -119,7 +119,7 @@ public class SetAlarmOperation extends AbstractBTLEOperation<CasioGB6900DeviceSu
             try {
                 TransactionBuilder builder = performInitialized("setAlarm");
                 builder.writeLegacy(getCharacteristic(CasioConstants.CASIO_SETTING_FOR_ALM_CHARACTERISTIC_UUID), data);
-                builder.queue(getQueue());
+                builder.queue();
             } catch(IOException e) {
                 LOG.error("Error setting alarm: " + e.getMessage());
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/CasioGBX100DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/CasioGBX100DeviceSupport.java
index cbaeb196bf..3d15adab42 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/CasioGBX100DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/CasioGBX100DeviceSupport.java
@@ -230,7 +230,7 @@ public class CasioGBX100DeviceSupport extends Casio2C2DSupport implements Shared
                     try {
                         TransactionBuilder builder = performInitialized("writeCurrentTime");
                         writeCurrentTime(builder, ZonedDateTime.now());
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         LOG.warn("writing current time failed: " + e.getMessage());
                     }
@@ -404,7 +404,7 @@ public class CasioGBX100DeviceSupport extends Casio2C2DSupport implements Shared
             TransactionBuilder builder = performInitialized("showNotification");
             builder.writeLegacy(getCharacteristic(CasioConstants.CASIO_NOTIFICATION_CHARACTERISTIC_UUID), copy);
             LOG.info("Showing notification, title: {} message: {}", title, message);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("showNotification failed", e);
         }
@@ -546,7 +546,7 @@ public class CasioGBX100DeviceSupport extends Casio2C2DSupport implements Shared
             TransactionBuilder builder = performInitialized("setAlarm");
             writeAllFeatures(builder, data1);
             writeAllFeatures(builder, data2);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.error("Error setting alarm: " + e.getMessage());
         }
@@ -558,7 +558,7 @@ public class CasioGBX100DeviceSupport extends Casio2C2DSupport implements Shared
         try {
             TransactionBuilder builder = performInitialized("onSetTime");
             writeCurrentTime(builder, ZonedDateTime.now());
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("onSetTime failed: " + e.getMessage());
         }
@@ -638,7 +638,7 @@ public class CasioGBX100DeviceSupport extends Casio2C2DSupport implements Shared
         try {
             TransactionBuilder builder = performInitialized("onTestNewFunction");
             writeAllFeaturesRequest(builder, data);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.error("Error setting alarm: " + e.getMessage());
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/FetchStepCountDataOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/FetchStepCountDataOperation.java
index 83d556c620..b93bd2515e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/FetchStepCountDataOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/FetchStepCountDataOperation.java
@@ -51,9 +51,9 @@ public class FetchStepCountDataOperation  extends AbstractBTLEOperation<CasioGBX
         try {
             TransactionBuilder builder = performInitialized("enableRequiredNotifications");
             builder.setCallback(this);
-            builder.notify(getCharacteristic(CasioConstants.CASIO_DATA_REQUEST_SP_CHARACTERISTIC_UUID), enable);
-            builder.notify(getCharacteristic(CasioConstants.CASIO_CONVOY_CHARACTERISTIC_UUID), enable);
-            builder.queue(getQueue());
+            builder.notify(CasioConstants.CASIO_DATA_REQUEST_SP_CHARACTERISTIC_UUID, enable);
+            builder.notify(CasioConstants.CASIO_CONVOY_CHARACTERISTIC_UUID, enable);
+            builder.queue();
         } catch(IOException e) {
             LOG.error("Error enabling required notifications", e);
         }
@@ -66,7 +66,7 @@ public class FetchStepCountDataOperation  extends AbstractBTLEOperation<CasioGBX
             TransactionBuilder builder = performInitialized("requestStepCountDate");
             builder.setCallback(this);
             builder.writeLegacy(getCharacteristic(CasioConstants.CASIO_DATA_REQUEST_SP_CHARACTERISTIC_UUID), command);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.error("Error requesting step count data", e);
         }
@@ -79,7 +79,7 @@ public class FetchStepCountDataOperation  extends AbstractBTLEOperation<CasioGBX
             TransactionBuilder builder = performInitialized("writeStepCountAck");
             builder.setCallback(this);
             builder.writeLegacy(getCharacteristic(CasioConstants.CASIO_DATA_REQUEST_SP_CHARACTERISTIC_UUID), command);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.error("Error writing step count ack", e);
         }
@@ -111,7 +111,7 @@ public class FetchStepCountDataOperation  extends AbstractBTLEOperation<CasioGBX
                 TransactionBuilder builder = performInitialized("finished operation");
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
                 builder.wait(0);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.error("Error resetting Gatt callback", ex);
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/GetConfigurationOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/GetConfigurationOperation.java
index 31a9bf95c1..90af393634 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/GetConfigurationOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/GetConfigurationOperation.java
@@ -64,7 +64,7 @@ public class GetConfigurationOperation extends AbstractBTLEOperation<CasioGBX100
         TransactionBuilder builder = performInitialized("getConfiguration-Get1");
         builder.setCallback(this);
         support.writeAllFeaturesRequest(builder, command);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -76,7 +76,7 @@ public class GetConfigurationOperation extends AbstractBTLEOperation<CasioGBX100
                 TransactionBuilder builder = performInitialized("finished operation");
                 builder.wait(0);
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.info("Error resetting Gatt callback: " + ex.getMessage());
             }
@@ -91,7 +91,7 @@ public class GetConfigurationOperation extends AbstractBTLEOperation<CasioGBX100
             TransactionBuilder builder = performInitialized("getConfiguration-Get2");
             builder.setCallback(this);
             support.writeAllFeaturesRequest(builder, command);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.info("Error requesting Casio configuration");
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/InitOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/InitOperation.java
index 112e9a3c4d..e0dad13b46 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/InitOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/InitOperation.java
@@ -261,12 +261,12 @@ public class InitOperation extends AbstractBTLEOperation<CasioGBX100DeviceSuppor
     }
 
     private void enableAllFeatures(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(CasioConstants.CASIO_ALL_FEATURES_CHARACTERISTIC_UUID), enable);
+        builder.notify(CasioConstants.CASIO_ALL_FEATURES_CHARACTERISTIC_UUID, enable);
     }
 
     @Override
     protected void doPerform() throws IOException {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         enableAllFeatures(builder, true);
         requestWatchName(builder);
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/SetConfigurationOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/SetConfigurationOperation.java
index 962743d461..59646792d1 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/SetConfigurationOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/casio/gbx100/SetConfigurationOperation.java
@@ -68,7 +68,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
         TransactionBuilder builder = performInitialized("getConfiguration-Set1");
         builder.setCallback(this);
         support.writeAllFeaturesRequest(builder, command);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -151,7 +151,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
                         TransactionBuilder builder = performInitialized("setConfiguration-Set1");
                         builder.setCallback(this);
                         support.writeAllFeatures(builder, data);
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         LOG.info("Error writing configuration to Casio watch");
                     }
@@ -192,7 +192,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
                         TransactionBuilder builder = performInitialized("setConfiguration-Set2");
                         builder.setCallback(this);
                         support.writeAllFeatures(builder, data);
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         LOG.info("Error writing configuration to Casio watch");
                     }
@@ -239,7 +239,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
                         TransactionBuilder builder = performInitialized("setConfiguration-Set3");
                         builder.setCallback(this);
                         support.writeAllFeatures(builder, data);
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         LOG.info("Error writing configuration to Casio watch");
                     }
@@ -263,7 +263,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
                 TransactionBuilder builder = performInitialized("finished operation");
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
                 builder.wait(0);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.info("Error resetting Gatt callback: " + ex.getMessage());
             }
@@ -277,7 +277,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
             TransactionBuilder builder = performInitialized("getConfiguration-Set2");
             builder.setCallback(this);
             support.writeAllFeaturesRequest(builder, command);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.info("Error requesting Casio configuration");
         }
@@ -290,7 +290,7 @@ public class SetConfigurationOperation  extends AbstractBTLEOperation<CasioGBX10
             TransactionBuilder builder = performInitialized("getConfiguration-Set3");
             builder.setCallback(this);
             support.writeAllFeaturesRequest(builder, command);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.info("Error requesting Casio configuration");
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfDataUploader.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfDataUploader.java
index 8f91d5ff48..d9a0061078 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfDataUploader.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfDataUploader.java
@@ -214,7 +214,7 @@ public class CmfDataUploader implements CmfCharacteristic.Handler {
     private void updateProgress(final int progressPercent, boolean ongoing) {
         final TransactionBuilder builder = mSupport.createTransactionBuilder("update data upload progress to " + progressPercent);
         updateProgress(builder, progressPercent, ongoing);
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     private void updateProgress(final TransactionBuilder builder, final int progressPercent, boolean ongoing) {
@@ -228,8 +228,7 @@ public class CmfDataUploader implements CmfCharacteristic.Handler {
         builder.setProgress(
                 uploadMessage,
                 ongoing,
-                progressPercent,
-                mSupport.getContext()
+                progressPercent
         );
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfPreferences.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfPreferences.java
index a37ea15dfd..2e4f29d8a6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfPreferences.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfPreferences.java
@@ -165,7 +165,7 @@ public class CmfPreferences {
         final TransactionBuilder builder = mSupport.createTransactionBuilder("set measurement system");
         mSupport.sendCommand(builder, CmfCommand.UNIT_LENGTH, cmd);
         mSupport.sendCommand(builder, CmfCommand.UNIT_TEMPERATURE, cmd);
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     private void setLanguage() {
@@ -346,7 +346,7 @@ public class CmfPreferences {
 
         mSupport.sendCommand(builder, CmfCommand.CALL_REMINDER_REQUEST, new byte[]{0x01, (byte) (enabled ? 0x01 : 0x00)});
 
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     private void setActivityTypes() {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfWatchProSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfWatchProSupport.java
index 3d126d4a37..7f47efc574 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfWatchProSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cmfwatchpro/CmfWatchProSupport.java
@@ -134,33 +134,33 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
 
     @Override
     protected TransactionBuilder initializeDevice(final TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         final BluetoothGattCharacteristic btCharacteristicCommandRead = getCharacteristic(UUID_CHARACTERISTIC_CMF_COMMAND_READ);
         if (btCharacteristicCommandRead == null) {
             LOG.warn("Characteristic command read is null, will attempt to reconnect");
-            builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
 
         final BluetoothGattCharacteristic btCharacteristicCommandWrite = getCharacteristic(UUID_CHARACTERISTIC_CMF_COMMAND_WRITE);
         if (btCharacteristicCommandWrite == null) {
             LOG.warn("Characteristic command write is null, will attempt to reconnect");
-            builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
 
         final BluetoothGattCharacteristic btCharacteristicDataWrite = getCharacteristic(UUID_CHARACTERISTIC_CMF_DATA_WRITE);
         if (btCharacteristicDataWrite == null) {
             LOG.warn("Characteristic data write is null, will attempt to reconnect");
-            builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
 
         final BluetoothGattCharacteristic btCharacteristicDataRead = getCharacteristic(UUID_CHARACTERISTIC_CMF_DATA_READ);
         if (btCharacteristicDataRead == null) {
             LOG.warn("Characteristic data read is null, will attempt to reconnect");
-            builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
 
@@ -204,7 +204,7 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
             builder.notify(btCharacteristicFirmwareRead, true);
         }
 
-        builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+        builder.setDeviceState(GBDevice.State.AUTHENTICATING);
 
         final byte[] secretKey = getSecretKey(getDevice());
 
@@ -222,10 +222,10 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
 
             sendCommand(builder, CmfCommand.AUTH_PHONE_NAME, ArrayUtils.addAll(new byte[]{A5}, Build.MODEL.getBytes(StandardCharsets.UTF_8)));
         } else if (btCharacteristicShellWrite != null) {
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_CMF_SHELL_WRITE), "AT GETSECRET".getBytes());
+            builder.write(UUID_CHARACTERISTIC_CMF_SHELL_WRITE, "AT GETSECRET".getBytes());
         } else {
             GB.toast(getContext(), R.string.authentication_failed_check_key, Toast.LENGTH_LONG, GB.WARN);
-            builder.setUpdateState(getDevice(), GBDevice.State.NOT_CONNECTED, getContext());
+            builder.setDeviceState(GBDevice.State.NOT_CONNECTED);
         }
 
         return builder;
@@ -396,8 +396,8 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
                 //sendCommand(phase2builder, CmfCommand.ALARMS_GET);
                 //sendCommand(phase2builder, CmfCommand.CALL_REMINDER_REQUEST, 0x00);
                 // TODO premature to mark as initialized?
-                phase2builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
-                phase2builder.queue(getQueue());
+                phase2builder.setDeviceState(GBDevice.State.INITIALIZED);
+                phase2builder.queue();
                 return;
             case BATTERY:
                 final int battery = payload[0] & 0xff;
@@ -485,7 +485,7 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
     public void sendCommand(final String taskName, final CmfCommand cmd, final byte... payload) {
         final TransactionBuilder builder = createTransactionBuilder(taskName);
         sendCommand(builder, cmd, payload);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public void sendCommand(final TransactionBuilder builder, final CmfCommand cmd, final byte... payload) {
@@ -495,13 +495,13 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
     public void sendData(final String taskName, final CmfCommand cmd, final byte... payload) {
         final TransactionBuilder builder = createTransactionBuilder(taskName);
         characteristicDataWrite.sendCommand(builder, cmd, payload);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public void sendFirmware(final String taskName, final CmfCommand cmd, final byte... payload) {
         final TransactionBuilder builder = createTransactionBuilder(taskName);
         characteristicFirmwareWrite.sendCommand(builder, cmd, payload);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void handleShellCommand(final byte[] bytes) {
@@ -579,7 +579,7 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
     public void onSetGpsLocation(final Location location) {
         final TransactionBuilder builder = createTransactionBuilder("set gps location");
         sendGpsCoords(builder, location);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void sendGpsCoords(final TransactionBuilder builder, final Location location) {
@@ -644,7 +644,7 @@ public class CmfWatchProSupport extends AbstractBTLESingleDeviceSupport implemen
     public void onSetTime() {
         final TransactionBuilder builder = createTransactionBuilder("set time");
         setTime(builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void setTime(final TransactionBuilder builder) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cycling_sensor/support/CyclingSensorSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cycling_sensor/support/CyclingSensorSupport.java
index 7f4b865e9c..4a9cc8f579 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cycling_sensor/support/CyclingSensorSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/cycling_sensor/support/CyclingSensorSupport.java
@@ -127,18 +127,18 @@ public class CyclingSensorSupport extends CyclingSensorBaseSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         BluetoothGattCharacteristic measurementCharacteristic =
                 getCharacteristic(UUID_CYCLING_SENSOR_CSC_MEASUREMENT);
 
-        builder.add(new NotifyAction(measurementCharacteristic, true));
+        builder.notify(measurementCharacteristic, true);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         batteryCharacteristic = getCharacteristic(BatteryInfoProfile.UUID_CHARACTERISTIC_BATTERY_LEVEL);
 
         if(batteryCharacteristic != null){
-            builder.add(new ReadAction(batteryCharacteristic));
+            builder.read(batteryCharacteristic);
         }
 
         loadConfiguration();
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/domyos/DomyosT540Support.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/domyos/DomyosT540Support.java
index d666753dfc..d6d9534ef1 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/domyos/DomyosT540Support.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/domyos/DomyosT540Support.java
@@ -88,7 +88,7 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
         enableNotifications(builder, true);
         setParameters(builder, 1.0f, 0, true);
@@ -104,11 +104,11 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
     }
 
     private void enableNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(UUUD_CHARACTERISTICS_NOTIFY), enable);
+        builder.notify(UUUD_CHARACTERISTICS_NOTIFY, enable);
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     private void setDisplayValues(TransactionBuilder builder, int elapsedTime, int kCal, int heartRate, float incline, float speed, float distance) {
@@ -167,18 +167,8 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
     }
 
     void writeChunked(TransactionBuilder builder, byte[] data) {
-        final int MAX_CHUNKLENGTH = 20;
-        int remaining = data.length;
-        byte count = 0;
-        while (remaining > 0) {
-            int copybytes = Math.min(remaining, MAX_CHUNKLENGTH);
-            byte[] chunk = new byte[copybytes];
-
-            System.arraycopy(data, count++ * MAX_CHUNKLENGTH, chunk, 0, copybytes);
-            builder.write(getCharacteristic(UUUD_CHARACTERISTICS_WRITE), chunk);
-            remaining -= copybytes;
-        }
-        builder.wait(100);
+        builder.writeChunkedData(getCharacteristic(UUUD_CHARACTERISTICS_WRITE), data, 20)
+                .wait(100);
     }
 
     private byte getChecksum(byte[] command) {
@@ -209,7 +199,7 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder("beep");
         builder.write(characteristic, command);
-        builder.queue(getQueue());
+        builder.queue();
 
     }
 
@@ -267,7 +257,7 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
                     last_time = time;
                 }
 
-                builder.queue(getQueue());
+                builder.queue();
 
                 LOG.debug("speed: " + speed + " incline: " + incline + " distance: " + distance + " calories: " + calories + " average speed: " + averageSpeed + " heart rate: " + heartRate);
                 LOG.debug("key plugged in: " + keyPluggedIn + " tablet stand used: " + tabletStandUsed + " buttonCode: " + buttonCode + " workout started: " + workoutStarted);
@@ -299,7 +289,7 @@ public class DomyosT540Support extends AbstractBTLESingleDeviceSupport {
         //setDisplayValues(builder, 1, 10, 10, 10, 10);
         //writeChunked(builder, COMMAND_SET_DISPLAY);
 
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1DeviceSupport.java
index 6a1bf6b4c1..a2558a056e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1DeviceSupport.java
@@ -119,8 +119,7 @@ public class G1DeviceSupport extends AbstractBTLEMultiDeviceSupport {
         if (rx == null || tx == null) {
             // If the characteristics are not received from the device reconnect and try again.
             LOG.warn("RX/TX characteristics are null, will attempt to reconnect");
-            builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT,
-                                                 getContext()));
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             GB.toast(getContext(), "Failed to connect to Glasses, waiting for reconnect.",
                      Toast.LENGTH_LONG, GB.ERROR);
             return builder;
@@ -138,8 +137,7 @@ public class G1DeviceSupport extends AbstractBTLEMultiDeviceSupport {
         // Paranoid protection from a bad index being passed in.
         if (side == null) {
             LOG.error("Device index is not left or right: {}", deviceIdx);
-            builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT,
-                                                 getContext()));
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             GB.toast(getContext(), "Unable to manage connection to device.", Toast.LENGTH_LONG,
                      GB.ERROR);
             return builder;
@@ -157,8 +155,7 @@ public class G1DeviceSupport extends AbstractBTLEMultiDeviceSupport {
         // will lock up in a half initialized state because GB thinks the left side is initialized,
         // after because the right ran first.
         if (side.getConnectingState() == GBDevice.State.CONNECTED) {
-            builder.add(new SetDeviceStateAction(getDevice(deviceIdx), GBDevice.State.INITIALIZING,
-                                                 getContext()));
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
             side.initialize(builder);
         }
 
@@ -174,8 +171,7 @@ public class G1DeviceSupport extends AbstractBTLEMultiDeviceSupport {
 
                 // Both sides are initialized. The whole device is initialized, don't use a device
                 // index here. Device 0 is the device that the reset of GB sees.
-                builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.INITIALIZED,
-                                                     getContext()));
+                builder.setDeviceState(GBDevice.State.INITIALIZED);
                 // This means that both sides have been connected to and basic info has been collected.
                 // These next steps require that both sides are ready which is why they are done post
                 // individual initialization. We don't know what thread we are handling the update state
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1SideManager.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1SideManager.java
index 92c0dcf876..f61745b58e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1SideManager.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/evenrealities/G1SideManager.java
@@ -174,7 +174,7 @@ public class G1SideManager {
         sendInTransaction(transaction, new G1Communications.CommandGetDisplaySettings(this::handleDisplaySettingsPayload));
         sendInTransaction(transaction, new G1Communications.CommandGetBrightnessSettings(this::handleBrightnessSettingsPayload));
         sendInTransaction(transaction, new G1Communications.CommandGetSerialNumber(this::handleSerialNumberPayload));
-        transaction.queue(getQueue());
+        transaction.queue();
     }
 
     public void postInitializeRight() {
@@ -187,7 +187,7 @@ public class G1SideManager {
         // This setting uses the right lens as the master for the setting simply to balance the amount
         // of commands being sent to the left vs right.
         sendInTransaction(transaction, new G1Communications.CommandGetWearDetectionSettings(this::handleWearDetectionSettingsPayload));
-        transaction.queue(getQueue());
+        transaction.queue();
     }
 
     public void onSendConfiguration(String config) {
@@ -283,7 +283,7 @@ public class G1SideManager {
         TransactionBuilder transaction =
                 createTransactionBuilder.apply(command.getName(), mySide.getDeviceIndex());
         sendInTransaction(transaction, command);
-        transaction.queue(getQueue());
+        transaction.queue();
     }
 
     private void sendInTransaction(TransactionBuilder transaction, G1Communications.CommandHandler command) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/femometer/FemometerVinca2DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/femometer/FemometerVinca2DeviceSupport.java
index a76ac510cc..f0acdee5d8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/femometer/FemometerVinca2DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/femometer/FemometerVinca2DeviceSupport.java
@@ -142,7 +142,7 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         // Init Battery
         batteryInfoProfile.requestBatteryInfo(builder);
@@ -164,12 +164,12 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
         setCurrentTime(builder);
 
         // Init Thermometer
-        builder.notify(getCharacteristic(CONFIGURATION_SERVICE_INDICATION_CHARACTERISTIC), true);
+        builder.notify(CONFIGURATION_SERVICE_INDICATION_CHARACTERISTIC, true);
         healthThermometerProfile.enableNotify(builder, true);
         healthThermometerProfile.setMeasurementInterval(builder, new byte[]{(byte) 0x01, (byte) 0x00});
 
         // mark the device as initialized
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         return builder;
     }
 
@@ -177,14 +177,14 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
     public void onSetTime() {
         TransactionBuilder builder = createTransactionBuilder("set time");
         setCurrentTime(builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void setCurrentTime(TransactionBuilder builder) {
         // Same Code as in PineTime (without the local time)
         GregorianCalendar now = BLETypeConversions.createCalendar();
         byte[] bytesCurrentTime = BLETypeConversions.calendarToCurrentTime(now, 0);
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME), bytesCurrentTime);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME, bytesCurrentTime);
     }
 
     @Override
@@ -199,10 +199,10 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
                     (byte) alarm.getMinute()                   // third byte: minute
             };
 
-            builder.write(getCharacteristic(CONFIGURATION_SERVICE_ALARM_CHARACTERISTIC), alarm_bytes);
-            builder.write(getCharacteristic(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC), byteArray(0x01));
+            builder.write(CONFIGURATION_SERVICE_ALARM_CHARACTERISTIC, alarm_bytes);
+            builder.write(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC, byteArray(0x01));
             // read-request on char1 results in given alarm
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to apply setting ", e);
         }
@@ -227,7 +227,7 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
                     int value = "c".equals(scale) ? 0x0a : 0x0b;
                     applySetting(byteArray(value), null);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("exception in onSendConfiguration", e);
         }
@@ -270,11 +270,11 @@ public class FemometerVinca2DeviceSupport extends AbstractBTLESingleDeviceSuppor
     private void applySetting(byte[] value, byte[] confirmation) {
         try {
             TransactionBuilder builder = performInitialized("applyThermometerSetting");
-            builder.write(getCharacteristic(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC), value);
+            builder.write(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC, value);
             if (confirmation != null) {
-                builder.write(getCharacteristic(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC), confirmation);
+                builder.write(CONFIGURATION_SERVICE_SETTING_CHARACTERISTIC, confirmation);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to apply setting ", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/fitpro/FitProDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/fitpro/FitProDeviceSupport.java
index 8101552a36..80471633fe 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/fitpro/FitProDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/fitpro/FitProDeviceSupport.java
@@ -191,12 +191,12 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     public TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         readCharacteristic = getCharacteristic(UUID_CHARACTERISTIC_RX);
         writeCharacteristic = getCharacteristic(UUID_CHARACTERISTIC_TX);
 
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_RX), true);
-        builder.notify(getCharacteristic(GattService.UUID_SERVICE_BATTERY_SERVICE), true);
+        builder.notify(UUID_CHARACTERISTIC_RX, true);
+        builder.notify(GattService.UUID_SERVICE_BATTERY_SERVICE, true);
         builder.setCallback(this);
 
         deviceInfoProfile.requestDeviceInfo(builder);
@@ -230,7 +230,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         builder.write(writeCharacteristic, craftData(CMD_GROUP_BAND_INFO, CMD_RX_BAND_INFO));
         builder.wait(200);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         return builder;
     }
 
@@ -404,7 +404,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder("notification");
         builder.write(writeCharacteristic, craftData(CMD_GROUP_BAND_INFO, CMD_RX_BAND_INFO));
-        builder.queue(getQueue());
+        builder.queue();
 
     }
 
@@ -461,7 +461,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         } else {
             builder.write(writeCharacteristic, craftData(CMD_GROUP_GENERAL, CMD_NOTIFICATION_CALL, VALUE_OFF));
         }
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -522,7 +522,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     setAutoHeartRate(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error sending configuration: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -534,7 +534,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         short size = (short) (ByteBuffer.wrap(new byte[]{length_high, length_low}).getShort() + 3);
         byte[] sizeArray = ByteBuffer.allocate(2).putShort(size).array();
         builder.write(writeCharacteristic, new byte[]{FitProConstants.DATA_HEADER_ACK, 0, 5, command_group, 1, sizeArray[0], sizeArray[1], 1});
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -559,7 +559,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         byte currentConditionCode = Weather.mapToFitProCondition(weatherSpec.currentConditionCode);
         TransactionBuilder builder = createTransactionBuilder("weather");
         writeChunkedData(builder, craftData(CMD_GROUP_GENERAL, CMD_WEATHER, new byte[]{(byte) todayMin, (byte) todayMax, (byte) currentConditionCode, (byte) weatherUnit}));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -640,7 +640,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         }
 
         writeChunkedData(builder, craftData(CMD_GROUP_GENERAL, CMD_NOTIFICATION_MESSAGE, output.getBytes(StandardCharsets.UTF_8)));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public FitProDeviceSupport setLanguage(TransactionBuilder builder) {
@@ -739,9 +739,9 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
     public void onFetchRecordedData(int dataTypes) {
         indicateFinishedFetchingOperation();
         TransactionBuilder builder = createTransactionBuilder("fetch data1");
-        builder.setBusyTask(getDevice(), R.string.busy_task_fetch_activity_data, getContext());
+        builder.setBusyTask(R.string.busy_task_fetch_activity_data);
         builder.write(writeCharacteristic, craftData(CMD_GROUP_RECEIVE_SPORTS_DATA, CMD_REQUEST_STEPS_DATA1, VALUE_ON));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
 
@@ -870,7 +870,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         LOG.debug("FitPro set date and time");
         TransactionBuilder builder = createTransactionBuilder("Set date and time");
         setTime(builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
 
@@ -939,7 +939,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
             writeChunkedData(builder, craftData(CMD_GROUP_GENERAL, CMD_ALARM, all_alarms));
             //builder.write(writeCharacteristic, craftData(CMD_GROUP_GENERAL, CMD_ALARM, all_alarms));
-            builder.queue(getQueue());
+            builder.queue();
             if (anyAlarmEnabled) {
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
             } else {
@@ -966,14 +966,14 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         getQueue().clear();
         TransactionBuilder builder = createTransactionBuilder("resetting");
         builder.write(writeCharacteristic, command);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
     public void onHeartRateTest() {
         TransactionBuilder builder = createTransactionBuilder("notification");
         builder.write(writeCharacteristic, craftData(CMD_GROUP_GENERAL, CMD_HEART_RATE_MEASUREMENT, VALUE_ON));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -982,7 +982,7 @@ public class FitProDeviceSupport extends AbstractBTLESingleDeviceSupport {
         LOG.debug("FitPro find device");
         TransactionBuilder builder = createTransactionBuilder("searching");
         builder.write(writeCharacteristic, craftData(CMD_GROUP_GENERAL, CMD_FIND_BAND, start ? VALUE_ON : VALUE_OFF));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public FitProDeviceSupport setAutoHeartRate(TransactionBuilder builder) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/flipper/zero/support/FlipperZeroSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/flipper/zero/support/FlipperZeroSupport.java
index 258133b986..fbd8342482 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/flipper/zero/support/FlipperZeroSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/flipper/zero/support/FlipperZeroSupport.java
@@ -133,16 +133,16 @@ public class FlipperZeroSupport extends FlipperZeroBaseSupport{
             recevierRegistered = true;
         }
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-        builder.read(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_FIRMWARE_REVISION_STRING));
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
+        builder.read(GattCharacteristic.UUID_CHARACTERISTIC_FIRMWARE_REVISION_STRING);
 
         batteryInfoProfile.requestBatteryInfo(builder);
         batteryInfoProfile.enableNotify(builder, true);
 
         return builder
-                .notify(getCharacteristic(UUID.fromString(UUID_SERIAL_CHARACTERISTIC_RESPONSE)), true)
+                .notify(UUID.fromString(UUID_SERIAL_CHARACTERISTIC_RESPONSE), true)
                 .requestMtu(512)
-                .setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+                .setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     @Override
@@ -169,8 +169,8 @@ public class FlipperZeroSupport extends FlipperZeroBaseSupport{
 
     private void sendSerialData(byte[] data){
         createTransactionBuilder("send serial data")
-                .write(getCharacteristic(UUID.fromString(UUID_SERIAL_CHARACTERISTIC_WRITE)), data)
-                .queue(getQueue());
+                .write(UUID.fromString(UUID_SERIAL_CHARACTERISTIC_WRITE), data)
+                .queue();
     }
 
     private RootMessageField createMainRequest(int requestFieldNumber, MessageField... children){
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
index fd1eceaa79..03c149c28a 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
@@ -157,7 +157,7 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
 
     @Override
     protected TransactionBuilder initializeDevice(final TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         if (getDevicePrefs().getBoolean(PREF_ALLOW_HIGH_MTU, true)) {
             builder.requestMtu(515);
@@ -172,7 +172,7 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
             if (!communicatorV1.initializeDevice(builder)) {
                 // Neither V1 nor V2 worked, not a Garmin device?
                 LOG.warn("Failed to find a known Garmin service");
-                builder.setUpdateState(getDevice(), GBDevice.State.NOT_CONNECTED, getContext());
+                builder.setDeviceState(GBDevice.State.NOT_CONNECTED);
                 return builder;
             }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v1/CommunicatorV1.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v1/CommunicatorV1.java
index 6f5556ab9f..77ac0906ef 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v1/CommunicatorV1.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v1/CommunicatorV1.java
@@ -87,7 +87,7 @@ public class CommunicatorV1 implements ICommunicator {
         } else {
             builder.write(characteristicSend, payload);
         }
-        builder.queue(this.mSupport.getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v2/CommunicatorV2.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v2/CommunicatorV2.java
index 61f1d2887c..2d65c69650 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v2/CommunicatorV2.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/communicator/v2/CommunicatorV2.java
@@ -121,7 +121,7 @@ public class CommunicatorV2 implements ICommunicator {
         } else {
             builder.write(characteristicSend, ArrayUtils.addAll(new byte[]{(byte) gfdiHandle}, payload));
         }
-        builder.queue(this.mSupport.getQueue());
+        builder.queue();
     }
 
     @Override
@@ -163,7 +163,7 @@ public class CommunicatorV2 implements ICommunicator {
         if (realtimeHrHandle == 0) {
             mSupport.createTransactionBuilder("heart rate test")
                     .write(characteristicSend, registerService(Service.REALTIME_HR, false))
-                    .queue(this.mSupport.getQueue());
+                    .queue();
         }
     }
 
@@ -183,12 +183,12 @@ public class CommunicatorV2 implements ICommunicator {
         if (enable && currentHandle == 0) {
             mSupport.createTransactionBuilder(service + " = true")
                     .write(characteristicSend, registerService(service, false))
-                    .queue(this.mSupport.getQueue());
+                    .queue();
             return true;
         } else if (!enable && currentHandle != 0) {
             mSupport.createTransactionBuilder(service + " = false")
                     .write(characteristicSend, closeService(service, currentHandle))
-                    .queue(this.mSupport.getQueue());
+                    .queue();
             return true;
         }
 
@@ -247,7 +247,7 @@ public class CommunicatorV2 implements ICommunicator {
                         this.realtimeAccelHandle = handle;
                         mSupport.createTransactionBuilder("start realtime accel")
                                 .write(characteristicSend, new byte[]{(byte) handle, 0x01})
-                                .queue(this.mSupport.getQueue());
+                                .queue();
                         break;
                     case REALTIME_SPO2:
                         this.realtimeSpo2Handle = handle;
@@ -305,7 +305,7 @@ public class CommunicatorV2 implements ICommunicator {
                 this.realtimeHrvHandle = 0;
                 mSupport.createTransactionBuilder("open GFDI")
                         .write(characteristicSend, registerService(Service.GFDI, false))
-                        .queue(this.mSupport.getQueue());
+                        .queue();
                 break;
             case UNK_RESP:
                 LOG.debug("Received unknown. Message: {}", message.array());
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gatt_client/BleGattClientSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gatt_client/BleGattClientSupport.java
index 0b4263d2b7..b68058bb46 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gatt_client/BleGattClientSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gatt_client/BleGattClientSupport.java
@@ -74,12 +74,12 @@ public class BleGattClientSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         readCharacteristicIfAvailable(GattCharacteristic.UUID_CHARACTERISTIC_BATTERY_LEVEL, builder);
         readCharacteristicIfAvailable(GattCharacteristic.UUID_CHARACTERISTIC_FIRMWARE_REVISION_STRING, builder);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         return builder;
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitFetcher.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitFetcher.kt
index 9140ebf890..8feab7455e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitFetcher.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitFetcher.kt
@@ -128,7 +128,7 @@ class GloryFitFetcher(val mSupport: GloryFitSupport) {
 
         builder.write(characteristic, *cmd)
 
-        builder.queue(mSupport.queue)
+        builder.queue()
     }
 
     fun handleSleepInfo(value: ByteArray) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitSupport.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitSupport.kt
index 2f7fa1f54d..cd58b867ad 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitSupport.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gloryfit/GloryFitSupport.kt
@@ -77,10 +77,10 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
     private val mBatteryStateRequestRunnable: Runnable = Runnable {
         val builder = createTransactionBuilder("get battery")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(CMD_BATTERY)
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun useAutoConnect(): Boolean {
@@ -96,19 +96,19 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
     override fun initializeDevice(builder: TransactionBuilder): TransactionBuilder {
         fetcher.reset()
 
-        builder.setUpdateState(device, GBDevice.State.INITIALIZING, context)
+        builder.setDeviceState(GBDevice.State.INITIALIZING)
 
         builder.requestMtu(247)
 
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_READ), true)
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_READ), true)
+        builder.notify(UUID_CHARACTERISTIC_GLORYFIT_CMD_READ, true)
+        builder.notify(UUID_CHARACTERISTIC_GLORYFIT_DATA_READ, true)
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(CMD_VERSION)
         )
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(CMD_BATTERY)
         )
         if (GBApplication.getPrefs().syncTime()) {
@@ -129,7 +129,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         setEnableSmsReply(builder)
 
         // FIXME this is probably too early
-        builder.setUpdateState(device, GBDevice.State.INITIALIZED, context)
+        builder.setDeviceState(GBDevice.State.INITIALIZED)
 
         return builder
     }
@@ -341,11 +341,11 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
                     val builder = createTransactionBuilder("sms reply ack")
                     builder.write(
-                        getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                        UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                         CMD_SMS_QUICK_REPLY,
                         SMS_QUICK_REPLY_SUCCESS
                     )
-                    builder.queue(queue)
+                    builder.queue()
                 } else {
                     LOG.warn("Unhandled sms quick reply command")
                 }
@@ -425,13 +425,13 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             }
         }
 
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onFindPhone(start: Boolean) {
         val builder = createTransactionBuilder("find phone $start")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_ACTION,
                 ACTION_FIND_PHONE,
@@ -439,7 +439,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
                 if (start) 0x01 else 0x00
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onFindDevice(start: Boolean) {
@@ -455,8 +455,8 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             buf.put(0x01) // ?
 
             val builder = createTransactionBuilder("find device")
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
-            builder.queue(queue)
+            builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
+            builder.queue()
         }
     }
 
@@ -496,7 +496,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         val builder = createTransactionBuilder("set contacts")
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
             *byteArrayOf(
                 CMD_CONTACTS,
                 CONTACTS_START,
@@ -521,7 +521,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
                 buf.put(2, numAdded.toByte())
                 builder.write(
-                    getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+                    UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
                     *buf.array()
                 )
                 buf.position(0)
@@ -543,20 +543,20 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
             buf.put(2, numAdded.toByte())
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
                 *buf.array()
             )
         }
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
             *byteArrayOf(
                 CMD_CONTACTS,
                 CONTACTS_END,
                 0xfd.toByte()
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetAlarms(alarms: ArrayList<out Alarm>) {
@@ -590,10 +590,10 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             buf.put(0x00) // ?
             buf.put((i + 1).toByte()) // alarm index, starting at 1
 
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array().clone())
+            builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array().clone())
         }
 
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onNotification(notificationSpec: NotificationSpec) {
@@ -641,7 +641,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
         if (vibrationKind != VibrationKind.NONE) {
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                 *byteArrayOf(
                     CMD_VIBRATE,
                     0x00,
@@ -655,7 +655,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             )
         }
 
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetTime() {
@@ -665,7 +665,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
         val builder = createTransactionBuilder("set time")
         setTime(builder)
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetCallState(callSpec: CallSpec) {
@@ -692,7 +692,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             )
 
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                 *byteArrayOf(
                     CMD_VIBRATE,
                     0x00,
@@ -712,11 +712,11 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             buf.put(callerBytes.size.toByte())
             buf.put(callerBytes)
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                 *buf.array()
             )
 
-            builder.queue(queue)
+            builder.queue()
 
             return
         }
@@ -724,14 +724,14 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         val builder = createTransactionBuilder("call end")
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_CALL_STATUS,
                 CALL_END
             )
         )
 
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetCannedMessages(cannedMessagesSpec: CannedMessagesSpec) {
@@ -755,12 +755,12 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             buf.put(i.toByte())
             buf.put(messageBytes.size.toByte())
             buf.put(messageBytes)
-            builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE), *buf.array())
+            builder.write(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE, *buf.array())
             // TODO do we need to throttle?
         }
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
             *byteArrayOf(
                 CMD_CANNED_MESSAGES,
                 CANNED_MESSAGES_END,
@@ -768,7 +768,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             )
         )
 
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetMusicState(stateSpec: MusicStateSpec?) {
@@ -784,7 +784,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
         val builder = createTransactionBuilder("set music state")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
             *byteArrayOf(
                 CMD_MUSIC,
                 MUSIC_STATE_2,
@@ -802,14 +802,14 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
             )
         )
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_ACTION,
                 ACTION_MUSIC_VOLUME,
                 mMediaManager!!.phoneVolume.toByte()
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetMusicInfo(musicSpec: MusicSpec?) {
@@ -819,36 +819,36 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
 
         val builder = createTransactionBuilder("set music info")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_DATA_WRITE,
             *byteArrayOf(
                 CMD_MUSIC,
                 MUSIC_STATE_1
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSetPhoneVolume(volume: Float) {
         val builder = createTransactionBuilder("set phone volume")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_ACTION,
                 ACTION_MUSIC_VOLUME,
                 volume.toInt().toByte()
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onReset(flags: Int) {
         if ((flags and GBDeviceProtocol.RESET_FLAGS_FACTORY_RESET) != 0) {
             val builder = createTransactionBuilder("factory reset")
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                 CMD_FACTORY_RESET
             )
-            builder.queue(queue)
+            builder.queue()
         }
     }
 
@@ -863,7 +863,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
     override fun onSetHeartRateMeasurementInterval(seconds: Int) {
         val builder = createTransactionBuilder("set heart rate measurement interval = $seconds")
         setHeartRateMeasurementInterval(builder)
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onSendWeather(weatherSpecs: ArrayList<WeatherSpec?>?) {
@@ -880,7 +880,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
     ) {
         val builder = createTransactionBuilder("camera status change to $event")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_CAMERA,
                 when (event) {
@@ -893,7 +893,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
                 }
             )
         )
-        builder.queue(queue)
+        builder.queue()
     }
 
     override fun onFetchRecordedData(dataTypes: Int) {
@@ -912,7 +912,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(timestamp.get(Calendar.HOUR_OF_DAY).toByte())
         buf.put(timestamp.get(Calendar.MINUTE).toByte())
         buf.put(timestamp.get(Calendar.SECOND).toByte())
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     private fun setUserInfo(builder: TransactionBuilder) {
@@ -965,7 +965,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(0x01) // ?
         buf.put(heartRateAlertLow)
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     fun setGoalSteps(builder: TransactionBuilder) {
@@ -983,7 +983,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(0x00) // ?
         buf.putShort(stepsCoerced)
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     fun setGoalCalories(builder: TransactionBuilder) {
@@ -999,7 +999,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(0x01) // ?
         buf.putShort(caloriesCoerced)
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     fun setGoalDistance(builder: TransactionBuilder) {
@@ -1018,7 +1018,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(0x00) // ?
         buf.putShort(distanceCoerced)
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     private fun setSedentaryReminder(builder: TransactionBuilder) {
@@ -1056,7 +1056,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         }
         buf.put(if (lunchBreak) 0x01 else 0x00) // 12:00 - 14:00 hardcoded
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     private fun setLanguage(builder: TransactionBuilder) {
@@ -1076,7 +1076,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         LOG.debug("Setting language to {} -> {}", localeString, language)
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_LANGUAGE,
                 LANGUAGE_SET,
@@ -1100,14 +1100,14 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         buf.put(if (metric) 0x01 else 0x02)
         buf.put(if (timeFormat24h) 0x01 else 0x02)
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE), *buf.array())
+        builder.write(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE, *buf.array())
     }
 
     private fun setHeartRateMeasurementInterval(builder: TransactionBuilder) {
         val enabled = devicePrefs.getBoolean(DeviceSettingsPreferenceConst.PREF_HEARTRATE_AUTOMATIC_ENABLE, false)
         LOG.debug("Setting heart rate measurement enabled = {}", enabled)
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_HEART_RATE,
                 if (enabled) HEART_RATE_MEASURING_ON else HEART_RATE_MEASURING_OFF
@@ -1134,7 +1134,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         bufEnabled.putShort((intervalSeconds / 60).toShort())
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *bufEnabled.array()
         )
 
@@ -1148,7 +1148,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         bufTimeInterval.put(endTime.minute.toByte())
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *bufTimeInterval.array()
         )
     }
@@ -1158,7 +1158,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         // but if we disable it, the watch shows the button anyway and freezes?
         LOG.debug("Setting enable call reject button")
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_CALL_REJECT_WITH_BUTTON,
                 0x08, // 0x00 for disabled
@@ -1175,7 +1175,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         val enabled = devicePrefs.getBoolean(DeviceSettingsPreferenceConst.PREF_ENABLE_SMS_QUICK_REPLY, true)
         LOG.debug("Setting enable sms reply = {}", enabled)
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(
                 CMD_SMS_QUICK_REPLY,
                 if (enabled) 0x01 else 0x00,
@@ -1221,7 +1221,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
                 truncatedPayload.copyOfRange(byteIdx, endPos)
             )
             builder.write(
-                getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+                UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
                 *buf.array().copyOfRange(0, buf.position())
             )
             byteIdx = endPos
@@ -1231,7 +1231,7 @@ class GloryFitSupport() : AbstractBTLESingleDeviceSupport(LOG) {
         LOG.debug("Sending notification in {} chunks", chunkIdx)
 
         builder.write(
-            getCharacteristic(UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE),
+            UUID_CHARACTERISTIC_GLORYFIT_CMD_WRITE,
             *byteArrayOf(CMD_NOTIFICATION, 0xfd.toByte())
         )
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gree/GreeAcSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gree/GreeAcSupport.java
index 61c7833a5e..0f61d680d8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gree/GreeAcSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/gree/GreeAcSupport.java
@@ -59,13 +59,13 @@ public class GreeAcSupport extends AbstractBTLESingleDeviceSupport {
 
         if (characteristicTx == null || characteristicRx == null) {
             LOG.warn("Pack characteristics are null");
-            builder.setUpdateState(getDevice(), GBDevice.State.NOT_CONNECTED, getContext());
+            builder.setDeviceState(GBDevice.State.NOT_CONNECTED);
             return builder;
         }
 
         characteristicTx.setWriteType(BluetoothGattCharacteristic.WRITE_TYPE_DEFAULT);
 
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_PACK_RX), true);
+        builder.notify(UUID_CHARACTERISTIC_PACK_RX, true);
 
         final String mac = getDevice().getAddress().trim().replace(":", "").toLowerCase(Locale.ROOT);
         writeMessage(builder, new GreeBindMessage(mac.substring(mac.length() - 4)));
@@ -172,7 +172,7 @@ public class GreeAcSupport extends AbstractBTLESingleDeviceSupport {
 
             final TransactionBuilder builder = createTransactionBuilder("setup wifi");
             writeMessage(builder, new GreeWlanMessage(host, psw, ssid, 1));
-            builder.queue(getQueue());
+            builder.queue();
 
             return;
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hama/fit6900/HamaFit6900DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hama/fit6900/HamaFit6900DeviceSupport.java
index 10f11e569d..5cb49707c0 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hama/fit6900/HamaFit6900DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hama/fit6900/HamaFit6900DeviceSupport.java
@@ -79,11 +79,11 @@ public final class HamaFit6900DeviceSupport extends AbstractBTLESingleDeviceSupp
 
     @Override
     public TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         writeCharacteristic = getCharacteristic(HamaFit6900Constants.UUID_CHARACTERISTIC_TX);
 
-        builder.notify(getCharacteristic(HamaFit6900Constants.UUID_CHARACTERISTIC_RX), true);
+        builder.notify(HamaFit6900Constants.UUID_CHARACTERISTIC_RX, true);
         builder.setCallback(this);
 
         builder.write(writeCharacteristic, Message.encodeGetBatteryStatus());
@@ -102,7 +102,7 @@ public final class HamaFit6900DeviceSupport extends AbstractBTLESingleDeviceSupp
         builder.write(writeCharacteristic, makeSetLiftWristMessage());
         builder.write(writeCharacteristic, Message.encodeSetAlarms(new ArrayList(DBHelper.getAlarms(gbDevice))));
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         return builder;
     }
@@ -376,7 +376,7 @@ public final class HamaFit6900DeviceSupport extends AbstractBTLESingleDeviceSupp
         try {
             TransactionBuilder builder = performInitialized(taskName);
             builder.write(writeCharacteristic, message);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error(taskName, ex);
             return false;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hplus/HPlusSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hplus/HPlusSupport.java
index 013a1f7f22..dd8b3b0768 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hplus/HPlusSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/hplus/HPlusSupport.java
@@ -94,19 +94,19 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.info("Initializing");
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         measureCharacteristic = getCharacteristic(HPlusConstants.UUID_CHARACTERISTIC_MEASURE);
         ctrlCharacteristic = getCharacteristic(HPlusConstants.UUID_CHARACTERISTIC_CONTROL);
 
 
-        builder.notify(getCharacteristic(HPlusConstants.UUID_CHARACTERISTIC_MEASURE), true);
+        builder.notify(HPlusConstants.UUID_CHARACTERISTIC_MEASURE, true);
         builder.setCallback(this);
         builder.notify(measureCharacteristic, true);
         //Initialize device
         sendUserInfo(builder); //Sync preferences
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         if (syncHelper == null) {
             syncHelper = new HPlusHandlerThread(getDevice(), getContext(), this);
@@ -424,7 +424,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
 
             setCurrentDate(builder);
             setCurrentTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
 
         }
@@ -447,7 +447,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
 
                 Calendar t = AlarmUtils.toCalendar(alarm);
                 setAlarm(builder, t);
-                builder.queue(getQueue());
+                builder.queue();
 
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
 
@@ -455,7 +455,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
             }
 
             setAlarm(builder, null);
-            builder.queue(getQueue());
+            builder.queue();
 
             GB.toast(getContext(), getContext().getString(R.string.user_feedback_all_alarms_disabled), Toast.LENGTH_SHORT, GB.INFO);
         } catch (Exception e) {
@@ -503,7 +503,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
 
             TransactionBuilder builder = performInitialized("Shutdown");
             builder.write(ctrlCharacteristic, new byte[]{HPlusConstants.CMD_SHUTDOWN, HPlusConstants.ARG_SHUTDOWN_EN});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
 
         }
@@ -516,7 +516,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("HeartRateTest");
 
             builder.write(ctrlCharacteristic, new byte[]{HPlusConstants.CMD_SET_HEARTRATE_STATE, HPlusConstants.ARG_HEARTRATE_MEASURE_ON}); //Set Real Time... ?
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
 
         }
@@ -534,7 +534,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
                 state = HPlusConstants.ARG_HEARTRATE_ALLDAY_OFF;
 
             builder.write(ctrlCharacteristic, new byte[]{HPlusConstants.CMD_SET_ALLDAY_HRM, state});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
 
         }
@@ -546,7 +546,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("findMe");
 
             setFindMe(builder, start);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error toggling Find Me: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -565,7 +565,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
                 msg[i + 1] = (byte) "Gadgetbridge".charAt(i);
 
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error setting Vibration: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -587,7 +587,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
                     setUnit(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
         }
@@ -640,7 +640,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
             };
 
             builder.write(ctrlCharacteristic, weatherInfo);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error toggling Send Weather: " + e.getLocalizedMessage(), Toast.LENGTH_LONG,
                     GB.ERROR);
@@ -710,7 +710,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
                 builder.write(ctrlCharacteristic, msg);
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing incoming call: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
 
@@ -777,7 +777,7 @@ public class HPlusSupport extends AbstractBTLESingleDeviceSupport {
             msg[2] = (byte) remaining;
 
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing device Notification: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/HuamiSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/HuamiSupport.java
index 9148be5fd6..d1c1638fa4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/HuamiSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/HuamiSupport.java
@@ -350,16 +350,16 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
     @Override
     public void setActivityNotifications(final boolean control, final boolean data) {
         final TransactionBuilder builder = createTransactionBuilder("set activity notifications: " + control + " " + data);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL), control);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_DATA), data);
-        builder.queue(getQueue());
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL, control);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_DATA, data);
+        builder.queue();
     }
 
     @Override
     public void writeActivityControl(final String name, final byte[] value) {
         final TransactionBuilder builder = createTransactionBuilder(name);
-        builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL), value);
-        builder.queue(getQueue());
+        builder.write(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL, value);
+        builder.queue();
     }
 
     @Override
@@ -395,7 +395,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                     new InitOperation2021(authenticate, authFlags, cryptFlags, this, builder, characteristicChunked2021Write, huami2021ChunkedEncoder, huami2021ChunkedDecoder).perform();
                 } else {
                     LOG.warn("Chunked 2021 characteristics are null, will attempt to reconnect");
-                    builder.setUpdateState(getDevice(), State.WAITING_FOR_RECONNECT, getContext());
+                    builder.setDeviceState(State.WAITING_FOR_RECONNECT);
                 }
             } else {
                 new InitOperation(authenticate, authFlags, cryptFlags, this, builder).perform();
@@ -489,7 +489,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
     public void setCurrentTime(TransactionBuilder builder) {
         final Calendar now = createCalendar();
         byte[] bytes = getTimeBytes(now, TimeUnit.SECONDS);
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME), bytes);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME, bytes);
     }
 
     /**
@@ -507,15 +507,15 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
      * @param builder
      */
     public void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(gbDevice, State.INITIALIZED, getContext());
+        builder.setDeviceState(State.INITIALIZED);
     }
 
     // MB2: AVL
     // TODO: tear down the notifications on quit
     public HuamiSupport enableNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_NOTIFICATION), enable);
+        builder.notify(MiBandService.UUID_CHARACTERISTIC_NOTIFICATION, enable);
         // Notify CHARACTERISTIC9 to receive random auth code
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_AUTH), enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_AUTH, enable);
         if (characteristicChunked2021Read != null) {
             builder.notify(characteristicChunked2021Read, enable);
         }
@@ -524,12 +524,12 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
     }
 
     public void enableFurtherNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION), enable);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_6_BATTERY_INFO), enable);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_AUDIO), enable);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_AUDIODATA), enable);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_DEVICEEVENT), enable);
-        builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_WORKOUT), enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION, enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_6_BATTERY_INFO, enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_AUDIO, enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_AUDIODATA, enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_DEVICEEVENT, enable);
+        builder.notify(HuamiService.UUID_CHARACTERISTIC_WORKOUT, enable);
         if (characteristicChunked2021Read != null) {
             builder.notify(characteristicChunked2021Read, enable);
         }
@@ -699,7 +699,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized("enable heart rate sleep support: " + enable);
             setHeartrateSleepSupport(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error toggling heart rate sleep support: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -713,7 +713,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             minuteInterval = Math.max(0,minuteInterval);
             TransactionBuilder builder = performInitialized("set heart rate interval to: " + minuteInterval + " minutes");
             setHeartrateMeasurementInterval(builder, minuteInterval);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error toggling heart rate sleep support: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -809,7 +809,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized(task);
             sendDefaultNotification(builder, simpleNotification, repeat, extraAction);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send notification to MI device", ex);
         }
@@ -825,7 +825,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
 
             getNotificationStrategy().sendCustomNotification(profile, simpleNotification, 0, 0, 0, 0, extraAction, builder);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send notification to device", ex);
         }
@@ -859,7 +859,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                 anyAlarmEnabled |= alarm.getEnabled();
                 queueAlarm(alarm, builder);
             }
-            builder.queue(getQueue());
+            builder.queue();
             if (anyAlarmEnabled) {
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
             } else {
@@ -1000,7 +1000,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                 profile.setMaxLength(maxLength);
                 profile.newAlert(builder, alert);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send notification to device", ex);
         }
@@ -1026,7 +1026,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
 
         sendReminders(builder, reminders);
 
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void sendReminders(final TransactionBuilder builder) {
@@ -1132,7 +1132,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
 
         sendWorldClocks(builder, clocks);
 
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void setWorldClocks(final TransactionBuilder builder) {
@@ -1162,7 +1162,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             //TODO: once we have a common strategy for sending events (e.g. EventHandler), remove this call from here. Meanwhile it does no harm.
             // = we should genaralize the pebble calender code
             sendCalendarEvents(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to set time on Huami device", ex);
         }
@@ -1199,7 +1199,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             try {
                 TransactionBuilder builder = performInitialized("incoming call");
                 writeToChunked(builder, 0, buf.array());
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 LOG.error("Unable to send incoming call");
             }
@@ -1207,7 +1207,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             try {
                 TransactionBuilder builder = performInitialized("end call");
                 writeToChunked(builder, 0, new byte[]{3, 3, 0, 0, 0, 0});
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 LOG.error("Unable to send end call");
             }
@@ -1218,7 +1218,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized("stop notification");
             getNotificationStrategy().stopCurrentNotification(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error stopping call notification");
         }
@@ -1247,7 +1247,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                     buf.put((byte) 0x00);
                     writeToChunked2021(builder, (short) 0x0013, buf.array(), false);
                 }
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.error("Unable to set canned messages on Huami device", ex);
             }
@@ -1317,7 +1317,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             final TransactionBuilder builder = performInitialized("send volume");
             writeToChunked(builder, 3, volumeCommand);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final IOException e) {
             LOG.error("Unable to send volume", e);
         }
@@ -1337,7 +1337,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized("send playback info");
             writeToChunked(builder, 3, encodeMusicState(getContext(), musicSpec, musicStateSpec, false));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Unable to send playback state");
         }
@@ -1441,14 +1441,14 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             } else {
                 sendReboot(builder);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to reset", ex);
         }
     }
 
     public void sendReboot(TransactionBuilder builder) {
-        builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL), new byte[] { HuamiService.COMMAND_FIRMWARE_REBOOT});
+        builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, HuamiService.COMMAND_FIRMWARE_REBOOT);
     }
 
     public void sendFactoryReset(TransactionBuilder builder) {
@@ -1466,7 +1466,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             builder.write(characteristicHRControlPoint, stopHeartMeasurementContinuous);
             builder.write(characteristicHRControlPoint, stopHeartMeasurementManual);
             builder.write(characteristicHRControlPoint, startHeartMeasurementManual);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to read heart rate from Huami device", ex);
         }
@@ -1486,7 +1486,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             } else {
                 builder.write(characteristicHRControlPoint, stopHeartMeasurementContinuous);
             }
-            builder.queue(getQueue());
+            builder.queue();
             enableRealtimeSamplesTimer(enable);
         } catch (IOException ex) {
             LOG.error("Unable to enable realtime heart rate measurement", ex);
@@ -1531,7 +1531,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized("find huami");
             builder.write(characteristic, start ? new byte[] {3} : new byte[] {0});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("error while sending find Huami device command", e);
         }
@@ -1547,10 +1547,10 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized(enable ? "Enabling realtime steps notifications" : "Disabling realtime steps notifications");
             if (enable) {
-                builder.read(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_7_REALTIME_STEPS));
+                builder.read(HuamiService.UUID_CHARACTERISTIC_7_REALTIME_STEPS);
             }
-            builder.notify(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_7_REALTIME_STEPS), enable);
-            builder.queue(getQueue());
+            builder.notify(HuamiService.UUID_CHARACTERISTIC_7_REALTIME_STEPS, enable);
+            builder.queue();
             enableRealtimeSamplesTimer(enable);
         } catch (IOException e) {
             LOG.error("Unable to change realtime steps notification to: " + enable, e);
@@ -1572,7 +1572,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             TransactionBuilder builder = performInitialized("Vibrate once");
             builder.write(characteristic,new byte[] {3});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("error while sending simple vibrate command", e);
         }
@@ -1686,7 +1686,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                 LOG.info("An alarm was toggled or changed");
                 TransactionBuilder builder = createTransactionBuilder("requestAlarms");
                 requestAlarms(builder);
-                builder.queue(getQueue());
+                builder.queue();
                 break;
             case HuamiDeviceEvent.FELL_ASLEEP:
                 LOG.info("Fell asleep");
@@ -1905,7 +1905,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             final TransactionBuilder builder = performInitialized("send phone gps location");
             writeToChunked(builder, 6, buf.array());
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final IOException e) {
             LOG.error("Unable to send location", e);
         }
@@ -1927,7 +1927,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             TransactionBuilder builder = performInitialized("acknowledge find phone");
 
             writeToConfiguration(builder,AmazfitBipService.COMMAND_ACK_FIND_PHONE_IN_PROGRESS);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error while ending acknowledge find phone", ex);
         }
@@ -1943,7 +1943,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             final TransactionBuilder builder = performInitialized("send phone silent mode");
             sendPhoneSilentMode(builder, enabled);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final Exception ex) {
             LOG.error("Error while sending phone silent mode", ex);
         }
@@ -2255,7 +2255,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             final TransactionBuilder builder = createTransactionBuilder("send chunked ack");
             builder.write(characteristicChunked2021Read, new byte[] {0x04, 0x00, handle, 0x01, count});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to send chunked ack", e);
         }
@@ -2730,7 +2730,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                     setPassword(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
         }
@@ -2743,7 +2743,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             final TransactionBuilder builder = performInitialized("test request");
             writeToConfiguration(builder, HuamiService.COMMAND_REQUEST_WORKOUT_ACTIVITY_TYPES);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("onTestNewFunction failed", e);
         }
@@ -2862,10 +2862,10 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             if (characteristicChunked != null) {
                 writeToChunked(builder, 1, buf.array());
             } else {
-                builder.write(getCharacteristic(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER), buf.array());
+                builder.write(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER, buf.array());
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending current weather", ex);
         }
@@ -2893,10 +2893,10 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             if (characteristicChunked != null) {
                 writeToChunked(builder, 1, buf.array());
             } else {
-                builder.write(getCharacteristic(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER), buf.array());
+                builder.write(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER, buf.array());
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Error sending air quality");
         }
@@ -2969,10 +2969,10 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             if (characteristicChunked != null) {
                 writeToChunked(builder, 1, buf.array());
             } else {
-                builder.write(getCharacteristic(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER), buf.array());
+                builder.write(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER, buf.array());
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending weather forecast", ex);
         }
@@ -2992,10 +2992,10 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             if (characteristicChunked != null) {
                 writeToChunked(builder, 1, buf.array());
             } else {
-                builder.write(getCharacteristic(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER), buf.array());
+                builder.write(AmazfitBipService.UUID_CHARACTERISTIC_WEATHER, buf.array());
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception ex) {
             LOG.error("Error sending current forecast location", ex);
         }
@@ -3020,7 +3020,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                 buf.put(humidityString.getBytes());
                 buf.put((byte) 0);
                 writeToChunked(builder, 1, buf.array());
-                builder.queue(getQueue());
+                builder.queue();
             } catch (Exception ex) {
                 LOG.error("Error sending wind/humidity", ex);
             }
@@ -3054,7 +3054,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                         buf.put((byte) sunriseTransitSet.getSunset().getMinute());
 
                         writeToChunked(builder, 1, buf.array());
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (Exception ex) {
                         LOG.error("Error sending sunset/sunrise", ex);
                     }
@@ -3753,7 +3753,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
         try {
             final TransactionBuilder builder = createTransactionBuilder(taskName);
             writeToChunked2021(builder, type, data, encrypt);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to {}", taskName, e);
         }
@@ -3764,7 +3764,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
             data = ArrayUtils.insert(0, data, (byte) 1);
             writeToChunked2021(builder, CHUNKED2021_ENDPOINT_COMPAT, data, true);
         } else {
-            builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION), data);
+            builder.write(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION, data);
         }
     }
 
@@ -3926,7 +3926,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                 try {
                     TransactionBuilder builder = performInitialized("allow sms reply");
                     writeToChunked2021(builder, ZeppOsCannedMessagesService.ENDPOINT, new byte[]{(byte) ZeppOsCannedMessagesService.CMD_REPLY_SMS_ALLOW, 0x01}, false);
-                    builder.queue(getQueue());
+                    builder.queue();
                 } catch (IOException e) {
                     LOG.error("Unable to allow sms reply");
                 }
@@ -3953,7 +3953,7 @@ public abstract class HuamiSupport extends AbstractBTLESingleDeviceSupport
                         TransactionBuilder builder = performInitialized("ack sms reply");
                         byte[] ackSentCommand = new byte[]{ZeppOsCannedMessagesService.CMD_REPLY_SMS_ACK, 0x01};
                         writeToChunked2021(builder, ZeppOsCannedMessagesService.ENDPOINT, ackSentCommand, false);
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         LOG.error("Unable to ack sms reply");
                     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/amazfitneo/AmazfitNeoSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/amazfitneo/AmazfitNeoSupport.java
index 1373012a00..58b4c0db41 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/amazfitneo/AmazfitNeoSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/amazfitneo/AmazfitNeoSupport.java
@@ -109,7 +109,7 @@ public class AmazfitNeoSupport extends MiBand5Support {
             TransactionBuilder builder = performInitialized("HeartRateTest");
             enableNotifyHeartRateMeasurements(true, builder);
             builder.write(characteristicHRControlPoint, new byte[]{ 0x15, 0x01, 0x01 });
-            builder.queue(getQueue());
+            builder.queue();
             heartRateTestStarted = true;
         } catch (IOException ex) {
             LOG.error("Unable to read heart rate from Huami device", ex);
@@ -142,7 +142,7 @@ public class AmazfitNeoSupport extends MiBand5Support {
                 builder.write(characteristicHRControlPoint, new byte[] { 0x15, 0x01, 0x00 });
                 heartRateRealtimeStarted = false;
             }
-            builder.queue(getQueue());
+            builder.queue();
             enableRealtimeSamplesTimer(enable);
         } catch (IOException ex) {
             LOG.error("Unable to enable realtime heart rate measurement", ex);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation.java
index 4346692ee4..c4df8efcfe 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation.java
@@ -69,14 +69,14 @@ public class InitOperation extends AbstractBTLEOperation<HuamiSupport> {
     protected void doPerform() {
         huamiSupport.enableNotifications(builder, true);
         if (needsAuth) {
-            builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+            builder.setDeviceState(GBDevice.State.AUTHENTICATING);
             // write key to device
             byte[] sendKey = org.apache.commons.lang3.ArrayUtils.addAll(new byte[]{HuamiService.AUTH_SEND_KEY, authFlags}, getSecretKey());
-            builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_AUTH), sendKey);
+            builder.write(HuamiService.UUID_CHARACTERISTIC_AUTH, sendKey);
         } else {
-            builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
             // get random auth number
-            builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_AUTH), requestAuthNumber());
+            builder.write(HuamiService.UUID_CHARACTERISTIC_AUTH, requestAuthNumber());
         }
     }
 
@@ -143,7 +143,7 @@ public class InitOperation extends AbstractBTLEOperation<HuamiSupport> {
             } else if ((value[1] & 0x0f) == HuamiService.AUTH_SEND_ENCRYPTED_AUTH_NUMBER) {
                 if (value[2] == HuamiService.AUTH_SUCCESS) {
                     TransactionBuilder builder = createTransactionBuilder("Authenticated, now initialize phase 2");
-                    builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+                    builder.setDeviceState(GBDevice.State.INITIALIZING);
                     builder.setCallback(null); // remove init operation as the callback
                     huamiSupport.enableFurtherNotifications(builder, true);
                     huamiSupport.requestDeviceInfo(builder);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation2021.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation2021.java
index 7180204c4f..93ed491601 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation2021.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/init/InitOperation2021.java
@@ -73,7 +73,7 @@ public class InitOperation2021 extends InitOperation implements Huami2021Handler
     @Override
     protected void doPerform() {
         huamiSupport.enableNotifications(builder, true);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         // get random auth number
         generateKeyPair();
         final byte[] sendPubKeyCommand = new byte[48 + 4];
@@ -162,7 +162,7 @@ public class InitOperation2021 extends InitOperation implements Huami2021Handler
 
             try {
                 final TransactionBuilder builder = createTransactionBuilder("Authenticated, now initialize phase 2");
-                builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+                builder.setDeviceState(GBDevice.State.INITIALIZING);
                 builder.setCallback(null); // remove init operation as the callback
                 huamiSupport.enableFurtherNotifications(builder, true);
                 huamiSupport.setCurrentTime(builder);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation.java
index 337bb5fa8e..1980301e31 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation.java
@@ -153,7 +153,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
                         if (getFirmwareInfo().getFirmwareType() == HuamiFirmwareType.FIRMWARE) {
                             TransactionBuilder builder = performInitialized("reboot");
                             getSupport().sendReboot(builder);
-                            builder.queue(getQueue());
+                            builder.queue();
                         } else {
                             GB.updateInstallNotification(getContext().getString(R.string.updatefirmwareoperation_update_complete), false, 100, getContext());
                             done();
@@ -195,7 +195,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
         try {
             TransactionBuilder builder = performInitialized("send firmware info");
 //                getSupport().setLowLatency(builder);
-            builder.setBusyTask(getDevice(), R.string.updating_firmware, getContext());
+            builder.setBusyTask(R.string.updating_firmware);
             int fwSize = getFirmwareInfo().getSize();
             byte[] sizeBytes = BLETypeConversions.fromUint24(fwSize);
             int arraySize = 4;
@@ -214,7 +214,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
             }
 
             builder.write(fwCControlChar, bytes);
-            builder.queue(getQueue());
+            builder.queue();
             return true;
         } catch (IOException e) {
             LOG.error("Error sending firmware info: " + e.getLocalizedMessage(), e);
@@ -254,7 +254,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
                 int progressPercent = (int) ((((float) firmwareProgress) / len) * 100);
                 if ((i > 0) && (i % 100 == 0)) {
                     builder.write(fwCControlChar, new byte[]{HuamiService.COMMAND_FIRMWARE_UPDATE_SYNC});
-                    builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, getContext());
+                    builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
                 }
             }
 
@@ -264,7 +264,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
             }
 
             builder.write(fwCControlChar, new byte[]{HuamiService.COMMAND_FIRMWARE_UPDATE_SYNC});
-            builder.queue(getQueue());
+            builder.queue();
 
         } catch (IOException ex) {
             LOG.error("Unable to send fw to device", ex);
@@ -284,7 +284,7 @@ public class UpdateFirmwareOperation extends AbstractMiBandOperation<HuamiSuppor
                 bytes[0],
                 bytes[1],
         });
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     protected AbstractHuamiFirmwareInfo getFirmwareInfo() {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation2020.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation2020.java
index 338f6283b9..41d887325e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation2020.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperation2020.java
@@ -105,7 +105,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
                         if (getFirmwareInfo().getFirmwareType() == HuamiFirmwareType.FIRMWARE) {
                             TransactionBuilder builder = performInitialized("reboot");
                             getSupport().sendReboot(builder);
-                            builder.queue(getQueue());
+                            builder.queue();
                         } else {
                             GB.updateInstallNotification(getContext().getString(R.string.updatefirmwareoperation_update_complete), false, 100, getContext());
                             done();
@@ -154,7 +154,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
     public boolean sendFwInfo() {
         try {
             TransactionBuilder builder = performInitialized("send firmware info");
-            builder.setBusyTask(getDevice(), R.string.updating_firmware, getContext());
+            builder.setBusyTask(R.string.updating_firmware);
             int fwSize = getFirmwareInfo().getSize();
             byte[] sizeBytes = BLETypeConversions.fromUint32(fwSize);
             byte[] bytes = buildFirmwareInfoCommand();
@@ -176,7 +176,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
                 }
             }
             builder.write(fwCControlChar, bytes);
-            builder.queue(getQueue());
+            builder.queue();
             return true;
         } catch (IOException e) {
             LOG.error("Error sending firmware info: " + e.getLocalizedMessage(), e);
@@ -218,7 +218,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
             TransactionBuilder builder = performInitialized("get update capabilities");
             byte[] bytes = new byte[]{COMMAND_REQUEST_PARAMETERS};
             builder.write(fwCControlChar, bytes);
-            builder.queue(getQueue());
+            builder.queue();
             return true;
         } catch (IOException e) {
             LOG.error("Error sending firmware info: " + e.getLocalizedMessage(), e);
@@ -263,9 +263,9 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
 
             int progressPercent = (int) ((((float) (offset + chunkLength)) / len) * 100);
 
-            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, getContext());
+            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
 
-            builder.queue(getQueue());
+            builder.queue();
 
         } catch (IOException ex) {
             LOG.error("Unable to send fw to device", ex);
@@ -281,7 +281,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
         builder.write(fwCControlChar, new byte[]{
                 COMMAND_START_TRANSFER, 1,
         });
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     protected void sendTransferComplete() throws IOException {
@@ -289,7 +289,7 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
         builder.write(fwCControlChar, new byte[]{
                 COMMAND_COMPLETE_TRANSFER,
         });
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     protected void sendFinalize() throws IOException {
@@ -297,6 +297,6 @@ public class UpdateFirmwareOperation2020 extends UpdateFirmwareOperation {
         builder.write(fwCControlChar, new byte[]{
                 COMMAND_FINALIZE_UPDATE,
         });
-        builder.queue(getQueue());
+        builder.queue();
     }
 }
\ No newline at end of file
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperationNew.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperationNew.java
index 7766b950b3..724b36a44f 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperationNew.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/operations/update/UpdateFirmwareOperationNew.java
@@ -46,7 +46,7 @@ public class UpdateFirmwareOperationNew extends UpdateFirmwareOperation {
     public boolean sendFwInfo() {
         try {
             TransactionBuilder builder = performInitialized("send firmware info");
-            builder.setBusyTask(getDevice(), R.string.updating_firmware, getContext());
+            builder.setBusyTask(R.string.updating_firmware);
             int fwSize = getFirmwareInfo().getSize();
             byte[] sizeBytes = BLETypeConversions.fromUint32(fwSize);
             byte[] bytes = new byte[10];
@@ -67,7 +67,7 @@ public class UpdateFirmwareOperationNew extends UpdateFirmwareOperation {
             if (getFirmwareInfo().getFirmwareType() == HuamiFirmwareType.WATCHFACE) {
                 byte[] fwBytes = firmwareInfo.getBytes();
                 if (ArrayUtils.startsWith(fwBytes, UIHH_HEADER)) {
-                    builder.write(getCharacteristic(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION),
+                    builder.write(HuamiService.UUID_CHARACTERISTIC_3_CONFIGURATION,
                             new byte[]{0x39, 0x00, 0x00, (byte) 0xff, (byte) 0xff, (byte) 0xff,
                                     fwBytes[18],
                                     fwBytes[19],
@@ -77,7 +77,7 @@ public class UpdateFirmwareOperationNew extends UpdateFirmwareOperation {
                 }
             }
             builder.write(fwCControlChar, bytes);
-            builder.queue(getQueue());
+            builder.queue();
             return true;
         } catch (IOException e) {
             LOG.error("Error sending firmware info: " + e.getLocalizedMessage(), e);
@@ -89,7 +89,7 @@ public class UpdateFirmwareOperationNew extends UpdateFirmwareOperation {
     protected void sendChecksum(AbstractHuamiFirmwareInfo firmwareInfo) throws IOException {
         TransactionBuilder builder = performInitialized("send firmware upload finished");
         builder.write(fwCControlChar, new byte[]{HuamiService.COMMAND_FIRMWARE_CHECKSUM});
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/AbstractZeppOsService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/AbstractZeppOsService.java
index 610c8ae699..f70bb1e32a 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/AbstractZeppOsService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/AbstractZeppOsService.java
@@ -25,7 +25,6 @@ import org.slf4j.LoggerFactory;
 
 import java.util.function.Consumer;
 
-import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.deviceevents.GBDeviceEvent;
 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;
 import nodomain.freeyourgadget.gadgetbridge.devices.huami.zeppos.ZeppOsCoordinator;
@@ -123,7 +122,7 @@ public abstract class AbstractZeppOsService {
     protected void withTransactionBuilder(final String taskName, final Consumer<ZeppOsTransactionBuilder> consumer) {
         final ZeppOsTransactionBuilder builder = createTransactionBuilder(taskName);
         consumer.accept(builder);
-        builder.queue(mSupport);
+        builder.queue();
     }
 
     @Nullable
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrSupport.java
index c4bfa0da99..96b84dd4d3 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrSupport.java
@@ -259,7 +259,7 @@ public class ZeppOsBtbrSupport extends AbstractBTBRDeviceSupport implements Zepp
                 sessionNonce = RandomUtils.insecure().randomInt();
                 final TransactionBuilder builder = createTransactionBuilder("session start");
                 write(builder, CMD_SESSION_START, BLETypeConversions.fromUint32(sessionNonce));
-                builder.queue(getQueue());
+                builder.queue();
                 return;
             }
             case CMD_SESSION_START_ACK: {
@@ -287,7 +287,7 @@ public class ZeppOsBtbrSupport extends AbstractBTBRDeviceSupport implements Zepp
 
                 final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("auth phase 1");
                 zeppOsSupport.initializeDevice(builder);
-                builder.queue(zeppOsSupport);
+                builder.queue();
 
                 return;
             }
@@ -336,7 +336,7 @@ public class ZeppOsBtbrSupport extends AbstractBTBRDeviceSupport implements Zepp
                     // untested, based on what we see in the watch->phone ack when requested
                     final TransactionBuilder builder = createTransactionBuilder("channel ack");
                     write(builder, CMD_CHANNEL_ACK, new byte[]{session, seqNumRx, 0x01 /* ok */, 0x00 /* ? */});
-                    builder.queue(getQueue());
+                    builder.queue();
                 }
                 return;
             }
@@ -361,7 +361,7 @@ public class ZeppOsBtbrSupport extends AbstractBTBRDeviceSupport implements Zepp
 
                 final TransactionBuilder builder = createTransactionBuilder("pong");
                 write(builder, CMD_PONG, new byte[]{session, 0x01, 0x00, 0x00});
-                builder.queue(getQueue());
+                builder.queue();
 
                 // When we send a ping, watch replies with a pong. However, we never actually saw it happen
                 // in the other direction, and sending the pong is not enough. The official app will
@@ -409,7 +409,7 @@ public class ZeppOsBtbrSupport extends AbstractBTBRDeviceSupport implements Zepp
     private void sendPing() {
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("ping with request apps");
         zeppOsSupport.requestApps(builder);
-        builder.queue(zeppOsSupport);
+        builder.queue();
     }
 
     // =============================================================================================
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrTransactionBuilder.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrTransactionBuilder.java
index 0cb824fb24..dc552dcd3c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrTransactionBuilder.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtbrTransactionBuilder.java
@@ -16,8 +16,6 @@
     along with this program.  If not, see <https://www.gnu.org/licenses/>. */
 package nodomain.freeyourgadget.gadgetbridge.service.devices.huami.zeppos;
 
-import android.content.Context;
-
 import androidx.annotation.StringRes;
 
 import java.util.UUID;
@@ -40,18 +38,18 @@ public class ZeppOsBtbrTransactionBuilder implements ZeppOsTransactionBuilder {
     }
 
     @Override
-    public void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage, final Context context) {
-        mBuilder.setProgress(textRes, ongoing, percentage, context);
+    public void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage) {
+        mBuilder.setProgress(textRes, ongoing, percentage);
     }
 
     @Override
-    public void setDeviceState(final GBDevice device, final GBDevice.State deviceState, final Context context) {
-        mBuilder.setUpdateState(device, deviceState, context);
+    public void setDeviceState(final GBDevice.State deviceState) {
+        mBuilder.setDeviceState(deviceState);
     }
 
     @Override
-    public void setBusy(final GBDevice device, @StringRes final int stringRes, final Context context) {
-        mBuilder.setBusyTask(device, stringRes, context);
+    public void setBusy(@StringRes final int stringRes) {
+        mBuilder.setBusyTask(stringRes);
     }
 
     @Override
@@ -65,7 +63,7 @@ public class ZeppOsBtbrTransactionBuilder implements ZeppOsTransactionBuilder {
     }
 
     @Override
-    public void queue(final ZeppOsSupport support) {
-        mBuilder.queue(mSupport.getQueue());
+    public void queue() {
+        mBuilder.queue();
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleSupport.java
index a1b7fa31e6..d3f71c1c8f 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleSupport.java
@@ -119,7 +119,7 @@ public class ZeppOsBtleSupport extends AbstractBTLESingleDeviceSupport implement
         final BluetoothGattCharacteristic characteristicChunked2021Write = getCharacteristic(HuamiService.UUID_CHARACTERISTIC_CHUNKEDTRANSFER_2021_WRITE);
         if (characteristicChunked2021Write == null || characteristicChunked2021Read == null) {
             LOG.warn("Chunked 2021 characteristics are null, will attempt to reconnect");
-            builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleTransactionBuilder.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleTransactionBuilder.java
index c0deef3d88..ca41343b96 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleTransactionBuilder.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsBtleTransactionBuilder.java
@@ -16,8 +16,6 @@
     along with this program.  If not, see <https://www.gnu.org/licenses/>. */
 package nodomain.freeyourgadget.gadgetbridge.service.devices.huami.zeppos;
 
-import android.content.Context;
-
 import androidx.annotation.StringRes;
 
 import java.util.UUID;
@@ -40,33 +38,33 @@ public class ZeppOsBtleTransactionBuilder implements ZeppOsTransactionBuilder {
     }
 
     @Override
-    public void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage, final Context context) {
-        mBuilder.setProgress(textRes, ongoing, percentage, context);
+    public void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage) {
+        mBuilder.setProgress(textRes, ongoing, percentage);
     }
 
     @Override
-    public void setDeviceState(final GBDevice device, final GBDevice.State deviceState, final Context context) {
-        mBuilder.setUpdateState(device, deviceState, context);
+    public void setDeviceState(final GBDevice.State deviceState) {
+        mBuilder.setDeviceState(deviceState);
     }
 
     @Override
-    public void setBusy(final GBDevice device, @StringRes final int stringRes, final Context context) {
-        mBuilder.setBusyTask(device, stringRes, context);
+    public void setBusy(@StringRes final int stringRes) {
+        mBuilder.setBusyTask(stringRes);
     }
 
     @Override
     public void notify(final UUID characteristic, final boolean enable) {
-        mBuilder.notify(mSupport.getCharacteristic(characteristic), enable);
+        mBuilder.notify(characteristic, enable);
     }
 
     @Override
     public void write(final UUID characteristic, final byte[] arr) {
-        mBuilder.write(mSupport.getCharacteristic(characteristic), arr);
+        mBuilder.write(characteristic, arr);
     }
 
     @Override
-    public void queue(final ZeppOsSupport support) {
-        mBuilder.queue(mSupport.getQueue());
+    public void queue() {
+        mBuilder.queue();
     }
 
     public TransactionBuilder getTransactionBuilder() {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsSupport.java
index 7bda1eebb1..58a476de0b 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsSupport.java
@@ -297,7 +297,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         huami2021ChunkedDecoder.reset();
         fetcher.reset();
 
-        builder.setDeviceState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+        builder.setDeviceState(GBDevice.State.AUTHENTICATING);
 
         authenticationService.startAuthentication(builder);
     }
@@ -367,7 +367,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         configService.newSetter()
                 .setByte(HEART_RATE_ALL_DAY_MONITORING, (byte) minuteInterval)
                 .write(builder);
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -409,7 +409,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
     public void onSetReminders(final ArrayList<? extends Reminder> reminders) {
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("onSetReminders");
         remindersService.sendReminders(builder, reminders);
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -632,7 +632,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
                 .setBoolean(SLEEP_HIGH_ACCURACY_MONITORING, enableHrSleepSupport)
                 .write(builder);
 
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -656,7 +656,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
             } else {
                 communicator.setCurrentTime(builder);
             }
-            builder.queue(this);
+            builder.queue();
         }
 
         CalendarReceiver.forceSync(getDevice());
@@ -820,7 +820,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         LOG.info("ZeppOS phase 2 initialize...");
 
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("phase 2 initialize");
-        builder.setDeviceState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         communicator.onAuthenticationSuccess(builder);
 
@@ -834,7 +834,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         mSupportedServices.clear();
         servicesService.requestServices(builder);
 
-        builder.queue(this);
+        builder.queue();
     }
 
     public void addSupportedService(final short endpoint, final boolean encrypted) {
@@ -869,9 +869,9 @@ public class ZeppOsSupport extends AbstractDeviceSupport
             }
         }
 
-        builder.setDeviceState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -879,7 +879,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("set activity notifications: " + control + " " + data);
         builder.notify(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL, control);
         builder.notify(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_DATA, data);
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -889,7 +889,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
         } else {
             final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder(name);
             builder.write(HuamiService.UUID_CHARACTERISTIC_5_ACTIVITY_CONTROL, value);
-            builder.queue(this);
+            builder.queue();
         }
     }
 
@@ -921,7 +921,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
             builder.write(HuamiService.UUID_CHARACTERISTIC_RAW_SENSOR_CONTROL, Huami2021Service.CMD_RAW_SENSOR_STOP);
         }
         builder.notify(HuamiService.UUID_CHARACTERISTIC_RAW_SENSOR_DATA, enable);
-        builder.queue(this);
+        builder.queue();
     }
 
     private void handleRawSensorData(final byte[] value) {
@@ -1068,7 +1068,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
 
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder("send chunked ack");
         builder.write(HuamiService.UUID_CHARACTERISTIC_CHUNKEDTRANSFER_2021_READ, new byte[] {0x04, 0x00, handle, 0x01, count});
-        builder.queue(this);
+        builder.queue();
     }
 
     @Override
@@ -1149,7 +1149,7 @@ public class ZeppOsSupport extends AbstractDeviceSupport
     public void writeToChunked2021(final String taskName, final short type, final byte[] data, final boolean encrypt) {
         final ZeppOsTransactionBuilder builder = createZeppOsTransactionBuilder(taskName);
         writeToChunked2021(builder, type, data, encrypt);
-        builder.queue(this);
+        builder.queue();
     }
 
     public ZeppOsTransactionBuilder createZeppOsTransactionBuilder(final String taskName) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsTransactionBuilder.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsTransactionBuilder.java
index c052c5d9b0..4b0ff45ff3 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsTransactionBuilder.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/ZeppOsTransactionBuilder.java
@@ -16,8 +16,6 @@
     along with this program.  If not, see <https://www.gnu.org/licenses/>. */
 package nodomain.freeyourgadget.gadgetbridge.service.devices.huami.zeppos;
 
-import android.content.Context;
-
 import androidx.annotation.StringRes;
 
 import java.util.UUID;
@@ -25,15 +23,15 @@ import java.util.UUID;
 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;
 
 public interface ZeppOsTransactionBuilder {
-    void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage, final Context context);
+    void setProgress(@StringRes final int textRes, final boolean ongoing, final int percentage);
 
-    void setDeviceState(final GBDevice device, final GBDevice.State deviceState, final Context context);
+    void setDeviceState(final GBDevice.State deviceState);
 
-    void setBusy(final GBDevice device, @StringRes final int stringRes, final Context context);
+    void setBusy(@StringRes final int stringRes);
 
     void notify(final UUID characteristic, final boolean enable);
 
     void write(final UUID characteristic, final byte[] arr);
 
-    void queue(final ZeppOsSupport support);
+    void queue();
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsAgpsUpdateOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsAgpsUpdateOperation.java
index 2e80e19fd6..fa0a337d2c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsAgpsUpdateOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsAgpsUpdateOperation.java
@@ -120,7 +120,7 @@ public class ZeppOsAgpsUpdateOperation extends AbstractZeppOsOperation<ZeppOsSup
             try {
                 final ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("request agps config");
                 configService.requestConfig(builder, ZeppOsConfigService.ConfigGroup.AGPS);
-                builder.queue(getSupport());
+                builder.queue();
             } catch (final Exception e) {
                 LOG.error("Failed to request agps config", e);
             }
@@ -132,8 +132,8 @@ public class ZeppOsAgpsUpdateOperation extends AbstractZeppOsOperation<ZeppOsSup
     private void updateProgress(final int progressPercent) {
         try {
             final ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("send agps update progress");
-            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, getContext());
-            builder.queue(getSupport());
+            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to update progress notification", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsFirmwareUpdateOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsFirmwareUpdateOperation.java
index d9f87ecb87..ff118856a8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsFirmwareUpdateOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsFirmwareUpdateOperation.java
@@ -89,7 +89,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("fw update starting");
         enableOtherNotifications(builder, false);
         enableNeededNotifications(builder, true);
-        builder.queue(getSupport());
+        builder.queue();
 
         fwHelper = new ZeppOsFwHelper(
                 uri,
@@ -113,7 +113,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("fw update finish");
         enableNeededNotifications(builder, false);
         enableOtherNotifications(builder, true);
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     protected void done() {
@@ -160,7 +160,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
                         if (fwHelper.getFirmwareType() == HuamiFirmwareType.FIRMWARE) {
                             ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("reboot");
                             builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, new byte[]{HuamiService.COMMAND_FIRMWARE_REBOOT});
-                            builder.queue(getSupport());
+                            builder.queue();
                         } else {
                             GB.updateInstallNotification(getContext().getString(R.string.updatefirmwareoperation_update_complete), false, 100, getContext());
                             done();
@@ -207,13 +207,13 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
                 ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("request display items and apps");
                 getSupport().requestDisplayItems(builder);
                 getSupport().requestApps(builder);
-                builder.queue(getSupport());
+                builder.queue();
             } else if (fwHelper.getFirmwareType() == HuamiFirmwareType.WATCHFACE) {
                 // After a watchface is installed, request the watchfaces from the band (new watchface will be at the end)
                 ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("request watchfaces and apps");
                 getSupport().requestWatchfaces(builder);
                 getSupport().requestApps(builder);
-                builder.queue(getSupport());
+                builder.queue();
             }
         }
     }
@@ -224,9 +224,9 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
 
     public void sendFwInfo() {
         ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("send firmware info");
-        builder.setBusy(getDevice(), R.string.updating_firmware, getContext());
+        builder.setBusy(R.string.updating_firmware);
         builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, buildFirmwareInfoCommand());
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     protected byte[] buildFirmwareInfoCommand() {
@@ -259,7 +259,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("get update capabilities");
         byte[] bytes = new byte[]{UpdateFirmwareOperation2020.COMMAND_REQUEST_PARAMETERS};
         builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, bytes);
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     private void sendFirmwareDataChunk(int offset) {
@@ -301,9 +301,9 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
 
             int progressPercent = (int) ((((float) (offset + chunkLength)) / len) * 100);
 
-            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, getContext());
+            builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
 
-            builder.queue(getSupport());
+            builder.queue();
 
         } catch (final IOException e) {
             LOG.error("Unable to send fw to device", e);
@@ -316,7 +316,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, new byte[]{
                 UpdateFirmwareOperation2020.COMMAND_START_TRANSFER, 1,
         });
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     private void sendTransferComplete() {
@@ -324,7 +324,7 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, new byte[]{
                 UpdateFirmwareOperation2020.COMMAND_COMPLETE_TRANSFER,
         });
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     private void sendFinalize() {
@@ -332,6 +332,6 @@ public class ZeppOsFirmwareUpdateOperation extends AbstractZeppOsOperation<ZeppO
         builder.write(HuamiService.UUID_CHARACTERISTIC_FIRMWARE_CONTROL, new byte[]{
                 UpdateFirmwareOperation2020.COMMAND_FINALIZE_UPDATE,
         });
-        builder.queue(getSupport());
+        builder.queue();
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsGpxRouteUploadOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsGpxRouteUploadOperation.java
index 4cb63aab52..b1cfbf0423 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsGpxRouteUploadOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsGpxRouteUploadOperation.java
@@ -90,8 +90,8 @@ public class ZeppOsGpxRouteUploadOperation extends AbstractZeppOsOperation<ZeppO
     private void updateProgress(final int progressPercent) {
         try {
             final ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("send gpx route upload progress");
-            builder.setProgress(R.string.gpx_route_upload_in_progress, true, progressPercent, getContext());
-            builder.queue(getSupport());
+            builder.setProgress(R.string.gpx_route_upload_in_progress, true, progressPercent);
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to update progress notification", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsMusicUploadOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsMusicUploadOperation.java
index 6ab4adf13e..735e92586b 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsMusicUploadOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/operations/ZeppOsMusicUploadOperation.java
@@ -98,8 +98,8 @@ public class ZeppOsMusicUploadOperation extends AbstractZeppOsOperation<ZeppOsSu
     private void updateProgress(final int progressPercent) {
         try {
             final ZeppOsTransactionBuilder builder = getSupport().createZeppOsTransactionBuilder("send music upload progress");
-            builder.setProgress(R.string.music_upload_in_progress, true, progressPercent, getContext());
-            builder.queue(getSupport());
+            builder.setProgress(R.string.music_upload_in_progress, true, progressPercent);
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to update progress notification", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAlarmsService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAlarmsService.java
index f745e6fea6..3358a02ea8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAlarmsService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAlarmsService.java
@@ -133,7 +133,7 @@ public class ZeppOsAlarmsService extends AbstractZeppOsService {
             anyAlarmEnabled |= alarm.getEnabled();
             sendAlarm(alarm, builder);
         }
-        builder.queue(getSupport());
+        builder.queue();
         if (anyAlarmEnabled) {
             GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
         } else {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAssistantService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAssistantService.java
index 8ae20221d4..308e5dca1e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAssistantService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsAssistantService.java
@@ -326,7 +326,7 @@ public class ZeppOsAssistantService extends AbstractZeppOsService {
                 // TODO encode
             }
 
-            builder.queue(getSupport());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to send voice reply", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsCannedMessagesService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsCannedMessagesService.java
index f6f3dff103..e921f7b2bb 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsCannedMessagesService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsCannedMessagesService.java
@@ -135,7 +135,7 @@ public class ZeppOsCannedMessagesService extends AbstractZeppOsService {
             buf.put(cannedMessage.getBytes(StandardCharsets.UTF_8));
             write(builder, buf.array());
         }
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     public void requestCannedMessages(final ZeppOsTransactionBuilder builder) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsConfigService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsConfigService.java
index 1c8cbe9a2c..00a964ee77 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsConfigService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsConfigService.java
@@ -281,7 +281,7 @@ public class ZeppOsConfigService extends AbstractZeppOsService {
             LOG.debug("Got supported config group {}: {}", String.format("0x%02x", payload[3 + i]), configGroup);
             requestConfig(builder, configGroup);
         }
-        builder.queue(getSupport());
+        builder.queue();
     }
 
     private boolean sentFitnessGoal = false;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsHeartRateService.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsHeartRateService.java
index 985ec25c97..5aa2aa1578 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsHeartRateService.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/ZeppOsHeartRateService.java
@@ -118,7 +118,7 @@ public class ZeppOsHeartRateService extends AbstractZeppOsService {
         final ZeppOsTransactionBuilder builder = createTransactionBuilder("HeartRateTest");
         builder.notify(GattCharacteristic.UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT, true);
         write(builder, new byte[]{CMD_REALTIME_SET, REALTIME_MODE_START});
-        builder.queue(getSupport());
+        builder.queue();
 
         realtimeHandler.removeCallbacksAndMessages(null);
         scheduleContinue();
@@ -140,7 +140,7 @@ public class ZeppOsHeartRateService extends AbstractZeppOsService {
         final ZeppOsTransactionBuilder builder = createTransactionBuilder("set realtime heart rate measurement = " + enable);
         builder.notify(GattCharacteristic.UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT, enable);
         write(builder, new byte[]{CMD_REALTIME_SET, hrCmd});
-        builder.queue(getSupport());
+        builder.queue();
 
         realtimeHandler.removeCallbacksAndMessages(null);
         if (enable) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferImpl.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferImpl.java
index d194473e13..31256609de 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferImpl.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferImpl.java
@@ -119,7 +119,7 @@ public abstract class ZeppOsFileTransferImpl {
             final ZeppOsTransactionBuilder builder = mSupport.createZeppOsTransactionBuilder("enable file transfer v3 notifications");
             builder.notify(HuamiService.UUID_CHARACTERISTIC_ZEPP_OS_FILE_TRANSFER_V3_SEND, true);
             builder.notify(HuamiService.UUID_CHARACTERISTIC_ZEPP_OS_FILE_TRANSFER_V3_RECEIVE, true);
-            builder.queue(mSupport);
+            builder.queue();
         }
 
         mSupport.evaluateGBDeviceEvent(new GBDeviceEventUpdatePreferences(PREF_SUPPORTED_SERVICES, new HashSet<>(supportedServices)));
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferV3.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferV3.java
index 30b047c0b8..baec2cd0b4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferV3.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huami/zeppos/services/filetransfer/ZeppOsFileTransferV3.java
@@ -257,7 +257,7 @@ public class ZeppOsFileTransferV3 extends ZeppOsFileTransferImpl {
             final byte[] part = ArrayUtils.subarray(payload, i, i + partSize);
             builder.write(HuamiService.UUID_CHARACTERISTIC_ZEPP_OS_FILE_TRANSFER_V3_SEND, part);
         }
-        builder.queue(mSupport);
+        builder.queue();
 
         request.setProgress(request.getProgress() + chunk.length);
         request.setIndex(request.getIndex() + 1);
@@ -355,7 +355,7 @@ public class ZeppOsFileTransferV3 extends ZeppOsFileTransferImpl {
                             (byte) 0x00
                     }
             );
-            builder.queue(mSupport);
+            builder.queue();
 
             if (currentReceiveChunkIsLast) {
                 final byte[] data;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiFreebudsSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiFreebudsSupport.java
index aa4612bc6e..e7b3db6a3c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiFreebudsSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiFreebudsSupport.java
@@ -85,7 +85,7 @@ public class HuaweiFreebudsSupport extends HuaweiBRSupport implements HeadphoneH
 
         super.getSupportProvider().setup(getDevice(), getContext());
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         try {
             builder.setCallback(this);
             final GetProductInformationRequest deviceProductReq = new GetProductInformationRequest(super.getSupportProvider());
@@ -102,7 +102,7 @@ public class HuaweiFreebudsSupport extends HuaweiBRSupport implements HeadphoneH
             LOG.error("Connection failed", e);
             GB.toast("Connection failed", Toast.LENGTH_SHORT, GB.ERROR, e);
         }
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         return builder;
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiSupportProvider.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiSupportProvider.java
index c6cd07f5a4..c783265051 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiSupportProvider.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/huawei/HuaweiSupportProvider.java
@@ -444,11 +444,11 @@ public class HuaweiSupportProvider {
         final BluetoothGattCharacteristic characteristicRead = leSupport.getCharacteristic(HuaweiConstants.UUID_CHARACTERISTIC_HUAWEI_READ);
         if (characteristicRead == null) {
             LOG.warn("Read characteristic is null, will attempt to reconnect");
-            builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext()));
+            builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
             return builder;
         }
         builder.notify(characteristicRead, true);
-        builder.add(new nodomain.freeyourgadget.gadgetbridge.service.btle.actions.SetDeviceStateAction(getDevice(), GBDevice.State.AUTHENTICATING, getContext()));
+        builder.setDeviceState(GBDevice.State.AUTHENTICATING);
         final GetLinkParamsRequest linkParamsReq = new GetLinkParamsRequest(this, builder);
         initializeDevice(linkParamsReq);
         getCoordinator().setDevice(this.gbDevice);
@@ -458,7 +458,7 @@ public class HuaweiSupportProvider {
     protected nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder initializeDevice(nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder builder) {
         setup(brSupport.getDevice(), brSupport.getContext());
         builder.setCallback(brSupport);
-        builder.add(new nodomain.freeyourgadget.gadgetbridge.service.btbr.actions.SetDeviceStateAction(getDevice(), GBDevice.State.AUTHENTICATING, getContext()));
+        builder.setDeviceState(GBDevice.State.AUTHENTICATING);
         final GetLinkParamsRequest linkParamsReq = new GetLinkParamsRequest(this, builder);
         initializeDevice(linkParamsReq);
         getCoordinator().setDevice(this.gbDevice);
@@ -681,12 +681,12 @@ public class HuaweiSupportProvider {
             nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder leBuilder = createLeTransactionBuilder("Initializing");
             leBuilder.setCallback(leSupport);
             if (!GBApplication.getDeviceSpecificSharedPrefs(gbDevice.getAddress()).getBoolean("force_new_protocol", false))
-                leBuilder.notify(leSupport.getCharacteristic(HuaweiConstants.UUID_CHARACTERISTIC_HUAWEI_READ), true);
-            leBuilder.add(new nodomain.freeyourgadget.gadgetbridge.service.btle.actions.SetDeviceStateAction(gbDevice, GBDevice.State.INITIALIZING, context));
+                leBuilder.notify(HuaweiConstants.UUID_CHARACTERISTIC_HUAWEI_READ, true);
+            leBuilder.setDeviceState(GBDevice.State.INITIALIZING);
         } else {
             nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder brBuilder = createBrTransactionBuilder("Initializing");
             brBuilder.setCallback(brSupport);
-            brBuilder.add(new nodomain.freeyourgadget.gadgetbridge.service.btbr.actions.SetDeviceStateAction(gbDevice, GBDevice.State.INITIALIZING, context));
+            brBuilder.setDeviceState(GBDevice.State.INITIALIZING);
         }
         try {
             if (firstConnection) {
@@ -1417,11 +1417,11 @@ public class HuaweiSupportProvider {
         final GetSleepDataCountRequest getSleepDataCountRequest;
         if (isBLE()) {
             nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder leBuilder = createLeTransactionBuilder("FetchRecordedData");
-            leBuilder.setBusyTask(gbDevice, R.string.busy_task_fetch_activity_data, context);
+            leBuilder.setBusyTask(R.string.busy_task_fetch_activity_data);
             getSleepDataCountRequest = new GetSleepDataCountRequest(this, leBuilder, sleepStart, end);
         } else {
             nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder brBuilder = createBrTransactionBuilder("FetchRecordedData");
-            brBuilder.setBusyTask(gbDevice, R.string.busy_task_fetch_activity_data, context);
+            brBuilder.setBusyTask(R.string.busy_task_fetch_activity_data);
             getSleepDataCountRequest = new GetSleepDataCountRequest(this, brBuilder, sleepStart, end);
         }
 
@@ -1556,11 +1556,11 @@ public class HuaweiSupportProvider {
         final GetWorkoutCountRequest getWorkoutCountRequest;
         if (isBLE()) {
             nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder leBuilder = createLeTransactionBuilder("FetchWorkoutData");
-            leBuilder.setBusyTask(gbDevice, R.string.busy_task_fetch_activity_data, context);
+            leBuilder.setBusyTask(R.string.busy_task_fetch_activity_data);
             getWorkoutCountRequest = new GetWorkoutCountRequest(this, leBuilder, start, end);
         } else {
             nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder brBuilder = createBrTransactionBuilder("FetchWorkoutData");
-            brBuilder.setBusyTask(gbDevice, R.string.busy_task_fetch_activity_data, context);
+            brBuilder.setBusyTask(R.string.busy_task_fetch_activity_data);
             getWorkoutCountRequest = new GetWorkoutCountRequest(this, brBuilder, start, end);
         }
 
@@ -2611,18 +2611,16 @@ public class HuaweiSupportProvider {
                 leBuilder.setProgress(
                         textRsrc,
                         ongoing,
-                        progressPercent,
-                        context
+                        progressPercent
                 );
-                leBuilder.queue(leSupport.getQueue());
+                leBuilder.queue();
             } else {
                 nodomain.freeyourgadget.gadgetbridge.service.btbr.TransactionBuilder brBuilder = createBrTransactionBuilder("FetchRecordedData");
                 brBuilder.setProgress(
                         textRsrc,
                         ongoing,
-                        progressPercent,
-                        context);
-                brBuilder.queue(brSupport.getQueue());
+                        progressPercent);
+                brBuilder.queue();
 
             }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/AbstractID115Operation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/AbstractID115Operation.java
index 119c2a1534..5e69a6f326 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/AbstractID115Operation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/AbstractID115Operation.java
@@ -52,7 +52,7 @@ public abstract class AbstractID115Operation extends AbstractBTLEOperation<ID115
         getDevice().setBusyTask(R.string.busy_task_busy, getContext()); // mark as busy quickly to avoid interruptions from the outside
         TransactionBuilder builder = performInitialized("disabling some notifications");
         enableNotifications(builder, true);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -64,7 +64,7 @@ public abstract class AbstractID115Operation extends AbstractBTLEOperation<ID115
                 TransactionBuilder builder = performInitialized("reenabling disabled notifications");
                 enableNotifications(builder, false);
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 GB.toast(getContext(), "Error enabling ID115 notifications, you may need to connect and disconnect", Toast.LENGTH_LONG, GB.ERROR, ex);
             }
@@ -86,9 +86,9 @@ public abstract class AbstractID115Operation extends AbstractBTLEOperation<ID115
 
     void enableNotifications(TransactionBuilder builder, boolean enable) {
         if (isHealthOperation()) {
-            builder.notify(getCharacteristic(ID115Constants.UUID_CHARACTERISTIC_NOTIFY_HEALTH), enable);
+            builder.notify(ID115Constants.UUID_CHARACTERISTIC_NOTIFY_HEALTH, enable);
         } else {
-            builder.notify(getCharacteristic(ID115Constants.UUID_CHARACTERISTIC_NOTIFY_NORMAL), enable);
+            builder.notify(ID115Constants.UUID_CHARACTERISTIC_NOTIFY_NORMAL, enable);
         }
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/FetchActivityOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/FetchActivityOperation.java
index c5a7564be4..f911b4d070 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/FetchActivityOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/FetchActivityOperation.java
@@ -68,7 +68,7 @@ public class FetchActivityOperation extends AbstractID115Operation {
 
         TransactionBuilder builder = performInitialized("send activity fetch request");
         builder.write(controlCharacteristic, cmd);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/ID115Support.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/ID115Support.java
index 894709428d..b200d683b8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/ID115Support.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/ID115Support.java
@@ -55,7 +55,7 @@ public class ID115Support extends AbstractBTLESingleDeviceSupport {
         normalWriteCharacteristic = getCharacteristic(ID115Constants.UUID_CHARACTERISTIC_WRITE_NORMAL);
         healthWriteCharacteristic = getCharacteristic(ID115Constants.UUID_CHARACTERISTIC_WRITE_HEALTH);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         setTime(builder)
                 .setWrist(builder)
@@ -88,7 +88,7 @@ public class ID115Support extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("time");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.warn("Unable to send current time", e);
         }
@@ -125,13 +125,13 @@ public class ID115Support extends AbstractBTLESingleDeviceSupport {
             builder.write(normalWriteCharacteristic, new byte[] {
                     ID115Constants.CMD_ID_DEVICE_RESTART, ID115Constants.CMD_KEY_REBOOT
             });
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
         }
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     ID115Support setTime(TransactionBuilder builder) {
@@ -222,7 +222,7 @@ public class ID115Support extends AbstractBTLESingleDeviceSupport {
                     ID115Constants.CMD_KEY_NOTIFY_STOP,
                     1
             });
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.warn("Unable to stop call notification", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/SendNotificationOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/SendNotificationOperation.java
index 14b5a0c838..5dcdb56033 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/SendNotificationOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/id115/SendNotificationOperation.java
@@ -117,7 +117,7 @@ public class SendNotificationOperation extends AbstractID115Operation {
 
         TransactionBuilder builder = performInitialized("send notification chunk");
         builder.write(controlCharacteristic, cmd);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/idasen/IdasenDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/idasen/IdasenDeviceSupport.java
index 01758ec49f..69ed6cb01c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/idasen/IdasenDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/idasen/IdasenDeviceSupport.java
@@ -98,7 +98,7 @@ public class IdasenDeviceSupport extends AbstractBTLESingleDeviceSupport {
                             TransactionBuilder builder = createTransactionBuilder("height");
 
                             builder.write(characteristic, setHeightRequest);
-                            builder.queue(getQueue());
+                            builder.queue();
                             try {
                                 Thread.sleep(300);
                             } catch (InterruptedException e) {
@@ -131,13 +131,13 @@ public class IdasenDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-        builder.notify(getCharacteristic(IdasenConstants.CHARACTERISTIC_HEIGHT), true);
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
+        builder.notify(IdasenConstants.CHARACTERISTIC_HEIGHT, true);
         sendCommand("dpg", IdasenConstants.CHARACTERISTIC_DPG, IdasenConstants.CMD_DPG_WAKEUP_PREP);
         sendCommand("dpg", IdasenConstants.CHARACTERISTIC_DPG, IdasenConstants.CMD_DPG_WAKEUP);
         sendCommand("dpg", IdasenConstants.CHARACTERISTIC_COMMAND, IdasenConstants.CMD_WAKEUP);
         initBroadcast();
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         return builder;
     }
 
@@ -170,7 +170,7 @@ public class IdasenDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder(taskName);
         builder.read(characteristic);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void initBroadcast() {
@@ -204,7 +204,7 @@ public class IdasenDeviceSupport extends AbstractBTLESingleDeviceSupport {
         BluetoothGattCharacteristic characteristic = getCharacteristic(charac);
         if (characteristic != null) {
             builder.write(characteristic, contents);
-            builder.queue(getQueue());
+            builder.queue();
         }
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/itag/ITagSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/itag/ITagSupport.java
index 008bd5322b..f4c0b71e28 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/itag/ITagSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/itag/ITagSupport.java
@@ -80,7 +80,7 @@ public class ITagSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
         setInitialized(builder);
         batteryInfoProfile.requestBatteryInfo(builder);
@@ -93,7 +93,7 @@ public class ITagSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
 
@@ -118,7 +118,7 @@ public class ITagSupport extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder("beeping");
         builder.write(characteristic, new byte[]{(byte) intensity});
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/BFH16DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/BFH16DeviceSupport.java
index 98b945e268..0a8a74bbd5 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/BFH16DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/BFH16DeviceSupport.java
@@ -102,7 +102,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.info("Initializing BFH16");
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         measureCharacteristic = getCharacteristic(BFH16Constants.BFH16_SERVICE1_NOTIFY);
         ctrlCharacteristic = getCharacteristic(BFH16Constants.BFH16_SERVICE1_WRITE);
@@ -112,7 +112,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         syncSettings(builder);
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         LOG.info("Initialization BFH16 Done");
 
@@ -199,7 +199,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
                         alarms.get(i).getEnabled() ? cal.get(Calendar.MINUTE) : -1
                 ));
             }
-            builder.queue(getQueue());
+            builder.queue();
             GB.toast(getContext(), "Alarm settings applied - do note that the current device does not support day specification", Toast.LENGTH_LONG, GB.INFO);
         } catch(IOException e) {
             LOG.warn(e.getMessage());
@@ -212,7 +212,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("SetTime");
             syncDateAndTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch(IOException e) {
             LOG.warn(e.getMessage());
         }
@@ -226,7 +226,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     BFH16Constants.CMD_VIBRATE, 0, start ? 1 : 0
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             LOG.warn(e.getMessage());
         }
@@ -284,7 +284,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     BFH16Constants.CMD_ACTION_REBOOT_DEVICE, 0, 0
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             LOG.warn(e.getMessage());
         }
@@ -298,7 +298,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     BFH16Constants.CMD_MEASURE_HEART, 0, 1
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             LOG.warn(e.getMessage());
         }
@@ -313,7 +313,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     BFH16Constants.CMD_MEASURE_HEART, 0, enable ? 1 : 0
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             LOG.warn(e.getMessage());
         }
@@ -327,7 +327,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     BFH16Constants.CMD_VIBRATE, 0, 1
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             LOG.warn(e.getMessage());
         }
@@ -391,7 +391,7 @@ public class BFH16DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 }
                 builder.write(ctrlCharacteristic, currentPacket);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(e.getMessage());
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/JYouSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/JYouSupport.java
index 0a452efbf5..d9af7cfdb6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/JYouSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/jyou/JYouSupport.java
@@ -63,7 +63,7 @@ public class JYouSupport extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         logger.info("Initializing");
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         BluetoothGattCharacteristic measureCharacteristic = getCharacteristic(JYouConstants.UUID_CHARACTERISTIC_MEASURE);
         ctrlCharacteristic = getCharacteristic(JYouConstants.UUID_CHARACTERISTIC_CONTROL);
@@ -73,7 +73,7 @@ public class JYouSupport extends AbstractBTLESingleDeviceSupport {
 
         syncSettings(builder);
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         logger.info("Initialization Done");
 
@@ -268,7 +268,7 @@ public class JYouSupport extends AbstractBTLESingleDeviceSupport {
             builder.write(ctrlCharacteristic, commandWithChecksum(
                     JYouConstants.CMD_SET_HEARTRATE_AUTO, 0, enable ? 1 : 0
             ));
-            builder.queue(getQueue());
+            builder.queue();
         } catch(Exception e) {
             logger.warn(e.getMessage());
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/LefunDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/LefunDeviceSupport.java
index d1075c50ac..9e8c023814 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/LefunDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/LefunDeviceSupport.java
@@ -120,10 +120,10 @@ public class LefunDeviceSupport extends AbstractBTLESingleDeviceSupport {
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         builder.setCallback(this);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         // Enable notification
-        builder.notify(getCharacteristic(LefunConstants.UUID_CHARACTERISTIC_LEFUN_NOTIFY), true);
+        builder.notify(LefunConstants.UUID_CHARACTERISTIC_LEFUN_NOTIFY, true);
 
         // Init device (get version info, battery level, and set time)
         try {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/requests/MultiFetchRequest.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/requests/MultiFetchRequest.java
index 93eab5d110..290af072ef 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/requests/MultiFetchRequest.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lefun/requests/MultiFetchRequest.java
@@ -26,7 +26,6 @@ import java.io.IOException;
 
 import nodomain.freeyourgadget.gadgetbridge.devices.lefun.LefunConstants;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.SetDeviceBusyAction;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.lefun.LefunDeviceSupport;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.miband.operations.OperationStatus;
 import nodomain.freeyourgadget.gadgetbridge.util.GB;
@@ -54,7 +53,7 @@ public abstract class MultiFetchRequest extends Request {
         if (getDevice().isBusy()) {
             throw new IllegalStateException("Device is busy");
         }
-        builder.setBusyTask(getDevice(), getOperationName(), getContext());
+        builder.setBusyTask(getOperationName());
         builder.wait(1000); // Wait a bit (after previous operation), or device sometimes won't respond
     }
 
@@ -66,7 +65,7 @@ public abstract class MultiFetchRequest extends Request {
             super.operationFinished();
             TransactionBuilder builder = performInitialized("Finishing operation");
             builder.setCallback(null);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Failed to reset callback", Toast.LENGTH_SHORT,
                     GB.ERROR, e);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/operations/InitOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/operations/InitOperation.java
index 3830371551..b8a8a04ea4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/operations/InitOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/operations/InitOperation.java
@@ -54,9 +54,9 @@ public class InitOperation extends AbstractBTLEOperation<WatchXPlusDeviceSupport
     @Override
     protected void doPerform() throws IOException {
         builder.notify(cmdCharacteristic, true).notify(dbCharacteristic, true);
-            builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+            builder.setDeviceState(GBDevice.State.AUTHENTICATING);
             getSupport().authorizationRequest(builder, needsAuth);
-            builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
             getSupport().initialize(builder);
             getSupport().performImmediately(builder);
     }
@@ -72,7 +72,7 @@ public class InitOperation extends AbstractBTLEOperation<WatchXPlusDeviceSupport
                 if (ArrayUtils.equals(value, Watch9Constants.RESP_AUTHORIZATION_TASK, 5) && value[8] == 0x01) {
                     TransactionBuilder builder = getSupport().createTransactionBuilder("authInit");
                     builder.setCallback(this);
-                    builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+                    builder.setDeviceState(GBDevice.State.INITIALIZING);
                     getSupport().initialize(builder).performImmediately(builder);
                 } else {
                     return super.onCharacteristicChanged(gatt, characteristic, value);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/watchxplus/WatchXPlusDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/watchxplus/WatchXPlusDeviceSupport.java
index 30011d55e3..d897320c9c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/watchxplus/WatchXPlusDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/lenovo/watchxplus/WatchXPlusDeviceSupport.java
@@ -198,11 +198,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             bArr[3] = (byte) ((int) mPosition);
             bArr[4] = (byte) (mMessageId >> 8);
             bArr[5] = (byte) mMessageId;
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_NOTIFICATION_CANCEL,
                             WatchXPlusConstants.WRITE_VALUE,
                             bArr));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to cancel notification ", e);
         }
@@ -353,12 +353,12 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 }
                 messagePart[0] = (byte) notificationChannel;
                 messagePart[1] = (byte) messageIndex;
-                builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+                builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                           WatchXPlusConstants.KEEP_ALIVE,
                           messagePart));
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to send notification ", e);
         }
@@ -370,7 +370,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      * TODO add settings to choose notification channels
      */
     private WatchXPlusDeviceSupport enableNotificationChannels(TransactionBuilder builder) {
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_NOTIFICATION_SETTINGS,
                         WatchXPlusConstants.WRITE_VALUE,
                         new byte[]{(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF}));
@@ -379,7 +379,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     public void authorizationRequest(TransactionBuilder builder, boolean firstConnect) {
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_AUTHORIZATION_TASK,
                         WatchXPlusConstants.TASK,
                         new byte[]{(byte) (firstConnect ? 0x00 : 0x01)})); //possibly not the correct meaning
@@ -389,7 +389,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void enableCalibration(boolean enable) {
         try {
             TransactionBuilder builder = performInitialized("enableCalibration");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_CALIBRATION_INIT_TASK,
                             WatchXPlusConstants.TASK,
                             new byte[]{(byte) (enable ? 0x01 : 0x00)}));
@@ -402,7 +402,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void holdCalibration() {
         try {
             TransactionBuilder builder = performInitialized("holdCalibration");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_CALIBRATION_KEEP_ALIVE,
                             WatchXPlusConstants.KEEP_ALIVE));
             performImmediately(builder);
@@ -416,7 +416,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             isCalibrationActive = true;
             TransactionBuilder builder = performInitialized("calibrate");
             int handsPosition = ((hour % 12) * 60 + minute) * 60 + second;
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_CALIBRATION_TASK,
                             WatchXPlusConstants.TASK,
                             Conversion.toByteArr16(handsPosition)));
@@ -429,7 +429,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     private WatchXPlusDeviceSupport checkInitTime(TransactionBuilder builder) {
         LOG.info(" Check init time ");
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_TIME_SETTINGS,
                         WatchXPlusConstants.READ_VALUE));
         return this;
@@ -438,10 +438,10 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void getTime() {
         try {
             TransactionBuilder builder = performInitialized("getTime");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_TIME_SETTINGS,
                             WatchXPlusConstants.READ_VALUE));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to get device time ", e);
         }
@@ -499,11 +499,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     (byte) timezoneOffsetIndustrialMinutes,
                     (byte) (calendar.get(Calendar.DAY_OF_WEEK) - 1)
             };
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_TIME_SETTINGS,
                             WatchXPlusConstants.WRITE_VALUE,
                             time));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to set time ", e);
         }
@@ -513,7 +513,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      * @param builder - transaction builder
      */
     private WatchXPlusDeviceSupport getFirmwareVersion(TransactionBuilder builder) {
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_FIRMWARE_INFO,
                         WatchXPlusConstants.READ_VALUE));
 
@@ -524,7 +524,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      * @param builder - transaction builder
      */
     private WatchXPlusDeviceSupport getBatteryState(TransactionBuilder builder) {
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_BATTERY_INFO,
                         WatchXPlusConstants.READ_VALUE));
 
@@ -543,7 +543,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 //.setUnitsSettings()                             // set metric/imperial units
                 .checkInitTime(builder)
                 .syncPreferences(builder);                      // read preferences from app and set them to watch
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         builder.setCallback(this);
         return this;
     }
@@ -567,7 +567,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             for (Alarm alarm : alarms) {
                 setAlarm(alarm, alarm.getPosition() + 1, builder);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to set alarms ", e);
         }
@@ -577,7 +577,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void deleteAlarm(TransactionBuilder builder, int index) {
         if (0 < index && index < 4) {
             byte[] alarmValue = new byte[]{(byte) index, 0x00, 0x00, 0x00, 0x00, 0x00};
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_ALARM_SETTINGS,
                             WatchXPlusConstants.WRITE_VALUE,
                             alarmValue));
@@ -596,7 +596,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     (byte) (alarm.getEnabled() ? 0x01 : 0x00),
                     0x00 // TODO: Unknown
             };
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_ALARM_SETTINGS,
                             WatchXPlusConstants.WRITE_VALUE,
                             alarmValue));
@@ -765,7 +765,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     private WatchXPlusDeviceSupport setFitnessGoal(TransactionBuilder builder) {
         int fitnessGoal = new ActivityUser().getStepsGoal();
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_FITNESS_GOAL_SETTINGS,
                         WatchXPlusConstants.WRITE_VALUE,
                         Conversion.toByteArr16(fitnessGoal)));
@@ -789,7 +789,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         bArr[2] = (byte) age;           // byte[10]
         bArr[3] = (byte) gender;        // byte[11]
 
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(command,
                         WatchXPlusConstants.WRITE_VALUE,
                         bArr));
@@ -813,10 +813,10 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         // get battery state
         try {
             builder = performInitialized("getBatteryInfo");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_BATTERY_INFO,
                         WatchXPlusConstants.READ_VALUE));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to retrieve battery data ", e);
         }
@@ -824,14 +824,14 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             builder = performInitialized("fetchData");
 
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_DAY_STEPS_INFO,
                             WatchXPlusConstants.READ_VALUE));
 
 //            Fetch heart rate data samples count
             requestDataCount(DataType.HEART_RATE);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to retrieve recorded data ", e);
         }
@@ -899,7 +899,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     setDNDHours(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Failed to send config", e);
         }
@@ -944,7 +944,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         bArr[8] = (byte) (period >> 8);      // byte[16]
         bArr[9] = (byte) period;             // byte[17]
 
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(command, WatchXPlusConstants.WRITE_VALUE, bArr));
         // set long sit reminder state (enabled, disabled)
         setLongSitSwitch(builder, enable);
@@ -978,7 +978,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      */
     private void setLongSitSwitch(TransactionBuilder tbuilder, boolean enable) {
         LOG.info(" Setting Long sit reminder switch to: " + enable);
-        tbuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        tbuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_INACTIVITY_REMINDER_SWITCH,
                         WatchXPlusConstants.WRITE_VALUE,
                         new byte[]{(byte) (enable ? 0x01 : 0x00)}));
@@ -1004,7 +1004,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
          bArr[1] = (byte) minuteStart;      // byte[09]
          bArr[2] = (byte) hourEnd;          // byte[10]
          bArr[3] = (byte) minuteEnd;        // byte[11]
-         builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+         builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
               buildCommand(command, WatchXPlusConstants.WRITE_VALUE, bArr));
          // set DND state (enabled, disabled)
          setDNDHoursSwitch(builder, enable);
@@ -1016,7 +1016,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      */
     private void setDNDHoursSwitch(TransactionBuilder tbuilder, boolean enable) {
             LOG.info(" Setting DND switch to: " + enable);
-            tbuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            tbuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_SET_DND_HOURS_SWITCH,
                         WatchXPlusConstants.WRITE_VALUE,
                         new byte[]{(byte) (enable ? 0x01 : 0x00)}));
@@ -1060,11 +1060,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         LOG.info(" setting power mode to: " + setWatchPowerMode);
         try {
             TransactionBuilder builder = performInitialized("setWatchPowerMode");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_POWER_MODE,
                             WatchXPlusConstants.TASK,
                             bArr));
-            builder.queue(getQueue());
+            builder.queue();
         }   catch (IOException e) {
             LOG.warn(" Unable to set power mode ", e);
         }
@@ -1078,10 +1078,10 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         LOG.info(" Get units from watch... ");
         try {
             TransactionBuilder builder = performInitialized("getUnits");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_SET_UNITS,
                             WatchXPlusConstants.READ_VALUE));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to get units ", e);
         }
@@ -1108,11 +1108,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         bArr[2] = (byte) 0x00;  // temperature unit (do nothing)
         try {
             TransactionBuilder builder = performInitialized("setUnits");
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_SET_UNITS,
                             WatchXPlusConstants.WRITE_VALUE,
                             bArr));
-            builder.queue(getQueue());
+            builder.queue();
         }   catch (IOException e) {
             LOG.warn(" Unable to set units ", e);
         }
@@ -1122,7 +1122,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
      * @param builder - transaction builder
      */
     private WatchXPlusDeviceSupport getBloodPressureCalibrationStatus(TransactionBuilder builder) {
-        builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_IS_BP_CALIBRATED,
                         WatchXPlusConstants.READ_VALUE));
 
@@ -1156,11 +1156,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             bArr[3] = (byte) (mLowP >> 8);        // byte[11]
             bArr[4] = (byte) mLowP;               // byte[12]
 
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             WatchXPlusConstants.TASK,
                             bArr));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to send BP Calibration ", e);
         }
@@ -1203,10 +1203,10 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
             byte[] command = WatchXPlusConstants.CMD_BLOOD_PRESSURE_MEASURE;
 
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             WatchXPlusConstants.TASK, new byte[]{0x01}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to request BP Measure ", e);
         }
@@ -1370,11 +1370,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             weatherInfo[2] = (byte) todayMinTemp;
             weatherInfo[3] = (byte) todayMaxTemp;
             weatherInfo[4] = (byte) currentTemp;
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             WatchXPlusConstants.KEEP_ALIVE,
                             weatherInfo));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to set weather ", e);
         }
@@ -1487,12 +1487,12 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             builder = performInitialized("requestDataCount");
 
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_RETRIEVE_DATA_COUNT,
                             WatchXPlusConstants.READ_VALUE,
                             dataType.getValue()));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to send request to retrieve recorded data ", e);
         }
@@ -1520,12 +1520,12 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             byte[] index = Conversion.toByteArr16(i);
             byte[] req = BLETypeConversions.join(dataType.getValue(), index);
             currentDataType = dataType;
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(WatchXPlusConstants.CMD_RETRIEVE_DATA_DETAILS,
                             WatchXPlusConstants.READ_VALUE,
                             req));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn( "Unable to request data details ", e);
         }
@@ -1569,11 +1569,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             byte[] req = BLETypeConversions.join(dataType.getValue(), ts);
             req = BLETypeConversions.join(req, Conversion.toByteArr16(0));
             requestedDataTimestamp = timestamp;
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             WatchXPlusConstants.READ_VALUE,
                             req));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to request data content ", e);
         }
@@ -1586,11 +1586,11 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("removeDataContentForTimestamp");
             byte[] ts = Conversion.toByteArr32(timestamp);
             byte[] req = BLETypeConversions.join(dataType.getValue(), ts);
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             WatchXPlusConstants.TASK,
                             req));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to remove data content ", e);
         }
@@ -1718,9 +1718,9 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("handleAck");
 
-            builder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand());
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn(" Unable to response to ACK ", e);
         }
@@ -1993,7 +1993,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         liftScreen[1] = 0x00;
         liftScreen[2] = 0x00;
         liftScreen[3] = b;              //byte[11]
-        transactionBuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        transactionBuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_SHAKE_SWITCH,
                              WatchXPlusConstants.WRITE_VALUE,
                              liftScreen));
@@ -2002,7 +2002,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
     // command to set disconnect reminder
     private void setDisconnectReminder(TransactionBuilder transactionBuilder) {
         boolean enable = GBApplication.getDeviceSpecificSharedPrefs(gbDevice.getAddress()).getBoolean(DeviceSettingsPreferenceConst.PREF_DISCONNECTNOTIF_NOSHED, false);
-        transactionBuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        transactionBuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_DISCONNECT_REMIND,
                         WatchXPlusConstants.WRITE_VALUE,
                         new byte[]{(byte) (enable ? 0x01 : 0x00)}));
@@ -2010,7 +2010,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
 // Request status of Lift Wrist to Light Screen, and Shake to Ignore/Reject Call
     private void getShakeStatus(TransactionBuilder transactionBuilder) {
-        transactionBuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        transactionBuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_SHAKE_SWITCH,
                         WatchXPlusConstants.READ_VALUE));
     }
@@ -2028,7 +2028,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         bArr[1] = (byte) mAltitude;             // bytr[9]
         bArr[2] = (byte) (mAirPressure >> 8);   // bytr[10]
         bArr[3] = (byte) mAirPressure;          // bytr[11]
-        transactionBuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        transactionBuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_ALTITUDE,
                         WatchXPlusConstants.WRITE_VALUE,
                         bArr));
@@ -2058,7 +2058,7 @@ public class WatchXPlusDeviceSupport extends AbstractBTLESingleDeviceSupport {
         byte[] bArr = new byte[2];
         bArr[0] = setLanguage;           //byte[08] language
         bArr[1] = setTimeMode;           //byte[09] time
-        transactionBuilder.write(getCharacteristic(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE),
+        transactionBuilder.write(WatchXPlusConstants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(WatchXPlusConstants.CMD_TIME_LANGUAGE,
                         WatchXPlusConstants.WRITE_VALUE,
                         bArr));
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/makibeshr3/MakibesHR3DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/makibeshr3/MakibesHR3DeviceSupport.java
index 4e990b201c..cfd6c88fb7 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/makibeshr3/MakibesHR3DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/makibeshr3/MakibesHR3DeviceSupport.java
@@ -488,7 +488,7 @@ public class MakibesHR3DeviceSupport extends AbstractBTLESingleDeviceSupport imp
 
         GB.updateTransferNotification(null, getContext().getString(R.string.busy_task_fetch_activity_data), true, 0, getContext());
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         this.mControlCharacteristic = getCharacteristic(MakibesHR3Constants.UUID_CHARACTERISTIC_CONTROL);
         this.mReportCharacteristic = getCharacteristic(MakibesHR3Constants.UUID_CHARACTERISTIC_REPORT);
@@ -505,7 +505,7 @@ public class MakibesHR3DeviceSupport extends AbstractBTLESingleDeviceSupport imp
 
         this.requestFitness(builder);
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/marstek/MarstekB2500DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/marstek/MarstekB2500DeviceSupport.java
index 499cf06d4d..ddea50d330 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/marstek/MarstekB2500DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/marstek/MarstekB2500DeviceSupport.java
@@ -113,13 +113,13 @@ public class MarstekB2500DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
         builder.requestMtu(512);
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_MAIN), true);
+        builder.notify(UUID_CHARACTERISTIC_MAIN, true);
         builder.wait(3500);
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_MAIN), COMMAND_GET_INFOS1);
+        builder.write(UUID_CHARACTERISTIC_MAIN, COMMAND_GET_INFOS1);
         return builder;
     }
 
@@ -134,7 +134,7 @@ public class MarstekB2500DeviceSupport extends AbstractBTLESingleDeviceSupport {
         if (characteristic != null && contents != null) {
             builder.write(characteristic, contents);
             builder.wait(750);
-            builder.queue(getQueue());
+            builder.queue();
         }
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/MiBandSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/MiBandSupport.java
index 1ff18ead22..e56f44fa8a 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/MiBandSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/MiBandSupport.java
@@ -39,7 +39,6 @@ import java.util.Date;
 import java.util.GregorianCalendar;
 import java.util.List;
 import java.util.UUID;
-import java.util.function.Predicate;
 
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
 import nodomain.freeyourgadget.gadgetbridge.R;
@@ -78,7 +77,6 @@ import nodomain.freeyourgadget.gadgetbridge.service.btle.BtLEAction;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.GattCharacteristic;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.GattService;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.AbortTransactionAction;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.ConditionalWriteAction;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.SetDeviceStateAction;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.WriteAction;
@@ -142,7 +140,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.add(new SetDeviceStateAction(getDevice(), State.INITIALIZING, getContext()));
+        builder.setDeviceState(State.INITIALIZING);
         enableNotifications(builder, true)
                 .setLowLatency(builder)
                 .readDate(builder) // without reading the data, we get sporadic connection problems, especially directly after turning on BT
@@ -162,17 +160,17 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private MiBandSupport readDate(TransactionBuilder builder) {
-        builder.read(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_DATE_TIME));
+        builder.read(MiBandService.UUID_CHARACTERISTIC_DATE_TIME);
         return this;
     }
 
     public MiBandSupport setLowLatency(TransactionBuilder builder) {
-        builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS), getLowLatency());
+        builder.write(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS, getLowLatency());
         return this;
     }
 
     public MiBandSupport setHighLatency(TransactionBuilder builder) {
-        builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS), getHighLatency());
+        builder.write(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS, getHighLatency());
         return this;
     }
 
@@ -189,20 +187,20 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
      * @param builder
      */
     private void setInitialized(TransactionBuilder builder) {
-        builder.add(new SetDeviceStateAction(getDevice(), State.INITIALIZED, getContext()));
+        builder.setDeviceState(State.INITIALIZED);
     }
 
     // TODO: tear down the notifications on quit
     private MiBandSupport enableNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_NOTIFICATION), enable);
+        builder.notify(MiBandService.UUID_CHARACTERISTIC_NOTIFICATION, enable);
         return this;
     }
 
     private MiBandSupport enableFurtherNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS), enable)
-                .notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_ACTIVITY_DATA), enable)
-                .notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_BATTERY), enable)
-                .notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_SENSOR_DATA), enable);
+        builder.notify(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS, enable)
+                .notify(MiBandService.UUID_CHARACTERISTIC_ACTIVITY_DATA, enable)
+                .notify(MiBandService.UUID_CHARACTERISTIC_BATTERY, enable)
+                .notify(MiBandService.UUID_CHARACTERISTIC_SENSOR_DATA, enable);
         // cannot use supportsHeartrate() here because we don't have that information yet
         BluetoothGattCharacteristic heartrateCharacteristic = getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT);
         if (heartrateCharacteristic != null) {
@@ -438,7 +436,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("enable heart rate sleep support: " + enable);
             setHeartrateSleepSupport(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error toggling heart rate sleep support: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -475,7 +473,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized(task);
             sendDefaultNotification(builder, simpleNotification, repeat, extraAction);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send notification to MI device", ex);
         }
@@ -499,7 +497,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
             sendCustomNotification(profile, simpleNotification, flashTimes, flashColour, originalColour, flashDuration, extraAction, builder);
 //            setHighLatency(builder);
 //            sendCustomNotification(vibrateDuration, vibrateTimes, vibratePause, flashTimes, flashColour, originalColour, flashDuration, builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send notification to MI device", ex);
         }
@@ -548,7 +546,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
                 anyAlarmEnabled |= alarm.getEnabled();
                 queueAlarm(alarm, builder, characteristic);
             }
-            builder.queue(getQueue());
+            builder.queue();
             if (anyAlarmEnabled) {
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
             } else {
@@ -588,7 +586,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("Set date and time");
             setCurrentTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to set time on MI device", ex);
         }
@@ -656,11 +654,11 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("reset");
             if ((flags & GBDeviceProtocol.RESET_FLAGS_FACTORY_RESET) != 0) {
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), factoryReset);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, factoryReset);
             } else {
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), reboot);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, reboot);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to reset", ex);
         }
@@ -671,10 +669,10 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         if (supportsHeartRate()) {
             try {
                 TransactionBuilder builder = performInitialized("HeartRateTest");
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), stopHeartMeasurementContinuous);
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), stopHeartMeasurementManual);
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), startHeartMeasurementManual);
-                builder.queue(getQueue());
+                builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, stopHeartMeasurementContinuous);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, stopHeartMeasurementManual);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, startHeartMeasurementManual);
+                builder.queue();
             } catch (IOException ex) {
                 LOG.error("Unable to read HearRate in  MI1S", ex);
             }
@@ -689,12 +687,12 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
             try {
                 TransactionBuilder builder = performInitialized("EnableRealtimeHeartRateMeasurement");
                 if (enable) {
-                    builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), stopHeartMeasurementManual);
-                    builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), startHeartMeasurementContinuous);
+                    builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, stopHeartMeasurementManual);
+                    builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, startHeartMeasurementContinuous);
                 } else {
-                    builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT), stopHeartMeasurementContinuous);
+                    builder.write(MiBandService.UUID_CHARACTERISTIC_HEART_RATE_CONTROL_POINT, stopHeartMeasurementContinuous);
                 }
-                builder.queue(getQueue());
+                builder.queue();
                 enableRealtimeSamplesTimer(enable);
             } catch (IOException ex) {
                 LOG.error("Unable to enable realtime heart rate measurement in  MI1S", ex);
@@ -732,11 +730,11 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
             BluetoothGattCharacteristic controlPoint = getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT);
             if (enable) {
                 TransactionBuilder builder = performInitialized("Read realtime steps");
-                builder.read(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS)).queue(getQueue());
+                builder.read(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS).queue();
             }
             performInitialized(enable ? "Enabling realtime steps notifications" : "Disabling realtime steps notifications")
-                    .write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS), enable ? getLowLatency() : getHighLatency())
-                    .write(controlPoint, enable ? startRealTimeStepsNotifications : stopRealTimeStepsNotifications).queue(getQueue());
+                    .write(MiBandService.UUID_CHARACTERISTIC_LE_PARAMS, enable ? getLowLatency() : getHighLatency())
+                    .write(controlPoint, enable ? startRealTimeStepsNotifications : stopRealTimeStepsNotifications).queue();
             enableRealtimeSamplesTimer(enable);
         } catch (IOException e) {
             LOG.error("Unable to change realtime steps notification to: " + enable, e);
@@ -1020,7 +1018,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
     private void doInitialize() {
         try {
             TransactionBuilder builder = performInitialized("just initializing after authentication");
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to initialize device after authentication", ex);
         }
@@ -1166,7 +1164,7 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
                     queueAlarm(alarm, builder, characteristic);
                     iteration++;
                 }
-                builder.queue(getQueue());
+                builder.queue();
             }
         } catch (IOException ex) {
             LOG.error("Unable to send Events to MI device", ex);
@@ -1178,13 +1176,13 @@ public class MiBandSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("Toggle sensor reading");
             if (isReadingSensorData) {
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), stopSensorRead);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, stopSensorRead);
                 isReadingSensorData = false;
             } else {
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), startSensorRead);
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, startSensorRead);
                 isReadingSensorData = true;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to toggle sensor reading MI", ex);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBand1Operation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBand1Operation.java
index 4bd72c9b81..a83ef4624f 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBand1Operation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBand1Operation.java
@@ -27,7 +27,7 @@ public abstract class AbstractMiBand1Operation extends AbstractMiBandOperation<M
 
     @Override
     protected void enableOtherNotifications(TransactionBuilder builder, boolean enable) {
-        builder.notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS), enable)
-                .notify(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_SENSOR_DATA), enable);
+        builder.notify(MiBandService.UUID_CHARACTERISTIC_REALTIME_STEPS, enable)
+                .notify(MiBandService.UUID_CHARACTERISTIC_SENSOR_DATA, enable);
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBandOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBandOperation.java
index 530ca0a44c..f03cb91096 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBandOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/AbstractMiBandOperation.java
@@ -38,7 +38,7 @@ public abstract class AbstractMiBandOperation<T extends AbstractBTLESingleDevice
         TransactionBuilder builder = performInitialized("disabling some notifications");
         enableOtherNotifications(builder, false);
         enableNeededNotifications(builder, true);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -50,7 +50,7 @@ public abstract class AbstractMiBandOperation<T extends AbstractBTLESingleDevice
                 TransactionBuilder builder = performInitialized("reenabling disabled notifications");
                 handleFinished(builder);
                 builder.setCallback(null); // unset ourselves from being the queue's gatt callback
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 GB.toast(getContext(), "Error enabling Mi Band notifications, you may need to connect and disconnect", Toast.LENGTH_LONG, GB.ERROR, ex);
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/FetchActivityOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/FetchActivityOperation.java
index 422f441b88..be9efacc38 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/FetchActivityOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/FetchActivityOperation.java
@@ -176,9 +176,9 @@ public class FetchActivityOperation extends AbstractMiBand1Operation {
 
         TransactionBuilder builder = performInitialized("fetch activity data");
         getSupport().setLowLatency(builder);
-        builder.setBusyTask(getDevice(), R.string.busy_task_fetch_activity_data, getContext());
-        builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), fetch);
-        builder.queue(getQueue());
+        builder.setBusyTask(R.string.busy_task_fetch_activity_data);
+        builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, fetch);
+        builder.queue();
     }
 
     @Override
@@ -328,8 +328,8 @@ public class FetchActivityOperation extends AbstractMiBand1Operation {
             GB.toast(getContext(), "error buffering activity data: remaining bytes: " + activityStruct.activityDataRemainingBytes + ", received: " + value.length, Toast.LENGTH_LONG, GB.ERROR);
             try {
                 TransactionBuilder builder = performInitialized("send stop sync data");
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), new byte[]{MiBandService.COMMAND_STOP_SYNC_DATA});
-                builder.queue(getQueue());
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, new byte[]{MiBandService.COMMAND_STOP_SYNC_DATA});
+                builder.queue();
                 GB.updateTransferNotification(null,"Data transfer failed", false, 0, getContext());
                 handleActivityFetchFinish();
 
@@ -434,8 +434,8 @@ public class FetchActivityOperation extends AbstractMiBand1Operation {
         };
         try {
             TransactionBuilder builder = performInitialized("send acknowledge");
-            builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), ack);
-            builder.queue(getQueue());
+            builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, ack);
+            builder.queue();
 
             // flush to the DB after queueing the ACK
             flushActivityDataHolder();
@@ -446,9 +446,9 @@ public class FetchActivityOperation extends AbstractMiBand1Operation {
                 //if we are not clearing miband's data, we have to stop the sync
                 if (prefs.getBoolean("keep_activity_data_on_device", false)) {
                     builder = performInitialized("send acknowledge");
-                    builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), new byte[]{MiBandService.COMMAND_STOP_SYNC_DATA});
+                    builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, new byte[]{MiBandService.COMMAND_STOP_SYNC_DATA});
                     getSupport().setHighLatency(builder);
-                    builder.queue(getQueue());
+                    builder.queue();
                 }
                 handleActivityFetchFinish();
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/UpdateFirmwareOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/UpdateFirmwareOperation.java
index b89ae373cd..23b6d22a96 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/UpdateFirmwareOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miband/operations/UpdateFirmwareOperation.java
@@ -320,7 +320,7 @@ public class UpdateFirmwareOperation extends AbstractMiBand1Operation {
                 int progressPercent = (int) ((((float) firmwareProgress) / len) * 100);
                 if ((i > 0) && (i % 50 == 0)) {
                     builder.write(characteristicControlPoint, new byte[]{MiBandService.COMMAND_SYNC});
-                    builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, getContext());
+                    builder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
                 }
             }
 
@@ -331,7 +331,7 @@ public class UpdateFirmwareOperation extends AbstractMiBand1Operation {
             }
 
             builder.write(characteristicControlPoint, new byte[]{MiBandService.COMMAND_SYNC});
-            builder.queue(getQueue());
+            builder.queue();
 
         } catch (IOException ex) {
             LOG.error("Unable to send fw to MI", ex);
@@ -358,10 +358,10 @@ public class UpdateFirmwareOperation extends AbstractMiBand1Operation {
             try {
                 TransactionBuilder builder = performInitialized("send firmware info");
 //                getSupport().setLowLatency(builder);
-                builder.setBusyTask(getDevice(), R.string.updating_firmware, getContext());
+                builder.setBusyTask(R.string.updating_firmware);
                 builder.add(new FirmwareInfoSentAction()); // Note: *before* actually sending the info, otherwise it's too late!
-                builder.write(getCharacteristic(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT), getFirmwareInfo());
-                builder.queue(getQueue());
+                builder.write(MiBandService.UUID_CHARACTERISTIC_CONTROL_POINT, getFirmwareInfo());
+                builder.queue();
                 return true;
             } catch (IOException e) {
                 LOG.error("Error sending firmware info: " + e.getLocalizedMessage(), e);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/mijia_lywsd/MijiaLywsdSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/mijia_lywsd/MijiaLywsdSupport.java
index 6fe7fad5fd..556bd09019 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/mijia_lywsd/MijiaLywsdSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/mijia_lywsd/MijiaLywsdSupport.java
@@ -99,7 +99,7 @@ public class MijiaLywsdSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
 
         final boolean supportsSetTime = getCoordinator().supportsSetTime();
@@ -389,7 +389,7 @@ public class MijiaLywsdSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     @Override
@@ -410,7 +410,7 @@ public class MijiaLywsdSupport extends AbstractBTLESingleDeviceSupport {
         try {
             builder = performInitialized("Set time");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error setting time on LYWSD02", e);
             GB.toast("Error setting time on LYWSD02", Toast.LENGTH_LONG, GB.ERROR, e);
@@ -503,7 +503,7 @@ public class MijiaLywsdSupport extends AbstractBTLESingleDeviceSupport {
                     break;
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error setting configuration on LYWSD02", e);
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiCompositionScaleDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiCompositionScaleDeviceSupport.java
index f0b64a6b23..72ef465623 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiCompositionScaleDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiCompositionScaleDeviceSupport.java
@@ -77,15 +77,15 @@ public class MiCompositionScaleDeviceSupport extends AbstractBTLESingleDeviceSup
 
     @Override
     protected TransactionBuilder initializeDevice(final TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         LOG.debug("Requesting Device Info!");
         deviceInfoProfile.requestDeviceInfo(builder);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         // Weight and body composition
         builder.setCallback(this);
-        builder.notify(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_BODY_COMPOSITION_MEASUREMENT), true);
+        builder.notify(GattCharacteristic.UUID_CHARACTERISTIC_BODY_COMPOSITION_MEASUREMENT, true);
 
         return builder;
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiSmartScaleDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiSmartScaleDeviceSupport.java
index fba092a783..bd9576c9d1 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiSmartScaleDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/miscale/MiSmartScaleDeviceSupport.java
@@ -111,18 +111,18 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         deviceInfoProfile.requestDeviceInfo(builder);
 
         if (GBApplication.getPrefs().getBoolean("datetime_synconconnect", true))
             setTime(builder);
 
-        builder.notify(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_WEIGHT_MEASUREMENT), true);
+        builder.notify(GattCharacteristic.UUID_CHARACTERISTIC_WEIGHT_MEASUREMENT, true);
 
         fetchWeightHistory(builder);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         return builder;
     }
@@ -144,8 +144,8 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
             // Acknowledge weight history reception
             sendHistoryCommand(builder, CMD_HISTORY_COMPLETE, false);
             sendHistoryCommand(builder, CMD_HISTORY_END, true);
-            builder.notify(getCharacteristic(UUID_CHARACTERISTIC_WEIGHT_HISTORY), false);
-            builder.queue(getQueue());
+            builder.notify(UUID_CHARACTERISTIC_WEIGHT_HISTORY, false);
+            builder.queue();
             getDevice().unsetBusyTask();
             GB.updateTransferNotification(null, "", false, 100, getContext());
             getDevice().sendDeviceUpdateIntent(getContext());
@@ -175,7 +175,7 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("reset");
 
             setConfigValue(builder, CFG_RESET_HISTORY, (byte)0x00);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error", e);
         }
@@ -198,7 +198,7 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 setConfigValue(builder, CFG_SMALL_OBJECTS, enabled ? (byte)0x01: (byte)0x00);
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error", e);
         }
@@ -218,7 +218,7 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         final TransactionBuilder builder = createTransactionBuilder("fetch weight history");
         fetchWeightHistory(builder);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     public void fetchWeightHistory(final TransactionBuilder builder) {
@@ -226,25 +226,25 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         GB.updateTransferNotification(fetchMessage,"", true, 0, getContext());
 
-        builder.setBusyTask(getDevice(), R.string.busy_task_fetch_weight_data, getContext());
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_WEIGHT_HISTORY), true);
+        builder.setBusyTask(R.string.busy_task_fetch_weight_data);
+        builder.notify(UUID_CHARACTERISTIC_WEIGHT_HISTORY, true);
         // Query weight measurements saved by the scale
         sendHistoryCommand(builder, CMD_HISTORY_START, true);
         sendHistoryCommand(builder, CMD_HISTORY_QUERY, false);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private void setTime(TransactionBuilder builder) {
         GregorianCalendar now = BLETypeConversions.createCalendar();
         byte[] time = BLETypeConversions.calendarToCurrentTime(now, 0);
 
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME), time);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME, time);
     }
 
     private void setConfigValue(TransactionBuilder builder, byte config, byte value) {
         byte[] data = new byte[] { (byte)0x06, config, (byte)0x00, value };
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_CONFIG), data);
+        builder.write(UUID_CHARACTERISTIC_CONFIG, data);
     }
 
     private void sendHistoryCommand(TransactionBuilder builder, byte cmd, boolean includeUserId) {
@@ -256,7 +256,7 @@ public class MiSmartScaleDeviceSupport extends AbstractBTLESingleDeviceSupport {
         if (includeUserId)
             buf.putInt((int)userId);
 
-        builder.write(getCharacteristic(UUID_CHARACTERISTIC_WEIGHT_HISTORY), buf.array());
+        builder.write(UUID_CHARACTERISTIC_WEIGHT_HISTORY, buf.array());
     }
 
     private void saveMeasurements(List<WeightMeasurement> measurements) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchDataOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchDataOperation.java
index 339143b426..d3dbeacde6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchDataOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchDataOperation.java
@@ -63,10 +63,10 @@ public class FetchDataOperation extends AbstractBTLEOperation<MoyoungDeviceSuppo
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_SYNC_SLEEP, new byte[0]));
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_SYNC_PAST_SLEEP_AND_STEP, new byte[]{MoyoungConstants.ARG_SYNC_YESTERDAY_STEPS}));
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_SYNC_PAST_SLEEP_AND_STEP, new byte[]{MoyoungConstants.ARG_SYNC_DAY_BEFORE_YESTERDAY_STEPS}));
-        builder.read(getCharacteristic(MoyoungConstants.UUID_CHARACTERISTIC_STEPS));
+        builder.read(MoyoungConstants.UUID_CHARACTERISTIC_STEPS);
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_MOVEMENT_HEART_RATE, new byte[]{}));
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_PAST_HEART_RATE_1, new byte[]{0x00}));
-        builder.queue(getQueue());
+        builder.queue();
 
         updateProgressAndCheckFinish();
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchWorkoutsV2Operation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchWorkoutsV2Operation.java
index 922421a1ed..f62a9cc7df 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchWorkoutsV2Operation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/FetchWorkoutsV2Operation.java
@@ -67,7 +67,7 @@ public class FetchWorkoutsV2Operation extends AbstractBTLEOperation<MoyoungDevic
     protected void doPerform() throws IOException {
         TransactionBuilder builder = performInitialized("FetchWorkoutsV2Operation");
         getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_V2_WORKOUT, new byte[]{MoyoungConstants.CMD_QUERY_V2_WORKOUT_LIST_REQUEST}));
-        builder.queue(getQueue());
+        builder.queue();
 
         updateProgressAndCheckFinish();
     }
@@ -199,7 +199,7 @@ public class FetchWorkoutsV2Operation extends AbstractBTLEOperation<MoyoungDevic
                     (byte) workoutId
             };
             getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_V2_WORKOUT, payload));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error while sending workout details request: ", e);
         }
@@ -213,7 +213,7 @@ public class FetchWorkoutsV2Operation extends AbstractBTLEOperation<MoyoungDevic
             payload.put((byte) workoutId);
             payload.putShort((short) index);
             getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_V2_WORKOUT, payload.array()));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error while sending workout HR request: ", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/MoyoungDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/MoyoungDeviceSupport.java
index a079246ab7..36d79cc011 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/MoyoungDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/MoyoungDeviceSupport.java
@@ -189,8 +189,8 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         final int mtu = ((AbstractMoyoungDeviceCoordinator) getDevice().getDeviceCoordinator()).getMtu();
         builder.requestMtu(mtu + 3);  // Add 3 bytes for the BLE overhead
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-        builder.notify(getCharacteristic(MoyoungConstants.UUID_CHARACTERISTIC_DATA_IN), true);
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
+        builder.notify(MoyoungConstants.UUID_CHARACTERISTIC_DATA_IN, true);
         deviceInfoProfile.requestDeviceInfo(builder);
         setTime(builder);
         setMeasurementSystem(builder);
@@ -199,8 +199,8 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         batteryInfoProfile.requestBatteryInfo(builder);
         batteryInfoProfile.enableNotify(builder, true);
         heartRateProfile.enableNotify(builder, true);
-        builder.notify(getCharacteristic(MoyoungConstants.UUID_CHARACTERISTIC_STEPS), true);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.notify(MoyoungConstants.UUID_CHARACTERISTIC_STEPS, true);
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         // TODO: I would prefer this to be done when the alarms screen is open, not on initialization...
         sendPacket(builder, MoyoungPacketOut.buildPacket(mtu, MoyoungConstants.CMD_QUERY_ALARM_CLOCK, new byte[0]));
@@ -572,7 +572,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
             payload[0] = type;
             System.arraycopy(str, 0, payload, 1, str.length);
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_SEND_MESSAGE, payload));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending notification: ", e);
         }
@@ -639,7 +639,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("onSetTime");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error setting time: ", e);
         }
@@ -860,7 +860,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 bufferNewProtocol.put(buffer.array(), 0, 8);
                 sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_QUERY, bufferNewProtocol.array()));
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error setting alarms: ", e);
         }
@@ -892,7 +892,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("sendMusicState");
             byte[] payload = new byte[]{(byte) (stateSpec.state == MusicStateSpec.STATE_PLAYING ? 0x01 : 0x00)};
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_SET_MUSIC_STATE, payload));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending music state: ", e);
         }
@@ -923,7 +923,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     (byte) (16 * volumeFraction)
             }));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending music info: ", e);
         }
@@ -957,7 +957,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_CMD, payload.array()));
                 currentNr++;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending world clocks: ", e);
         }
@@ -1040,7 +1040,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     MoyoungConstants.ARG_CALENDAR_FINISHED
             };
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_QUERY, payload));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending notification: ", e);
         }
@@ -1059,7 +1059,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     MoyoungConstants.ARG_CALENDAR_DISABLE
             };
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_QUERY, payload));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error while disabling calendar: ", e);
         }
@@ -1086,7 +1086,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("fetchStress");
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_QUERY, new byte[]{MoyoungConstants.ARG_ADVANCED_STRESS_PACKET, 0x03, 0x00}));
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_ADVANCED_QUERY, new byte[]{MoyoungConstants.ARG_ADVANCED_STRESS_PACKET, 0x03, 0x01}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error while sending stress sync request: ", e);
         }
@@ -1196,7 +1196,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("FetchHROperation");
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_QUERY_PAST_HEART_RATE_1, new byte[]{(byte) (packetIndex + 1)}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Failed sending HR history request packet: ", e);
         }
@@ -1446,7 +1446,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("shutdown");
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_SHUTDOWN, new byte[]{-1}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending reset command: ", e);
         }
@@ -1456,7 +1456,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("onHeartRateTest");
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_TRIGGER_MEASURE_HEARTRATE, new byte[]{start ? (byte) 0 : (byte) -1}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending heart rate test command: ", e);
         }
@@ -1513,7 +1513,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
             try {
                 TransactionBuilder builder = performInitialized("onFindDevice");
                 sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_FIND_MY_WATCH, new byte[0]));
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 LOG.error("Error while finding device: ", e);
             }
@@ -1552,7 +1552,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("sendSetting");
             sendSetting(builder, setting, newValue);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending setting: ", e);
         }
@@ -1567,7 +1567,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("querySetting");
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), setting.cmdQuery, new byte[0]));
-            builder.queue(getQueue());
+            builder.queue();
             queriedSettings.add(setting);
         } catch (IOException e) {
             LOG.error("Error querying setting: ", e);
@@ -2039,7 +2039,7 @@ public class MoyoungDeviceSupport extends AbstractBTLESingleDeviceSupport {
             }
             sendPacket(builder, MoyoungPacketOut.buildPacket(getMtu(), MoyoungConstants.CMD_SET_WEATHER_FUTURE, packetWeatherForecast.array()));
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error sending weather: ", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/QuerySettingsOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/QuerySettingsOperation.java
index 62ae453add..5c28fa277d 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/QuerySettingsOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/QuerySettingsOperation.java
@@ -70,7 +70,7 @@ public class QuerySettingsOperation extends AbstractBTLEOperation<MoyoungDeviceS
 
             getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), setting.cmdQuery, new byte[0]));
         }
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/TrainingFinishedDataOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/TrainingFinishedDataOperation.java
index 1a55fc30a4..17007f34a1 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/TrainingFinishedDataOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/moyoung/TrainingFinishedDataOperation.java
@@ -133,7 +133,7 @@ public class TrainingFinishedDataOperation extends AbstractBTLEOperation<Moyoung
         try {
             TransactionBuilder builder = performInitialized("TrainingFinishedDataOperation");
             getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_LAST_DYNAMIC_RATE, new byte[0]));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error fetching training data: ", e);
             GB.toast(getContext(), "Error fetching training data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
@@ -188,7 +188,7 @@ public class TrainingFinishedDataOperation extends AbstractBTLEOperation<Moyoung
         try {
             TransactionBuilder builder = performInitialized("TrainingFinishedDataOperation fetch training type");
             getSupport().sendPacket(builder, MoyoungPacketOut.buildPacket(getSupport().getMtu(), MoyoungConstants.CMD_QUERY_MOVEMENT_HEART_RATE, new byte[]{}));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.error("Error fetching training data: ", e);
             GB.toast(getContext(), "Error fetching training data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/no1f1/No1F1Support.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/no1f1/No1F1Support.java
index 10d04e55d8..de3723030f 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/no1f1/No1F1Support.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/no1f1/No1F1Support.java
@@ -76,7 +76,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.info("Initializing");
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         measureCharacteristic = getCharacteristic(No1F1Constants.UUID_CHARACTERISTIC_MEASURE);
         ctrlCharacteristic = getCharacteristic(No1F1Constants.UUID_CHARACTERISTIC_CONTROL);
@@ -90,7 +90,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
         builder.write(ctrlCharacteristic, new byte[]{No1F1Constants.CMD_FIRMWARE_VERSION});
         builder.write(ctrlCharacteristic, new byte[]{No1F1Constants.CMD_BATTERY});
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         LOG.info("Initialization Done");
 
@@ -164,7 +164,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("setTime");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error setting time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -206,7 +206,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                 };
                 builder.write(ctrlCharacteristic, alarmMessage);
             }
-            builder.queue(getQueue());
+            builder.queue();
             if (anyAlarmEnabled) {
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
             } else {
@@ -242,7 +242,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                     (byte) 0x11
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error starting heart rate measurement: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -266,7 +266,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                     setDisplaySettings(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
         }
@@ -389,7 +389,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                     1
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("Unable to set vibration", e);
         }
@@ -403,7 +403,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                     (byte) iconId
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing icon: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -435,7 +435,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
             System.arraycopy(bytes, 0, msg, 2, length);
             builder.write(ctrlCharacteristic, msg);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing notificaton: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -449,7 +449,7 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
                     No1F1Constants.NOTIFICATION_STOP
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("Unable to stop notification", e);
         }
@@ -461,13 +461,13 @@ public class No1F1Support extends AbstractBTLESingleDeviceSupport {
         firstTimestamp = 0;
         try {
             TransactionBuilder builder = performInitialized("fetchActivityData");
-            builder.setBusyTask(getDevice(), R.string.busy_task_fetch_activity_data, getContext());
+            builder.setBusyTask(R.string.busy_task_fetch_activity_data);
             byte[] msg = new byte[]{
                     type,
                     (byte) 0xfa
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error fetching activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/nut/NutSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/nut/NutSupport.java
index 88ceaae381..92027383a2 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/nut/NutSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/nut/NutSupport.java
@@ -125,8 +125,8 @@ public class NutSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         // Init prefs
         prefs = GBApplication.getDeviceSpecificSharedPrefs(getDevice().getAddress());
@@ -145,20 +145,20 @@ public class NutSupport extends AbstractBTLESingleDeviceSupport {
              * Part of {@link NutConstants.SERVICE_PROPRIETARY_NUT}
              * Enables proprietary notification
              */
-            builder.notify(getCharacteristic(NutConstants.CHARAC_AUTH_STATUS), true);
+            builder.notify(NutConstants.CHARAC_AUTH_STATUS, true);
             LOG.info("Enabled authentication status notify");
 
             /**
              * Part of {@link NutConstants.SERVICE_UNKNOWN_2}
              * Enables button-press notify
              */
-            builder.notify(getCharacteristic(NutConstants.CHARAC_UNKNOWN_2), true);
+            builder.notify(NutConstants.CHARAC_UNKNOWN_2, true);
         } else {
             /**
              * Part of {@link NutConstants.SERVICE_UNKNOWN_1_WEIRDNESS}
              * Enables button-press notify
              */
-            builder.notify(getCharacteristic(NutConstants.CHARAC_CHANGE_POWER), true);
+            builder.notify(NutConstants.CHARAC_CHANGE_POWER, true);
         }
 
         readDeviceInfo();
@@ -459,7 +459,7 @@ public class NutSupport extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder(taskName);
         builder.write(characteristic, data);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     /**
@@ -473,7 +473,7 @@ public class NutSupport extends AbstractBTLESingleDeviceSupport {
 
         TransactionBuilder builder = createTransactionBuilder(taskName);
         builder.read(characteristic);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/pinetime/PineTimeJFSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/pinetime/PineTimeJFSupport.java
index e4db0ea0e1..9b31fb4487 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/pinetime/PineTimeJFSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/pinetime/PineTimeJFSupport.java
@@ -336,7 +336,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
         AlertNotificationProfile<?> profile = new AlertNotificationProfile<>(this);
         profile.setMaxLength(MaxNotificationLength);
         profile.newAlert(builder, alert, OverflowStrategy.TRUNCATE);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -398,7 +398,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
         }
 
         safeWriteToCharacteristic(builder, PineTimeJFConstants.UUID_CHARACTERISTICS_NAVIGATION_FLAGS, iconname.getBytes(StandardCharsets.UTF_8));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
@@ -414,9 +414,9 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
         byte[] bytesLocalTime = BLETypeConversions.calendarToLocalTime(now);
 
         TransactionBuilder builder = createTransactionBuilder("set time");
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME), bytesCurrentTime);
-        builder.write(getCharacteristic(GattCharacteristic.UUID_CHARACTERISTIC_LOCAL_TIME), bytesLocalTime);
-        builder.queue(getQueue());
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_CURRENT_TIME, bytesCurrentTime);
+        builder.write(GattCharacteristic.UUID_CHARACTERISTIC_LOCAL_TIME, bytesLocalTime);
+        builder.queue();
     }
 
     @Override
@@ -435,7 +435,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
             AlertNotificationProfile<?> profile = new AlertNotificationProfile<>(this);
             profile.setMaxLength(MaxNotificationLength);
             profile.newAlert(builder, alert, OverflowStrategy.TRUNCATE);
-            builder.queue(getQueue());
+            builder.queue();
         }
     }
 
@@ -486,24 +486,24 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
         if (GBApplication.getPrefs().getBoolean("datetime_synconconnect", true)) {
             onSetTime();
         }
         setWorldClocks();
-        builder.notify(getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTICS_MUSIC_EVENT), true);
+        builder.notify(PineTimeJFConstants.UUID_CHARACTERISTICS_MUSIC_EVENT, true);
         BluetoothGattCharacteristic alertNotificationEventCharacteristic = getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTIC_ALERT_NOTIFICATION_EVENT);
         if (alertNotificationEventCharacteristic != null) {
             builder.notify(alertNotificationEventCharacteristic, true);
         }
 
         if (getSupportedServices().contains(PineTimeJFConstants.UUID_SERVICE_MOTION)) {
-            builder.notify(getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTIC_MOTION_STEP_COUNT), true);
+            builder.notify(PineTimeJFConstants.UUID_CHARACTERISTIC_MOTION_STEP_COUNT, true);
             //builder.notify(getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTIC_MOTION_RAW_XYZ_VALUES), false); // issue #2527
         }
 
-        builder.notify(getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT), true);
+        builder.notify(PineTimeJFConstants.UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT, true);
 
         setInitialized(builder);
         batteryInfoProfile.requestBatteryInfo(builder);
@@ -541,7 +541,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                 safeWriteToCharacteristic(builder, PineTimeJFConstants.UUID_CHARACTERISTICS_MUSIC_TRACK_TOTAL, intToBytes(musicSpec.trackCount));
             }
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             LOG.error("Error sending music info", e);
         }
@@ -576,7 +576,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                 safeWriteToCharacteristic(builder, PineTimeJFConstants.UUID_CHARACTERISTICS_MUSIC_SHUFFLE, intToBytes(stateSpec.repeat));
             }
 
-            builder.queue(getQueue());
+            builder.queue();
 
         } catch (Exception e) {
             LOG.error("Error sending music state", e);
@@ -632,8 +632,8 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
             }
 
             TransactionBuilder builder = createTransactionBuilder("set world clocks");
-            builder.write(getCharacteristic(PineTimeJFConstants.UUID_CHARACTERISTIC_WORLD_TIME), baos.toByteArray());
-            builder.queue(getQueue());
+            builder.write(PineTimeJFConstants.UUID_CHARACTERISTIC_WORLD_TIME, baos.toByteArray());
+            builder.queue();
         } catch (Exception e) {
             LOG.error("Error sending world clocks", e);
         }
@@ -747,7 +747,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         // Current condition
@@ -777,7 +777,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         // Current temperature
@@ -803,7 +803,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         // 24h temperature forecast
@@ -861,7 +861,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         // Current weather condition
@@ -887,7 +887,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         if (mapOpenWeatherConditionToPineTimeObscuration(weatherSpec.currentConditionCode) != WeatherData.ObscurationType.Length) {
@@ -912,7 +912,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         if (mapOpenWeatherConditionToPineTimeSpecial(weatherSpec.currentConditionCode) != WeatherData.SpecialType.Length) {
@@ -936,7 +936,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         if (mapOpenWeatherConditionToCloudCover(weatherSpec.currentConditionCode) != -1) {
@@ -960,7 +960,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                     PineTimeJFConstants.UUID_CHARACTERISTIC_WEATHER_DATA,
                     encodedBytes);
 
-            builder.queue(getQueue());
+            builder.queue();
         }
 
         LOG.debug("Wrote weather data");
@@ -987,7 +987,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
             PineTimeJFConstants.UUID_CHARACTERISTIC_SIMPLE_WEATHER_DATA,
             currentPacket.array());
 
-        currentBuilder.queue(getQueue());
+        currentBuilder.queue();
 
         if (weatherSpec.forecasts == null) {
             return;
@@ -1009,7 +1009,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
                 PineTimeJFConstants.UUID_CHARACTERISTIC_SIMPLE_WEATHER_DATA,
                 forecastPacket.array());
 
-        forecastBuilder.queue(getQueue());
+        forecastBuilder.queue();
     }
 
     @Override
@@ -1051,7 +1051,7 @@ public class PineTimeJFSupport extends AbstractBTLESingleDeviceSupport implement
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     private void requestDeviceInfo(TransactionBuilder builder) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/polar/PolarH10DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/polar/PolarH10DeviceSupport.java
index 7ac362f4cf..900f9ba175 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/polar/PolarH10DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/polar/PolarH10DeviceSupport.java
@@ -76,7 +76,7 @@ public class PolarH10DeviceSupport extends AbstractBTLESingleDeviceSupport {
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         // Enter initializing state
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         deviceInfoProfile.requestDeviceInfo(builder);
         deviceInfoProfile.enableNotify(builder, true);
@@ -84,15 +84,15 @@ public class PolarH10DeviceSupport extends AbstractBTLESingleDeviceSupport {
         batteryInfoProfile.requestBatteryInfo(builder);
         batteryInfoProfile.enableNotify(builder, true);
 
-        builder.notify(getCharacteristic(UUID_SERVICE_BATTERY_SERVICE), true);
-        builder.notify(getCharacteristic(UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT), true);
+        builder.notify(UUID_SERVICE_BATTERY_SERVICE, true);
+        builder.notify(UUID_CHARACTERISTIC_HEART_RATE_MEASUREMENT, true);
 
         // Set defaults
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
 
         // Enter initialized state
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         return builder;
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/QHybridSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/QHybridSupport.java
index ca4dcba22a..9991694c17 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/QHybridSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/QHybridSupport.java
@@ -505,7 +505,7 @@ public class QHybridSupport extends QHybridBaseSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         this.useActivityHand = GBApplication.getPrefs().getBoolean("QHYBRID_USE_ACTIVITY_HAND", false);
         getDevice().addDeviceInfo(new GenericItem(ITEM_USE_ACTIVITY_HAND, String.valueOf(this.useActivityHand)));
@@ -516,16 +516,16 @@ public class QHybridSupport extends QHybridBaseSupport {
         }
 
         for (int i = 2; i <= 7; i++)
-            builder.notify(getCharacteristic(UUID.fromString("3dda000" + i + "-957f-7d4a-34a6-74696673696d")), true);
+            builder.notify(UUID.fromString("3dda000" + i + "-957f-7d4a-34a6-74696673696d"), true);
 
-        builder.notify(getCharacteristic(UUID.fromString("010541ae-efe8-11c0-91c0-105d1a1155f0")), true);
-        builder.notify(getCharacteristic(UUID.fromString("fef9589f-9c21-4d19-9fc0-105d1a1155f0")), true);
-        builder.notify(getCharacteristic(UUID.fromString("842d2791-0d20-4ce4-1ada-105d1a1155f0")), true);
+        builder.notify(UUID.fromString("010541ae-efe8-11c0-91c0-105d1a1155f0"), true);
+        builder.notify(UUID.fromString("fef9589f-9c21-4d19-9fc0-105d1a1155f0"), true);
+        builder.notify(UUID.fromString("842d2791-0d20-4ce4-1ada-105d1a1155f0"), true);
 
         builder
-                .read(getCharacteristic(UUID.fromString("00002a19-0000-1000-8000-00805f9b34fb")))
-                .read(getCharacteristic(UUID.fromString("00002a26-0000-1000-8000-00805f9b34fb")))
-                .read(getCharacteristic(UUID.fromString("00002a24-0000-1000-8000-00805f9b34fb")))
+                .read(UUID.fromString("00002a19-0000-1000-8000-00805f9b34fb"))
+                .read(UUID.fromString("00002a26-0000-1000-8000-00805f9b34fb"))
+                .read(UUID.fromString("00002a24-0000-1000-8000-00805f9b34fb"))
                 // .notify(getCharacteristic(UUID.fromString("00002a37-0000-1000-8000-00805f9b34fb")), true)
         ;
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/fossil/FossilWatchAdapter.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/fossil/FossilWatchAdapter.java
index a87c368bea..e790d62a15 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/fossil/FossilWatchAdapter.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/fossil/FossilWatchAdapter.java
@@ -60,7 +60,6 @@ import nodomain.freeyourgadget.gadgetbridge.entities.HybridHRActivitySample;
 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;
 import nodomain.freeyourgadget.gadgetbridge.model.Alarm;
 import nodomain.freeyourgadget.gadgetbridge.model.GenericItem;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.QHybridSupport;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.adapter.WatchAdapter;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.buttonconfig.ConfigFileBuilder;
@@ -705,17 +704,17 @@ public class FossilWatchAdapter extends WatchAdapter {
                 if (start) {
                     getDeviceSupport().createTransactionBuilder("vibrate find")
                             .write(
-                                    getDeviceSupport().getCharacteristic(UUID.fromString("3dda0005-957f-7d4a-34a6-74696673696d")),
+                                    UUID.fromString("3dda0005-957f-7d4a-34a6-74696673696d"),
                                     new byte[]{(byte) 0x01, (byte) 0x04, (byte) 0x30, (byte) 0x75, (byte) 0x00, (byte) 0x00}
                             )
-                            .queue(getDeviceSupport().getQueue());
+                            .queue();
                 } else {
                     getDeviceSupport().createTransactionBuilder("vibrate find")
                             .write(
-                                    getDeviceSupport().getCharacteristic(UUID.fromString("3dda0005-957f-7d4a-34a6-74696673696d")),
+                                    UUID.fromString("3dda0005-957f-7d4a-34a6-74696673696d"),
                                     new byte[]{(byte) 0x02, (byte) 0x05, (byte) 0x04}
                             )
-                            .queue(getDeviceSupport().getQueue());
+                            .queue();
                 }
             }
         } catch (UnsupportedOperationException e) {
@@ -820,7 +819,7 @@ public class FossilWatchAdapter extends WatchAdapter {
         }
         getDeviceSupport().createTransactionBuilder("requestMtu")
                 .requestMtu(512)
-                .queue(getDeviceSupport().getQueue());
+                .queue();
 
         this.fossilRequest = request;
     }
@@ -866,7 +865,7 @@ public class FossilWatchAdapter extends WatchAdapter {
         log("executing request: " + request.getName());
         restartRequestTimeout();
         this.fossilRequest = request;
-        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(getDeviceSupport().getCharacteristic(request.getRequestUUID()), request.getRequestData()).queue(getDeviceSupport().getQueue());
+        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(request.getRequestUUID(), request.getRequestData()).queue();
 
         if (request.isFinished()) {
             this.fossilRequest = null;
@@ -882,7 +881,7 @@ public class FossilWatchAdapter extends WatchAdapter {
             return;
         }
         restartRequestTimeout();
-        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(getDeviceSupport().getCharacteristic(request.getRequestUUID()), request.getRequestData()).queue(getDeviceSupport().getQueue());
+        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(request.getRequestUUID(), request.getRequestData()).queue();
 
         queueNextRequest();
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/misfit/MisfitWatchAdapter.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/misfit/MisfitWatchAdapter.java
index d278f068cc..fe1c0f71bd 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/misfit/MisfitWatchAdapter.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/adapter/misfit/MisfitWatchAdapter.java
@@ -54,7 +54,6 @@ import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;
 import nodomain.freeyourgadget.gadgetbridge.model.Alarm;
 import nodomain.freeyourgadget.gadgetbridge.model.BatteryState;
 import nodomain.freeyourgadget.gadgetbridge.model.GenericItem;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.QHybridSupport;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.adapter.WatchAdapter;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.requests.Request;
@@ -314,7 +313,7 @@ public class MisfitWatchAdapter extends WatchAdapter {
                 break;
             case UPLOAD:
                 for (byte[] packet : this.uploadFileRequest.packets) {
-                    getDeviceSupport().createTransactionBuilder("File upload").write(characteristic, packet).queue(getDeviceSupport().getQueue());
+                    getDeviceSupport().createTransactionBuilder("File upload").write(characteristic, packet).queue();
                 }
                 break;
             case UPLOADED:
@@ -495,7 +494,7 @@ public class MisfitWatchAdapter extends WatchAdapter {
     }
 
     private void queueWrite(Request request) {
-        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(getDeviceSupport().getCharacteristic(request.getRequestUUID()), request.getRequestData()).queue(getDeviceSupport().getQueue());
+        getDeviceSupport().createTransactionBuilder(request.getClass().getSimpleName()).write(request.getRequestUUID(), request.getRequestData()).queue();
         // if (request instanceof FileRequest) this.fileRequest = request;
 
         if (!request.expectsResponse()) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FilePutRawRequest.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FilePutRawRequest.java
index 43e5a136aa..c83e245fae 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FilePutRawRequest.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FilePutRawRequest.java
@@ -94,7 +94,7 @@ public class FilePutRawRequest extends FossilRequest {
                         onPacketWritten(transactionBuilder, i, packetCount);
                     }
 
-                    transactionBuilder.queue(adapter.getDeviceSupport().getQueue());
+                    transactionBuilder.queue();
                     break;
                 }
                 case 8: {
@@ -126,10 +126,10 @@ public class FilePutRawRequest extends FossilRequest {
 
                     adapter.getDeviceSupport().createTransactionBuilder("file close")
                             .write(
-                                    adapter.getDeviceSupport().getCharacteristic(UUID.fromString("3dda0003-957f-7d4a-34a6-74696673696d")),
+                                    UUID.fromString("3dda0003-957f-7d4a-34a6-74696673696d"),
                                     buffer2.array()
                             )
-                            .queue(adapter.getDeviceSupport().getQueue());
+                            .queue();
 
                     this.state = UploadState.CLOSING;
                     break;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FirmwareFilePutRequest.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FirmwareFilePutRequest.java
index fc372d4cb6..c4deb1483b 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FirmwareFilePutRequest.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil/file/FirmwareFilePutRequest.java
@@ -32,7 +32,7 @@ public class FirmwareFilePutRequest extends FilePutRawRequest {
     @Override
     public void onPacketWritten(TransactionBuilder transactionBuilder, int packetNr, int packetCount) {
         int progressPercent = (int) ((((float) packetNr) / packetCount) * 100);
-        transactionBuilder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent, GBApplication.getContext());
+        transactionBuilder.setProgress(R.string.updatefirmwareoperation_update_in_progress, true, progressPercent);
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/authentication/VerifyPrivateKeyRequest.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/authentication/VerifyPrivateKeyRequest.java
index c91e18eb23..f44c701ca7 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/authentication/VerifyPrivateKeyRequest.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/authentication/VerifyPrivateKeyRequest.java
@@ -23,7 +23,6 @@ import java.security.InvalidAlgorithmParameterException;
 import java.security.InvalidKeyException;
 import java.security.NoSuchAlgorithmException;
 import java.util.Random;
-import java.util.UUID;
 
 import javax.crypto.BadPaddingException;
 import javax.crypto.Cipher;
@@ -32,9 +31,7 @@ import javax.crypto.NoSuchPaddingException;
 import javax.crypto.spec.IvParameterSpec;
 import javax.crypto.spec.SecretKeySpec;
 
-import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.adapter.fossil_hr.FossilHRWatchAdapter;
-import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.requests.fossil.FossilRequest;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.qhybrid.requests.fossil_hr.file.ResultCode;
 
 public class VerifyPrivateKeyRequest extends AuthenticationRequest {
@@ -92,7 +89,7 @@ public class VerifyPrivateKeyRequest extends AuthenticationRequest {
 
                 adapter.getDeviceSupport().createTransactionBuilder("send encrypted random numbers")
                         .write(characteristic, payload)
-                        .queue(this.adapter.getDeviceSupport().getQueue());
+                        .queue();
             } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException | InvalidAlgorithmParameterException e) {
                 throw new RuntimeException(e);
             }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/file/FileEncryptedPutRequest.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/file/FileEncryptedPutRequest.java
index 33ea6e26f2..ed7a7b78ef 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/file/FileEncryptedPutRequest.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/qhybrid/requests/fossil_hr/file/FileEncryptedPutRequest.java
@@ -120,7 +120,7 @@ public class FileEncryptedPutRequest extends FossilRequest implements FileEncryp
                         GB.toast("error encrypting file", Toast.LENGTH_LONG, GB.ERROR, e);
                     }
 
-                    transactionBuilder.queue(adapter.getDeviceSupport().getQueue());
+                    transactionBuilder.queue();
                     break;
                 }
                 case 8: {
@@ -152,10 +152,10 @@ public class FileEncryptedPutRequest extends FossilRequest implements FileEncryp
 
                     adapter.getDeviceSupport().createTransactionBuilder("file close")
                             .write(
-                                    adapter.getDeviceSupport().getCharacteristic(UUID.fromString("3dda0003-957f-7d4a-34a6-74696673696d")),
+                                    UUID.fromString("3dda0003-957f-7d4a-34a6-74696673696d"),
                                     buffer2.array()
                             )
-                            .queue(adapter.getDeviceSupport().getQueue());
+                            .queue();
 
                     this.state = UploadState.CLOSING;
                     break;
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/soflow/SoFlowSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/soflow/SoFlowSupport.java
index b199570035..d085bf34a6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/soflow/SoFlowSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/soflow/SoFlowSupport.java
@@ -78,9 +78,9 @@ public class SoFlowSupport extends AbstractBTLESingleDeviceSupport {
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         aesKey = getSecretKey();
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
-        builder.notify(getCharacteristic(UUID_CHARACTERISICS_NOTIFICATION), true);
+        builder.notify(UUID_CHARACTERISICS_NOTIFICATION, true);
         writeEncrypted(builder, COMMAND_REQUEST_SESSION);
         setInitialized(builder);
         return builder;
@@ -92,13 +92,13 @@ public class SoFlowSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     private void writeEncrypted(TransactionBuilder builder, byte[] data) {
         try {
             LOG.debug("will encrypt " + GB.hexdump(data));
-            builder.write(getCharacteristic(UUID_CHARACTERISICS_WRITE), CryptoUtils.encryptAES(data, aesKey));
+            builder.write(UUID_CHARACTERISICS_WRITE, CryptoUtils.encryptAES(data, aesKey));
         } catch (Exception e) {
             LOG.error("error while encrypting data");
         }
@@ -198,7 +198,7 @@ public class SoFlowSupport extends AbstractBTLESingleDeviceSupport {
                     writeEncrypted(builder, COMMAND_UNLOCK);
                 }
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
         }
@@ -223,7 +223,7 @@ public class SoFlowSupport extends AbstractBTLESingleDeviceSupport {
         try {
             builder = performInitialized("request unknown");
             writeEncrypted(builder,COMMAND_REQUEST_LOCK);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast("Error setting configuration", Toast.LENGTH_LONG, GB.ERROR, e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sony/wena3/SonyWena3DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sony/wena3/SonyWena3DeviceSupport.java
index 6a0e96340f..6123f22d23 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sony/wena3/SonyWena3DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sony/wena3/SonyWena3DeviceSupport.java
@@ -164,7 +164,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         if(perAppNotificationSettingsRepository == null) {
             perAppNotificationSettingsRepository = new AppSpecificNotificationSettingsRepository(getDevice());
         }
@@ -175,23 +175,23 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         sendAllCalendarEvents(builder);
 
         // Get battery state
-        builder.read(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_STATE_UUID));
+        builder.read(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_STATE_UUID);
 
         // Subscribe to updates
-        builder.notify(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_STATE_UUID), true);
-        builder.notify(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID), true);
-        builder.notify(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_INFO_UUID), true);
-        builder.notify(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_MODE_UUID), true);
-        builder.notify(getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID), true);
-        builder.notify(getCharacteristic(SonyWena3Constants.ACTIVITY_LOG_CHARACTERISTIC_UUID), true);
+        builder.notify(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_STATE_UUID, true);
+        builder.notify(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID, true);
+        builder.notify(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_INFO_UUID, true);
+        builder.notify(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_MODE_UUID, true);
+        builder.notify(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID, true);
+        builder.notify(SonyWena3Constants.ACTIVITY_LOG_CHARACTERISTIC_UUID, true);
 
         // Get serial number and firmware version
-        builder.read(getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_INFO_UUID));
+        builder.read(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_INFO_UUID);
 
         // Finally, sync activity data
         requestActivityDataDownload(builder, false);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         CalendarReceiver.forceSync(getDevice());
         return builder;
     }
@@ -270,12 +270,12 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
             Date currentTime = new Date();
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                    SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                     new TimeSetting(currentTime).toByteArray()
             );
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                    SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                     new TimeZoneSetting(tz, currentTime).toByteArray()
             );
 
@@ -290,7 +290,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("updateMusic");
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                    SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                     new MusicInfo(musicInfo != null ? musicInfo: "").toByteArray()
             );
 
@@ -395,7 +395,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = b == null ? performInitialized("updateWeather") : b;
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                    SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                     weather.toByteArray()
             );
 
@@ -458,7 +458,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 }
 
                 builder.write(
-                        getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                        SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                         new NotificationArrival(
                                 NotificationKind.CALL,
                                 INCOMING_CALL_ID,
@@ -473,7 +473,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 );
             } else {
                 builder.write(
-                        getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                        SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                         new NotificationRemoval(NotificationKind.CALL, INCOMING_CALL_ID).toByteArray()
                 );
             }
@@ -558,7 +558,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
             }
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                    SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                     new NotificationArrival(
                             NotificationKind.APP,
                             notificationSpec.getId(),
@@ -588,7 +588,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("delNotify");
 
             builder.write(
-                    getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                    SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                     new NotificationRemoval(NotificationKind.APP, id).toByteArray()
             );
 
@@ -656,7 +656,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 }
 
                 builder.write(
-                        getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                        SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                         pkt.toByteArray()
                 );
             }
@@ -707,7 +707,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         );
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 pkt.toByteArray()
         );
     }
@@ -737,7 +737,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         DoNotDisturbSettings dndPkt = new DoNotDisturbSettings(isDndOn, startH, startM, endH, endM);
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 dndPkt.toByteArray()
         );
     }
@@ -767,7 +767,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         AutoPowerOffSettings powerOffPkt = new AutoPowerOffSettings(isAutoPowerOffEnabled, startH, startM, endH, endM);
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 powerOffPkt.toByteArray()
         );
     }
@@ -779,7 +779,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         VibrationSetting pkt = new VibrationSetting(smartVibration, strength);
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 pkt.toByteArray()
         );
     }
@@ -791,7 +791,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         String rightIdName = prefs.getString(SonyWena3SettingKeys.RIGHT_HOME_ICON, HomeIconId.CALORIES.name()).toUpperCase();
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 new HomeIconOrderSetting(
                         HomeIconId.valueOf(leftIdName),
                         HomeIconId.valueOf(centerIdName),
@@ -816,7 +816,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         }
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 menu.toByteArray()
         );
     }
@@ -835,7 +835,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         }
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 pageOrderSetting.toByteArray()
         );
     }
@@ -865,11 +865,11 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         GoalStepsSetting stepsSetting = new GoalStepsSetting(stepsNotification, user.getStepsGoal());
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 bodyPropertiesSetting.toByteArray()
         );
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 stepsSetting.toByteArray()
         );
     }
@@ -880,7 +880,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         DayStartHourSetting setting = new DayStartHourSetting(hour);
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 setting.toByteArray()
         );
     }
@@ -895,7 +895,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         );
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 setting.toByteArray()
         );
     }
@@ -907,7 +907,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
         CalendarNotificationEnableSetting setting = new CalendarNotificationEnableSetting(enableCalendar, enableNotifications);
 
         b.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 setting.toByteArray()
         );
     }
@@ -915,7 +915,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void sendAllSettings(TransactionBuilder builder) {
         sendCurrentTime(builder);
         builder.write(
-                getCharacteristic(SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID),
+                SonyWena3Constants.COMMON_SERVICE_CHARACTERISTIC_CONTROL_UUID,
                 CameraAppTypeSetting.findOut(getContext().getPackageManager()).toByteArray()
         );
         sendMenuSettings(builder);
@@ -940,7 +940,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
             if(!enableCalendar || calendarEvents.isEmpty()) {
                 builder.write(
-                        getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                        SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                         CalendarEntry.byteArrayForEmptyEvent((byte) 0, (byte) 0)
                 );
             }
@@ -949,7 +949,7 @@ public class SonyWena3DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 int total = Math.min(calendarEvents.size(), 255);
                 for(CalendarEventSpec evt: calendarEvents) {
                     builder.write(
-                            getCharacteristic(SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID),
+                            SonyWena3Constants.NOTIFICATION_SERVICE_CHARACTERISTIC_UUID,
                             new CalendarEntry(
                                     new Date(evt.timestamp * 1000L),
                                     new Date((evt.timestamp * 1000L) + (evt.durationInSeconds * 1000L)),
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sonyswr12/SonySWR12DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sonyswr12/SonySWR12DeviceSupport.java
index 02eed12110..9b8627766b 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sonyswr12/SonySWR12DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/sonyswr12/SonySWR12DeviceSupport.java
@@ -123,7 +123,7 @@ public class SonySWR12DeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("setTime");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             GB.toast(getContext(), "Error setting time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -148,7 +148,7 @@ public class SonySWR12DeviceSupport extends AbstractBTLESingleDeviceSupport {
                     bandAlarmList.add(bandAlarm);
             }
             builder.write(alarmCharacteristic, new BandAlarms(bandAlarmList).toByteArray());
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             GB.toast(getContext(), "Error setting alarms: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -180,10 +180,10 @@ public class SonySWR12DeviceSupport extends AbstractBTLESingleDeviceSupport {
     public void onFetchRecordedData(int dataTypes) {
         try {
             TransactionBuilder builder = performInitialized("fetchActivity");
-            builder.notify(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_EVENT), true);
+            builder.notify(SonySWR12Constants.UUID_CHARACTERISTIC_EVENT, true);
             ControlPointWithValue flushControl = new ControlPointWithValue(CommandCode.FLUSH_ACTIVITY, 0);
-            builder.write(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT), flushControl.toByteArray());
-            builder.queue(getQueue());
+            builder.write(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT, flushControl.toByteArray());
+            builder.queue();
         } catch (Exception e) {
             LOG.error("failed to fetch activity data", e);
         }
@@ -193,10 +193,10 @@ public class SonySWR12DeviceSupport extends AbstractBTLESingleDeviceSupport {
     public void onEnableRealtimeHeartRateMeasurement(boolean enable) {
         try {
             TransactionBuilder builder = performInitialized("HeartRateTest");
-            builder.notify(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_EVENT), enable);
+            builder.notify(SonySWR12Constants.UUID_CHARACTERISTIC_EVENT, enable);
             ControlPointWithValue controlPointHeart = new ControlPointWithValue(CommandCode.HEARTRATE_REALTIME, enable ? 1 : 0);
-            builder.write(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT), controlPointHeart.toByteArray());
-            builder.queue(getQueue());
+            builder.write(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT, controlPointHeart.toByteArray());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to read heart rate from Sony device", ex);
         }
@@ -212,16 +212,16 @@ public class SonySWR12DeviceSupport extends AbstractBTLESingleDeviceSupport {
                     int status = GBApplication.getDeviceSpecificSharedPrefs(gbDevice.getAddress()).getBoolean(config, false) ? 1 : 0;
                     TransactionBuilder builder = performInitialized(config);
                     ControlPointWithValue vibrationControl = new ControlPointWithValue(CommandCode.STAMINA_MODE, status);
-                    builder.write(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT), vibrationControl.toByteArray());
-                    builder.queue(getQueue());
+                    builder.write(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT, vibrationControl.toByteArray());
+                    builder.queue();
                     break;
                 }
                 case DeviceSettingsPreferenceConst.PREF_SONYSWR12_LOW_VIBRATION: {
                     boolean isEnabled = GBApplication.getDeviceSpecificSharedPrefs(gbDevice.getAddress()).getBoolean(config, false);
                     TransactionBuilder builder = performInitialized(config);
                     ControlPointLowVibration vibrationControl = new ControlPointLowVibration(isEnabled);
-                    builder.write(getCharacteristic(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT), vibrationControl.toByteArray());
-                    builder.queue(getQueue());
+                    builder.write(SonySWR12Constants.UUID_CHARACTERISTIC_CONTROL_POINT, vibrationControl.toByteArray());
+                    builder.queue();
                     break;
                 }
                 case DeviceSettingsPreferenceConst.PREF_SONYSWR12_SMART_INTERVAL: {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/supercars/SuperCarsSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/supercars/SuperCarsSupport.java
index 436e5e0179..1e459f40e8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/supercars/SuperCarsSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/supercars/SuperCarsSupport.java
@@ -53,8 +53,8 @@ public class SuperCarsSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-        builder.notify(getCharacteristic(SuperCarsConstants.CHARACTERISTIC_UUID_FFF4), true); //for battery
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
+        builder.notify(SuperCarsConstants.CHARACTERISTIC_UUID_FFF4, true); //for battery
         builder.setCallback(this);
         LocalBroadcastManager broadcastManager = LocalBroadcastManager.getInstance(getContext());
 
@@ -63,7 +63,7 @@ public class SuperCarsSupport extends AbstractBTLESingleDeviceSupport {
         broadcastManager.registerReceiver(commandReceiver, filter);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         LOG.debug("Connected to: " + gbDevice.getName());
         return builder;
     }
@@ -159,7 +159,7 @@ public class SuperCarsSupport extends AbstractBTLESingleDeviceSupport {
         TransactionBuilder builder = createTransactionBuilder("send data");
         BluetoothGattCharacteristic writeCharacteristic = getCharacteristic(SuperCarsConstants.CHARACTERISTIC_UUID_FFF1);
         builder.write(writeCharacteristic, encryptData(command));
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     private byte[] craft_packet(SuperCarsConstants.Speed speed,
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/thermalprinter/GenericThermalPrinterSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/thermalprinter/GenericThermalPrinterSupport.java
index 09df7dfa23..d4a689cde7 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/thermalprinter/GenericThermalPrinterSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/thermalprinter/GenericThermalPrinterSupport.java
@@ -360,18 +360,18 @@ public class GenericThermalPrinterSupport extends AbstractBTLESingleDeviceSuppor
     }
 
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.INITIALIZING, getContext()));
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         builder.setCallback(this);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
         builder.requestMtu(512);
-        builder.notify(getCharacteristic(notifCharUUID), true);
+        builder.notify(notifCharUUID, true);
 
-        builder.write(getCharacteristic(writeCharUUID), PrinterCommand.getDevInfo.message(new byte[]{0x00}));
+        builder.write(writeCharUUID, PrinterCommand.getDevInfo.message(new byte[]{0x00}));
 
-        builder.write(getCharacteristic(writeCharUUID), PrinterCommand.getDevState.message(new byte[]{0x00}));
+        builder.write(writeCharUUID, PrinterCommand.getDevState.message(new byte[]{0x00}));
 
-        builder.add(new SetDeviceStateAction(getDevice(), GBDevice.State.INITIALIZED, getContext()));
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         registerPrintCommandReceiver();
 
@@ -389,7 +389,7 @@ public class GenericThermalPrinterSupport extends AbstractBTLESingleDeviceSuppor
     public void send(String taskname, byte[] command) {
         TransactionBuilder builder = createTransactionBuilder(taskname);
         builder.writeChunkedData(getCharacteristic(writeCharUUID), command, 123);
-        builder.queue(getQueue());
+        builder.queue();
     }
 
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/tlw64/TLW64Support.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/tlw64/TLW64Support.java
index 0c55254c8b..cbd12ef342 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/tlw64/TLW64Support.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/tlw64/TLW64Support.java
@@ -79,7 +79,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.info("Initializing");
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         ctrlCharacteristic = getCharacteristic(TLW64Constants.UUID_CHARACTERISTIC_CONTROL);
         notifyCharacteristic = getCharacteristic(TLW64Constants.UUID_CHARACTERISTIC_NOTIFY);
@@ -94,7 +94,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
         builder.write(ctrlCharacteristic, new byte[]{TLW64Constants.CMD_BATTERY});
         builder.write(ctrlCharacteristic, new byte[]{TLW64Constants.CMD_FIRMWARE_VERSION});
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         LOG.info("Initialization Done");
 
@@ -185,7 +185,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("setTime");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error setting time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -246,7 +246,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
                 };
                 builder.write(ctrlCharacteristic, alarmMessage);
             }
-            builder.queue(getQueue());
+            builder.queue();
             if (anyAlarmEnabled) {
                 GB.toast(getContext(), getContext().getString(R.string.user_feedback_miband_set_alarms_ok), Toast.LENGTH_SHORT, GB.INFO);
             } else {
@@ -282,7 +282,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
                         TLW64Constants.CMD_FACTORY_RESET,
                 };
                 builder.write(ctrlCharacteristic, msg);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 GB.toast(getContext(), "Error during factory reset: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
             }
@@ -310,7 +310,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
                     (byte) 0x01
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("Unable to set vibration", e);
         }
@@ -437,7 +437,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
                     (byte) iconId
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing icon: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -465,7 +465,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
             msg[1] = (byte) type;
             builder.write(ctrlCharacteristic, msg);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error showing notificaton: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -479,7 +479,7 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
                     TLW64Constants.NOTIFICATION_STOP
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("Unable to stop notification", e);
         }
@@ -491,13 +491,13 @@ public class TLW64Support extends AbstractBTLESingleDeviceSupport {
         firstTimestamp = 0;
         try {
             TransactionBuilder builder = performInitialized("fetchActivityData");
-            builder.setBusyTask(getDevice(), R.string.busy_task_fetch_activity_data, getContext());
+            builder.setBusyTask(R.string.busy_task_fetch_activity_data);
             byte[] msg = new byte[]{
                     type,
                     (byte) 0xfa
             };
             builder.write(ctrlCharacteristic, msg);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error fetching activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/ultrahuman/UltrahumanDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/ultrahuman/UltrahumanDeviceSupport.java
index 1273f395ef..d40d240511 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/ultrahuman/UltrahumanDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/ultrahuman/UltrahumanDeviceSupport.java
@@ -144,7 +144,7 @@ public class UltrahumanDeviceSupport extends AbstractBTLESingleDeviceSupport {
             getDevice().setFirmwareVersion2("N/A");
         }
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         if (!CommandReceiver.Registered) {
             IntentFilter exported = new IntentFilter();
@@ -182,7 +182,7 @@ public class UltrahumanDeviceSupport extends AbstractBTLESingleDeviceSupport {
         boolean powerSave = getDevicePrefs().getBoolean(DeviceSettingsPreferenceConst.PREF_POWER_SAVING, true);
         builder.add(new UHWrite(COMMAND, powerSave ? OPERATION_ENABLE_POWERSAVE : OPERATION_DISABLE_POWERSAVE));
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         return builder;
     }
@@ -661,7 +661,7 @@ public class UltrahumanDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     private void enqueue(final TransactionBuilder builder) {
         if (isConnected()) {
-            builder.queue(getQueue());
+            builder.queue();
         } else {
             GB.toast(getContext(), R.string.devicestatus_disconnected, Toast.LENGTH_LONG, GB.ERROR);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/um25/Support/UM25Support.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/um25/Support/UM25Support.java
index 148e203cc8..bb9564f614 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/um25/Support/UM25Support.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/um25/Support/UM25Support.java
@@ -45,7 +45,6 @@ import nodomain.freeyourgadget.gadgetbridge.R;
 import nodomain.freeyourgadget.gadgetbridge.activities.devicesettings.DeviceSettingsPreferenceConst;
 import nodomain.freeyourgadget.gadgetbridge.devices.um25.Activity.DataActivity;
 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.BtLEAction;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.um25.Data.CaptureGroup;
 import nodomain.freeyourgadget.gadgetbridge.service.devices.um25.Data.MeasurementData;
@@ -92,8 +91,8 @@ public class UM25Support extends UM25BaseSupport {
                 return;
             }
             createTransactionBuilder("reset stats")
-                    .write(getCharacteristic(UUID.fromString(UUID_CHAR)), COMMAND_RESET_STATS)
-                    .queue(getQueue());
+                    .write(UUID.fromString(UUID_CHAR), COMMAND_RESET_STATS)
+                    .queue();
         }
     };
 
@@ -116,8 +115,8 @@ public class UM25Support extends UM25BaseSupport {
         getDevice().setFirmwareVersion("1.0");
 
         return builder
-                .setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext())
-                .notify(getCharacteristic(UUID.fromString(UUID_CHAR)), true)
+                .setDeviceState(GBDevice.State.INITIALIZING)
+                .notify(UUID.fromString(UUID_CHAR), true)
                 .run(() -> {
                     logger.debug("initialized, starting timers");
                     LocalBroadcastManager.getInstance(getContext())
@@ -127,7 +126,7 @@ public class UM25Support extends UM25BaseSupport {
                             );
                     startLoop();
                 })
-                .setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+                .setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     @Override
@@ -154,8 +153,8 @@ public class UM25Support extends UM25BaseSupport {
         logger.debug("sending read command");
         buffer.reset();
         createTransactionBuilder("send read command")
-                .write(getCharacteristic(UUID.fromString(UUID_CHAR)), COMMAND_UPDATE)
-                .queue(getQueue());
+                .write(UUID.fromString(UUID_CHAR), COMMAND_UPDATE)
+                .queue();
         logger.debug("sent command");
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vesc/VescDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vesc/VescDeviceSupport.java
index fbf28ac934..791f545f44 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vesc/VescDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vesc/VescDeviceSupport.java
@@ -75,7 +75,7 @@ public class VescDeviceSupport extends VescBaseDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.debug("initializing device");
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         initBroadcast();
 
@@ -89,7 +89,7 @@ public class VescDeviceSupport extends VescBaseDeviceSupport {
 
         builder.notify(this.serialReadCharacteristic, true);
 
-        return builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        return builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
     @Override
@@ -290,7 +290,7 @@ public class VescDeviceSupport extends VescBaseDeviceSupport {
     public void queryPacket(byte[] data) {
         createTransactionBuilder("write serial packet")
                 .write(this.serialWriteCharacteristic, data)
-                .queue(getQueue());
+                .queue();
     }
 
     public byte[] buildPacket(CommandType commandType, Object... args) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vibratissimo/VibratissimoSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vibratissimo/VibratissimoSupport.java
index 437d5a1d41..99a55b3f62 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vibratissimo/VibratissimoSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/vibratissimo/VibratissimoSupport.java
@@ -78,7 +78,7 @@ public class VibratissimoSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         requestDeviceInfo(builder);
         setInitialized(builder);
         batteryInfoProfile.requestBatteryInfo(builder);
@@ -91,7 +91,7 @@ public class VibratissimoSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
     }
 
 
@@ -122,7 +122,7 @@ public class VibratissimoSupport extends AbstractBTLESingleDeviceSupport {
         builder.write(characteristic1, new byte[]{0x03, (byte) 0x80});
 
         builder.write(characteristic2, new byte[]{(byte) intensity, 0x00});
-        builder.queue(getQueue());
+        builder.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/waspos/WaspOSDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/waspos/WaspOSDeviceSupport.java
index e2e4f3f25d..1d36b5c4c8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/waspos/WaspOSDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/waspos/WaspOSDeviceSupport.java
@@ -70,7 +70,7 @@ public class WaspOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         LOG.info("Initializing");
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         rxCharacteristic = getCharacteristic(WaspOSConstants.UUID_CHARACTERISTIC_NORDIC_UART_RX);
         txCharacteristic = getCharacteristic(WaspOSConstants.UUID_CHARACTERISTIC_NORDIC_UART_TX);
@@ -86,7 +86,7 @@ public class WaspOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
         // get version
 
-        builder.setUpdateState(gbDevice, GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
         LOG.info("Initialization Done");
 
@@ -112,7 +112,7 @@ public class WaspOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized(taskName);
             uartTx(builder, "\u0010GB("+json.toString()+")\n");
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error in "+taskName+": " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -272,7 +272,7 @@ public class WaspOSDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("setTime");
             setTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             GB.toast(getContext(), "Error setting time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/Watch9DeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/Watch9DeviceSupport.java
index 27317d16c7..3f14b11b41 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/Watch9DeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/Watch9DeviceSupport.java
@@ -140,7 +140,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
             TransactionBuilder builder = performInitialized("showNotification");
             byte[] command = Watch9Constants.CMD_NOTIFICATION_TASK;
             command[1] = (byte) (isStopNotification ? 0x04 : 0x01);
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(command,
                             Watch9Constants.TASK,
                             Conversion.toByteArr32(notificationChannel)));
@@ -151,7 +151,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private Watch9DeviceSupport enableNotificationChannels(TransactionBuilder builder) {
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_NOTIFICATION_SETTINGS,
                         Watch9Constants.WRITE_VALUE,
                         new byte[]{(byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF}));
@@ -160,7 +160,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     public Watch9DeviceSupport authorizationRequest(TransactionBuilder builder, boolean firstConnect) {
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_AUTHORIZATION_TASK,
                         Watch9Constants.TASK,
                         new byte[]{(byte) (firstConnect ? 0x00 : 0x01)})); //possibly not the correct meaning
@@ -169,7 +169,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private Watch9DeviceSupport enableDoNotDisturb(TransactionBuilder builder, boolean active) {
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_DO_NOT_DISTURB_SETTINGS,
                         Watch9Constants.WRITE_VALUE,
                         new byte[]{(byte) (active ? 0x01 : 0x00)}));
@@ -180,7 +180,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void enableCalibration(boolean enable) {
         try {
             TransactionBuilder builder = performInitialized("enableCalibration");
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_CALIBRATION_INIT_TASK,
                             Watch9Constants.TASK,
                             new byte[]{(byte) (enable ? 0x01 : 0x00)}));
@@ -193,7 +193,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void holdCalibration() {
         try {
             TransactionBuilder builder = performInitialized("holdCalibration");
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_CALIBRATION_KEEP_ALIVE,
                             Watch9Constants.KEEP_ALIVE));
             performImmediately(builder);
@@ -207,7 +207,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
             isCalibrationActive = true;
             TransactionBuilder builder = performInitialized("calibrate");
             int handsPosition = ((hour % 12) * 60 + minute) * 60 + second;
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_CALIBRATION_TASK,
                             Watch9Constants.TASK,
                             Conversion.toByteArr16(handsPosition)));
@@ -221,7 +221,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void getTime() {
         try {
             TransactionBuilder builder = performInitialized("getTime");
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_TIME_SETTINGS,
                             Watch9Constants.READ_VALUE));
             performImmediately(builder);
@@ -265,7 +265,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
                     (byte) timezoneOffsetIndustrialMinutes,
                     (byte) (calendar.get(Calendar.DAY_OF_WEEK) - 1)
             };
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_TIME_SETTINGS,
                             Watch9Constants.WRITE_VALUE,
                             time));
@@ -276,7 +276,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     public Watch9DeviceSupport getFirmwareVersion(TransactionBuilder builder) {
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_FIRMWARE_INFO,
                         Watch9Constants.READ_VALUE));
 
@@ -284,7 +284,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     }
 
     private Watch9DeviceSupport getBatteryState(TransactionBuilder builder) {
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_BATTERY_INFO,
                         Watch9Constants.READ_VALUE));
 
@@ -293,7 +293,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     private Watch9DeviceSupport setFitnessGoal(TransactionBuilder builder) {
         int fitnessGoal = new ActivityUser().getStepsGoal();
-        builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+        builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                 buildCommand(Watch9Constants.CMD_FITNESS_GOAL_SETTINGS,
                         Watch9Constants.WRITE_VALUE,
                         Conversion.toByteArr16(fitnessGoal)));
@@ -307,7 +307,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
                 .enableNotificationChannels(builder)
                 .enableDoNotDisturb(builder, false)
                 .setFitnessGoal(builder);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         builder.setCallback(this);
 
         return this;
@@ -325,7 +325,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
             for (Alarm alarm : alarms) {
                 setAlarm(alarm, alarm.getPosition() + 1, builder);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("Unable to set alarms", e);
         }
@@ -335,7 +335,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
     private void deleteAlarm(TransactionBuilder builder, int index) {
         if (0 < index && index < 4) {
             byte[] alarmValue = new byte[]{(byte) index, 0x00, 0x00, 0x00, 0x00, 0x00};
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_ALARM_SETTINGS,
                             Watch9Constants.WRITE_VALUE,
                             alarmValue));
@@ -354,7 +354,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
                     (byte) (alarm.getEnabled() ? 0x01 : 0x00),
                     0x00 // TODO: Unknown
             };
-            builder.write(getCharacteristic(Watch9Constants.UUID_CHARACTERISTIC_WRITE),
+            builder.write(Watch9Constants.UUID_CHARACTERISTIC_WRITE,
                     buildCommand(Watch9Constants.CMD_ALARM_SETTINGS,
                             Watch9Constants.WRITE_VALUE,
                             alarmValue));
@@ -386,7 +386,7 @@ public class Watch9DeviceSupport extends AbstractBTLESingleDeviceSupport {
                     setFitnessGoal(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             LOG.warn("exception in onSendConfiguration", e);
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/operations/InitOperation.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/operations/InitOperation.java
index e786d0205a..6a37c24ee4 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/operations/InitOperation.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/watch9/operations/InitOperation.java
@@ -53,10 +53,10 @@ public class InitOperation extends AbstractBTLEOperation<Watch9DeviceSupport>{
     protected void doPerform() throws IOException {
         builder.notify(cmdCharacteristic, true);
         if (needsAuth) {
-            builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+            builder.setDeviceState(GBDevice.State.AUTHENTICATING);
             getSupport().authorizationRequest(builder, needsAuth);
         } else {
-            builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
             getSupport().initialize(builder);
             getSupport().performImmediately(builder);
         }
@@ -73,7 +73,7 @@ public class InitOperation extends AbstractBTLEOperation<Watch9DeviceSupport>{
                 if (ArrayUtils.equals(value, Watch9Constants.RESP_AUTHORIZATION_TASK, 5) && value[8] == 0x01) {
                     TransactionBuilder builder = getSupport().createTransactionBuilder("authInit");
                     builder.setCallback(this);
-                    builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+                    builder.setDeviceState(GBDevice.State.INITIALIZING);
                     getSupport().initialize(builder).performImmediately(builder);
                 } else {
                     return super.onCharacteristicChanged(gatt, characteristic, value);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/withingssteelhr/WithingsSteelHRDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/withingssteelhr/WithingsSteelHRDeviceSupport.java
index 49ff62effe..6f70957b33 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/withingssteelhr/WithingsSteelHRDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/withingssteelhr/WithingsSteelHRDeviceSupport.java
@@ -182,7 +182,7 @@ public class WithingsSteelHRDeviceSupport extends AbstractBTLESingleDeviceSuppor
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
         logger.debug("Starting initialization...");
         conversationQueue = new ConversationQueue(this);
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
         getDevice().setFirmwareVersion("N/A");
         getDevice().setFirmwareVersion2("N/A");
         BluetoothGattCharacteristic characteristic = getCharacteristic(WithingsUUID.WITHINGS_WRITE_CHARACTERISTIC_UUID);
@@ -433,7 +433,7 @@ public class WithingsSteelHRDeviceSupport extends AbstractBTLESingleDeviceSuppor
 
             byte[] rawData = message.getRawData();
             builder.writeChunkedData(characteristic, rawData, mtuSize - 4);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (Exception e) {
             logger.warn("Could not send message because of " + e.getMessage());
         }
@@ -466,8 +466,8 @@ public class WithingsSteelHRDeviceSupport extends AbstractBTLESingleDeviceSuppor
 
     public void finishInitialization() {
         TransactionBuilder builder = createTransactionBuilder("setupFinished");
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
-        builder.queue(getQueue());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
+        builder.queue();
         logger.debug("Finished initialization.");
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiBleSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiBleSupport.java
index 349d260eb0..b292d93d34 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiBleSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiBleSupport.java
@@ -109,7 +109,7 @@ public class XiaomiBleSupport extends XiaomiConnectionSupport {
             if (uuidSet == null) {
                 GB.toast(getContext(), "Failed to find known Xiaomi service", Toast.LENGTH_LONG, GB.ERROR);
                 LOG.warn("Failed to find known Xiaomi service");
-                builder.setUpdateState(getDevice(), GBDevice.State.NOT_CONNECTED, getContext());
+                builder.setDeviceState(GBDevice.State.NOT_CONNECTED);
                 return builder;
             }
 
@@ -122,7 +122,7 @@ public class XiaomiBleSupport extends XiaomiConnectionSupport {
 
             if (btCharacteristicCommandRead == null || btCharacteristicCommandWrite == null) {
                 LOG.warn("Characteristics are null, will attempt to reconnect");
-                builder.setUpdateState(getDevice(), GBDevice.State.WAITING_FOR_RECONNECT, getContext());
+                builder.setDeviceState(GBDevice.State.WAITING_FOR_RECONNECT);
                 return builder;
             }
 
@@ -151,12 +151,12 @@ public class XiaomiBleSupport extends XiaomiConnectionSupport {
 
             // request highest possible MTU; device should response with the highest supported MTU anyway
             builder.requestMtu(512);
-            builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
             builder.notify(btCharacteristicCommandWrite, true);
             builder.notify(btCharacteristicCommandRead, true);
             builder.notify(btCharacteristicActivityData, true);
             builder.notify(btCharacteristicDataUpload, true);
-            builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+            builder.setDeviceState(GBDevice.State.AUTHENTICATING);
 
             if (uuidSet.isEncrypted()) {
                 builder.run(() -> mXiaomiSupport.getAuthService().startEncryptedHandshake());
@@ -292,10 +292,9 @@ public class XiaomiBleSupport extends XiaomiConnectionSupport {
             builder.setProgress(
                     textRsrc,
                     ongoing,
-                    progressPercent,
-                    commsSupport.getContext()
+                    progressPercent
             );
-            builder.queue(commsSupport.getQueue());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to update progress notification", e);
         }
@@ -322,7 +321,7 @@ public class XiaomiBleSupport extends XiaomiConnectionSupport {
     public void runOnQueue(String taskName, Runnable runnable) {
         final TransactionBuilder b = commsSupport.createTransactionBuilder("run task " + taskName + " on queue");
         b.run(runnable);
-        b.queue(commsSupport.getQueue());
+        b.queue();
     }
 
     @Override
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiCharacteristic.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiCharacteristic.java
index 266cdc7a67..b980342cc5 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiCharacteristic.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiCharacteristic.java
@@ -40,7 +40,6 @@ import java.util.Queue;
 import java.util.UUID;
 
 import nodomain.freeyourgadget.gadgetbridge.service.btle.BLETypeConversions;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.BtLEQueue;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
 import nodomain.freeyourgadget.gadgetbridge.util.GB;
 
@@ -200,7 +199,7 @@ public class XiaomiCharacteristic {
         }
         final TransactionBuilder tb = mSupport.createTransactionBuilder(String.format("send nack with missing chunks %s", missingChunks));
         tb.write(bluetoothGattCharacteristic, bb.array());
-        tb.queue(mSupport.getQueue());
+        tb.queue();
     }
 
     private void cancelTimeoutTask() {
@@ -326,7 +325,7 @@ public class XiaomiCharacteristic {
                                 sendChunk(builder, i, chunkPayloadSize);
                             }
 
-                            builder.queue(mSupport.getQueue());
+                            builder.queue();
                             return;
                         }
                         case 2: {
@@ -467,7 +466,7 @@ public class XiaomiCharacteristic {
             final TransactionBuilder builder = b == null ? mSupport.createTransactionBuilder("send chunked start for " + currentPayload.getTaskName()) : b;
             builder.write(bluetoothGattCharacteristic, buf.array());
             if (b == null) {
-                builder.queue(mSupport.getQueue());
+                builder.queue();
             }
         } else {
             LOG.debug("Sending {} - single", currentPayload.getTaskName());
@@ -493,7 +492,7 @@ public class XiaomiCharacteristic {
             final TransactionBuilder builder = b == null ? mSupport.createTransactionBuilder("send single command for " + currentPayload.getTaskName()) : b;
             builder.write(bluetoothGattCharacteristic, buf.array());
             if (b == null) {
-                builder.queue(mSupport.getQueue());
+                builder.queue();
             }
         }
     }
@@ -511,19 +510,19 @@ public class XiaomiCharacteristic {
     private void sendAck() {
         final TransactionBuilder builder = mSupport.createTransactionBuilder("send ack");
         builder.write(bluetoothGattCharacteristic, PAYLOAD_ACK);
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     private void sendChunkStartAck() {
         final TransactionBuilder builder = mSupport.createTransactionBuilder("send chunked start ack");
         builder.write(bluetoothGattCharacteristic, new byte[]{0x00, 0x00, 0x01, 0x01});
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     private void sendChunkEndAck() {
         final TransactionBuilder builder = mSupport.createTransactionBuilder("send chunked end ack");
         builder.write(bluetoothGattCharacteristic, new byte[]{0x00, 0x00, 0x01, 0x00});
-        builder.queue(mSupport.getQueue());
+        builder.queue();
     }
 
     public void setMtu(final int newMtu) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppProtocolV2.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppProtocolV2.java
index dc471e9405..2a468d2339 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppProtocolV2.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppProtocolV2.java
@@ -49,7 +49,7 @@ public class XiaomiSppProtocolV2 extends AbstractXiaomiSppProtocol {
                 .setSequenceNumber(sequenceNumber)
                 .build()
                 .encode(null));
-        b.queue(support.commsSupport.getQueue());
+        b.queue();
     }
 
     @Override
@@ -138,7 +138,7 @@ public class XiaomiSppProtocolV2 extends AbstractXiaomiSppProtocol {
                 .setSequenceNumber(0)
                 .build()
                 .encode(null));
-        builder.queue(support.commsSupport.getQueue());
+        builder.queue();
         return false;
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppSupport.java
index 965b5597d3..2d32aed936 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xiaomi/XiaomiSppSupport.java
@@ -68,8 +68,8 @@ public class XiaomiSppSupport extends XiaomiConnectionSupport {
                         "N/A");
             }
 
-            builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
-            builder.setUpdateState(getDevice(), GBDevice.State.AUTHENTICATING, getContext());
+            builder.setDeviceState(GBDevice.State.INITIALIZING);
+            builder.setDeviceState(GBDevice.State.AUTHENTICATING);
             builder.write(XiaomiSppPacketV1.newBuilder()
                     .channel(Channel.Version)
                     .needsResponse(true)
@@ -135,10 +135,9 @@ public class XiaomiSppSupport extends XiaomiConnectionSupport {
             builder.setProgress(
                     textRsrc,
                     ongoing,
-                    progressPercent,
-                    commsSupport.getContext()
+                    progressPercent
             );
-            builder.queue(commsSupport.getQueue());
+            builder.queue();
         } catch (final Exception e) {
             LOG.error("Failed to update progress notification", e);
         }
@@ -153,7 +152,7 @@ public class XiaomiSppSupport extends XiaomiConnectionSupport {
 
         final TransactionBuilder b = commsSupport.createTransactionBuilder("run task " + taskName + " on queue");
         b.run(runnable);
-        b.queue(commsSupport.getQueue());
+        b.queue();
     }
 
     private void skipBuffer(int newStart) {
@@ -228,7 +227,7 @@ public class XiaomiSppSupport extends XiaomiConnectionSupport {
         try {
             final TransactionBuilder builder = this.commsSupport.createTransactionBuilder("send " + taskName);
             sendCommand(builder, command);
-            builder.queue(this.commsSupport.getQueue());
+            builder.queue();
         } catch (final Exception ex) {
             LOG.error("Caught unexpected exception while sending command, device may not have been informed!", ex);
         }
@@ -249,7 +248,7 @@ public class XiaomiSppSupport extends XiaomiConnectionSupport {
         LOG.debug("sendDataChunk(): encoded data chunk for task '{}': {}", taskName, GB.hexdump(chunk));
         this.commsSupport.createTransactionBuilder("send " + taskName)
             .write(mProtocol.encodePacket(Channel.Data, chunk))
-            .queue(commsSupport.getQueue());
+            .queue();
 
         if (callback != null) {
             // callback puts a SetProgressAction onto the queue
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xwatch/XWatchSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xwatch/XWatchSupport.java
index 80df374020..9f8ebf9595 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xwatch/XWatchSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/xwatch/XWatchSupport.java
@@ -85,7 +85,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), State.INITIALIZING, getContext());
+        builder.setDeviceState(State.INITIALIZING);
 
         enableNotifications(builder)
                 .setDateTime(builder)
@@ -102,7 +102,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
      * @param builder
      */
     private void setInitialized(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), State.INITIALIZED, getContext());
+        builder.setDeviceState(State.INITIALIZED);
     }
 
     @Override
@@ -177,7 +177,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
             BluetoothGattCharacteristic deviceData = getCharacteristic(XWatchService.UUID_WRITE);
             byte[] data = new byte[]{XWatchService.COMMAND_NOTIFICATION, XWatchService.COMMAND_NOTIFICATION_MESSAGE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
             builder.write(deviceData, crcChecksum(data));
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to send message notification on XWatch device", ex);
         }
@@ -193,7 +193,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("Set date and time");
             setDateTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException ex) {
             LOG.error("Unable to set time and date on XWatch device", ex);
         }
@@ -208,7 +208,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
                 BluetoothGattCharacteristic deviceData = getCharacteristic(XWatchService.UUID_WRITE);
                 byte[] data = new byte[]{XWatchService.COMMAND_NOTIFICATION, XWatchService.COMMAND_NOTIFICATION_PHONE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
                 builder.write(deviceData, crcChecksum(data));
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException ex) {
                 LOG.error("Unable to send call notification on XWatch device", ex);
             }
@@ -374,7 +374,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
                         try {
                             builder = performInitialized("fetchActivityData");
                             requestDetailedData(builder);
-                            builder.queue(getQueue());
+                            builder.queue();
                         } catch (IOException e) {
                             GB.toast(getContext(), "Error fetching activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
                         }
@@ -428,7 +428,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
                 (byte) 0};
 
         fetch = XWatchSupport.crcChecksum(fetch);
-        builder.write(getCharacteristic(XWatchService.UUID_WRITE), fetch);
+        builder.write(XWatchService.UUID_WRITE, fetch);
     }
 
     private void requestDetailedData(TransactionBuilder builder) {
@@ -449,7 +449,7 @@ public class XWatchSupport extends AbstractBTLESingleDeviceSupport {
                 (byte) 0};
 
         fetch = XWatchSupport.crcChecksum(fetch);
-        builder.write(getCharacteristic(XWatchService.UUID_WRITE), fetch);
+        builder.write(XWatchService.UUID_WRITE, fetch);
     }
 
     private int getTimestampFromData(byte year, byte month, byte day, byte hoursminutes) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/yawell/ring/YawellRingDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/yawell/ring/YawellRingDeviceSupport.java
index 70e24cf33d..4d9907a050 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/yawell/ring/YawellRingDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/yawell/ring/YawellRingDeviceSupport.java
@@ -150,17 +150,17 @@ public class YawellRingDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
     @Override
     protected TransactionBuilder initializeDevice(TransactionBuilder builder) {
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         if (getDevice().getFirmwareVersion() == null) {
             getDevice().setFirmwareVersion(getCachedFirmwareVersion() != null ? getCachedFirmwareVersion() : "N/A");
         }
         deviceInfoProfile.requestDeviceInfo(builder);
 
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
 
-        builder.notify(getCharacteristic(YawellRingConstants.CHARACTERISTIC_NOTIFY_V1), true);
-        builder.notify(getCharacteristic(YawellRingConstants.CHARACTERISTIC_NOTIFY_V2), true);
+        builder.notify(YawellRingConstants.CHARACTERISTIC_NOTIFY_V1, true);
+        builder.notify(YawellRingConstants.CHARACTERISTIC_NOTIFY_V2, true);
 
         // Delay initialization with 2 seconds to give the ring time to settle
         backgroundTasksHandler.removeCallbacksAndMessages(null);
@@ -468,7 +468,7 @@ public class YawellRingDeviceSupport extends AbstractBTLESingleDeviceSupport {
         BluetoothGattCharacteristic characteristic = getCharacteristic(YawellRingConstants.CHARACTERISTIC_WRITE);
         if (characteristic != null) {
             builder.write(characteristic, contents);
-            builder.queue(getQueue());
+            builder.queue();
         }
     }
 
@@ -477,7 +477,7 @@ public class YawellRingDeviceSupport extends AbstractBTLESingleDeviceSupport {
         BluetoothGattCharacteristic characteristic = getCharacteristic(YawellRingConstants.CHARACTERISTIC_COMMAND);
         if (characteristic != null) {
             builder.write(characteristic, contents);
-            builder.queue(getQueue());
+            builder.queue();
         }
     }
 
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/zetime/ZeTimeDeviceSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/zetime/ZeTimeDeviceSupport.java
index d196284087..ae6aa5477e 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/zetime/ZeTimeDeviceSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/zetime/ZeTimeDeviceSupport.java
@@ -66,7 +66,6 @@ import nodomain.freeyourgadget.gadgetbridge.model.Weather;
 import nodomain.freeyourgadget.gadgetbridge.model.WeatherSpec;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.GattService;
 import nodomain.freeyourgadget.gadgetbridge.service.btle.TransactionBuilder;
-import nodomain.freeyourgadget.gadgetbridge.service.btle.actions.WaitAction;
 import nodomain.freeyourgadget.gadgetbridge.util.AlarmUtils;
 import nodomain.freeyourgadget.gadgetbridge.util.GB;
 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;
@@ -122,7 +121,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         progressSteps = 0;
         progressSleep = 0;
         progressHeartRate = 0;
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZING, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZING);
 
         notifyCharacteristic = getCharacteristic(ZeTimeConstants.UUID_NOTIFY_CHARACTERISTIC);
         writeCharacteristic = getCharacteristic(ZeTimeConstants.UUID_WRITE_CHARACTERISTIC);
@@ -221,7 +220,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     setUserGoals(builder);
                     break;
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error sending configuration: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -241,7 +240,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     ZeTimeConstants.CMD_END
             };
             sendMsgToWatch(builder, testSignaling);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error on function onFindDevice: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -268,7 +267,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("enableAutoHeartRate");
             sendMsgToWatch(builder, heartrate);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error enable auto heart rate measurement: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -338,7 +337,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 }
                 sendMsgToWatch(builder, alarmMessage);
             }
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error set alarms: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -360,7 +359,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
             try {
                 TransactionBuilder builder = performInitialized("setMusicStateInfo");
                 replyMsgToWatch(builder, music);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 GB.toast(getContext(), "Error setting music state and info: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
             }
@@ -441,7 +440,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
             try {
                 TransactionBuilder builder = performInitialized("setCallState");
                 sendMsgToWatch(builder, notification);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 GB.toast(getContext(), "Error set call state: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
             }
@@ -454,7 +453,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("fetchActivityData");
             requestActivityInfo(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error on fetching activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -500,7 +499,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
             try {
                 TransactionBuilder builder = performInitialized("setMusicStateInfo");
                 replyMsgToWatch(builder, music);
-                builder.queue(getQueue());
+                builder.queue();
             } catch (IOException e) {
                 GB.toast(getContext(), "Error setting music state and info: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
             }
@@ -514,7 +513,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("sendCalendarEvent");
             sendMsgToWatch(builder, calendarEvent);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error sending calendar event: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -573,7 +572,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
 
             byte[] message = encodeCalendarEvent(body, calendarEvent.getBeginSeconds(), opcode);
             sendMsgToWatch(builder, message);
-            builder.add(new WaitAction(300)); // Urgh, seems it is a general problem when sending data too fast
+            builder.wait(300); // Urgh, seems it is a general problem when sending data too fast
 
             if (eventCount++ == 16) { // limit this to 16 for now
                 break;
@@ -586,7 +585,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("synchronizeTime");
             synchronizeTime(builder);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error setting the time: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -638,7 +637,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("sendWeahter");
             sendMsgToWatch(builder, weather);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error sending weather: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -787,7 +786,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         try {
             TransactionBuilder builder = performInitialized("sendNotification");
             sendMsgToWatch(builder, notification);
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error sending notification: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1012,7 +1011,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
         evaluateGBDeviceEvent(versionCmd);
 
         TransactionBuilder builder = createTransactionBuilder("setDeviceInitialized");
-        builder.setUpdateState(getDevice(), GBDevice.State.INITIALIZED, getContext());
+        builder.setDeviceState(GBDevice.State.INITIALIZED);
         try {
             performConnected(builder.getTransaction());
         } catch (IOException e) {
@@ -1049,7 +1048,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     ZeTimeConstants.CMD_END});
             builder.write(ackCharacteristic, new byte[]{ZeTimeConstants.CMD_ACK_WRITE});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error fetching activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1065,7 +1064,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     0x00,
                     ZeTimeConstants.CMD_END});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error deleting activity data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1082,7 +1081,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     ZeTimeConstants.CMD_END});
             builder.write(ackCharacteristic, new byte[]{ZeTimeConstants.CMD_ACK_WRITE});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error fetching heart rate data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1098,7 +1097,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     0x00,
                     ZeTimeConstants.CMD_END});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error deleting heart rate data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1116,7 +1115,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     ZeTimeConstants.CMD_END});
             builder.write(ackCharacteristic, new byte[]{ZeTimeConstants.CMD_ACK_WRITE});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error fetching sleep data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1132,7 +1131,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                     0x00,
                     0x00,
                     ZeTimeConstants.CMD_END});
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error deleting sleep data: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
@@ -1352,7 +1351,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                                 0x02,
                                 volume,
                                 ZeTimeConstants.CMD_END});
-                        builder.queue(getQueue());
+                        builder.queue();
                     } catch (IOException e) {
                         GB.toast(getContext(), "Error reply the music volume: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
                     }
@@ -1365,7 +1364,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
                 try {
                     TransactionBuilder builder = performInitialized("replyMusicState");
                     replyMsgToWatch(builder, music);
-                    builder.queue(getQueue());
+                    builder.queue();
                 } catch (IOException e) {
                     GB.toast(getContext(), "Error reply the music state: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
                 }
@@ -1959,7 +1958,7 @@ public class ZeTimeDeviceSupport extends AbstractBTLESingleDeviceSupport {
             configRead12[1] = ZeTimeConstants.CMD_SWITCH_SETTINGS;
             sendMsgToWatch(builder, configRead12);
 
-            builder.queue(getQueue());
+            builder.queue();
         } catch (IOException e) {
             GB.toast(getContext(), "Error reading configuration: " + e.getLocalizedMessage(), Toast.LENGTH_LONG, GB.ERROR);
         }
```
-----------------------------------
