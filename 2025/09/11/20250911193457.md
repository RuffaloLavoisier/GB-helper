# Commit: 4b40268b204e75dedfbb18f527603eba63e684aa
## Message: Display device type name during discovery
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/discovery/GBScanEventProcessor.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/adapter/DeviceCandidateAdapter.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DeviceHelper.java

app/src/main/res/layout/item_with_details.xml

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/discovery/GBScanEventProcessor.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/discovery/GBScanEventProcessor.java
index b275a90b6e..89405416ae 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/discovery/GBScanEventProcessor.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/discovery/GBScanEventProcessor.java
@@ -170,7 +170,7 @@ public final class GBScanEventProcessor implements Runnable {
             final ParcelUuid[] uuids = candidate.getServiceUuids();
             if (uuids != null && uuids.length > 0) {
                 for (ParcelUuid uuid : uuids) {
-                    LOG.debug("  supports uuid: " + uuid.toString());
+                    LOG.debug("  supports uuid: {}", uuid.toString());
                 }
             }
         }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/adapter/DeviceCandidateAdapter.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/adapter/DeviceCandidateAdapter.java
index df7b7846e1..13b48fcee8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/adapter/DeviceCandidateAdapter.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/adapter/DeviceCandidateAdapter.java
@@ -17,6 +17,7 @@
     along with this program.  If not, see <https://www.gnu.org/licenses/>. */
 package nodomain.freeyourgadget.gadgetbridge.adapter;
 
+import android.annotation.SuppressLint;
 import android.content.Context;
 import android.text.TextUtils;
 import android.view.LayoutInflater;
@@ -26,6 +27,8 @@ import android.widget.ArrayAdapter;
 import android.widget.ImageView;
 import android.widget.TextView;
 
+import androidx.annotation.NonNull;
+
 import java.util.ArrayList;
 import java.util.List;
 
@@ -41,34 +44,39 @@ import nodomain.freeyourgadget.gadgetbridge.util.GB;
  * Adapter for displaying GBDeviceCandate instances.
  */
 public class DeviceCandidateAdapter extends ArrayAdapter<GBDeviceCandidate> {
-
-    private final Context context;
-
-    public DeviceCandidateAdapter(Context context, List<GBDeviceCandidate> deviceCandidates) {
+    public DeviceCandidateAdapter(final Context context, final List<GBDeviceCandidate> deviceCandidates) {
         super(context, 0, deviceCandidates);
-
-        this.context = context;
     }
 
+    @SuppressLint("SetTextI18n")
+    @NonNull
     @Override
-    public View getView(int position, View view, ViewGroup parent) {
-        GBDeviceCandidate device = getItem(position);
+    public View getView(int position, View view, @NonNull final ViewGroup parent) {
+        final GBDeviceCandidate device = getItem(position);
         if (view == null) {
-            LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
+            LayoutInflater inflater = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
             view = inflater.inflate(R.layout.item_with_details, parent, false);
         }
-        ImageView deviceImageView = view.findViewById(R.id.item_image);
-        TextView deviceNameLabel = view.findViewById(R.id.item_name);
-        TextView deviceAddressLabel = view.findViewById(R.id.item_details);
-        TextView deviceStatus = view.findViewById(R.id.item_status);
+        final ImageView deviceImageView = view.findViewById(R.id.item_image);
+        final TextView deviceNameLabel = view.findViewById(R.id.item_name);
+        final TextView deviceDetailsLabel = view.findViewById(R.id.item_details);
+        final TextView deviceStatus = view.findViewById(R.id.item_status);
 
-        DeviceType deviceType = DeviceHelper.getInstance().resolveDeviceType(device);
+        if (device == null) {
+            // Should never happen?
+            deviceNameLabel.setText("(null)");
+            deviceDetailsLabel.setText("(null)");
+            deviceImageView.setImageResource(R.drawable.ic_device_unknown);
+            deviceStatus.setText("");
+            return view;
+        }
 
-        DeviceCoordinator coordinator = deviceType.getDeviceCoordinator();
+        final DeviceType deviceType = DeviceHelper.getInstance().resolveDeviceType(device);
+        final DeviceCoordinator coordinator = deviceType.getDeviceCoordinator();
 
-        String name = formatDeviceCandidate(device);
+        final String name = formatDeviceName(device);
         deviceNameLabel.setText(name);
-        deviceAddressLabel.setText(device.getMacAddress());
+        deviceDetailsLabel.setText(getContext().getString(coordinator.getDeviceNameResource()) + "\n" + device.getMacAddress());
         deviceImageView.setImageResource(coordinator.getDefaultIconResource());
 
         final List<String> statusLines = new ArrayList<>();
@@ -88,9 +96,9 @@ public class DeviceCandidateAdapter extends ArrayAdapter<GBDeviceCandidate> {
         return view;
     }
 
-    private String formatDeviceCandidate(GBDeviceCandidate device) {
+    private String formatDeviceName(final GBDeviceCandidate device) {
         if (device.getRssi() > GBDevice.RSSI_UNKNOWN) {
-            return context.getString(R.string.device_with_rssi, device.getName(), GB.formatRssi(device.getRssi()));
+            return getContext().getString(R.string.device_with_rssi, device.getName(), GB.formatRssi(device.getRssi()));
         }
         return device.getName();
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DeviceHelper.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DeviceHelper.java
index e860cad10a..381c32a31c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DeviceHelper.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DeviceHelper.java
@@ -31,6 +31,7 @@ import android.bluetooth.BluetoothDevice;
 import android.content.Context;
 import android.widget.Toast;
 
+import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
 import org.slf4j.Logger;
@@ -123,11 +124,11 @@ public class DeviceHelper {
 
         return orderedDeviceTypes;
     }
-    public DeviceType resolveDeviceType(GBDeviceCandidate deviceCandidate) {
+    public DeviceType resolveDeviceType(@NonNull final GBDeviceCandidate deviceCandidate) {
         return resolveDeviceType(deviceCandidate, true);
     }
 
-    public DeviceType resolveDeviceType(GBDeviceCandidate deviceCandidate, boolean useCache){
+    public DeviceType resolveDeviceType(@NonNull final GBDeviceCandidate deviceCandidate, boolean useCache){
         final DeviceType forcedType = deviceCandidate.getForcedType();
         if (forcedType != null) {
             return forcedType;
diff --git a/app/src/main/res/layout/item_with_details.xml b/app/src/main/res/layout/item_with_details.xml
index 213dbb2498..6aba6efe7e 100644
--- a/app/src/main/res/layout/item_with_details.xml
+++ b/app/src/main/res/layout/item_with_details.xml
@@ -1,8 +1,11 @@
 <?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
-    android:background="?android:attr/activatedBackgroundIndicator">
+    android:background="?android:attr/activatedBackgroundIndicator"
+    android:paddingTop="4dp"
+    android:paddingBottom="4dp">
 
     <ImageView
         android:id="@+id/item_preview"
@@ -15,18 +18,18 @@
 
     <ImageView
         android:id="@+id/item_image"
-        android:layout_width="56dp"
-        android:layout_height="56dp"
+        android:layout_width="60dp"
+        android:layout_height="60dp"
         android:layout_below="@+id/item_preview"
         android:contentDescription="@string/candidate_item_device_image"
-        android:padding="8dp" />
+        android:padding="4dp" />
 
     <LinearLayout
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
+        android:layout_below="@+id/item_preview"
         android:layout_centerVertical="true"
         android:layout_toEndOf="@+id/item_image"
-        android:layout_below="@+id/item_preview"
         android:orientation="vertical"
         android:paddingStart="8dp"
         android:paddingEnd="8dp">
@@ -37,8 +40,8 @@
             android:layout_height="wrap_content"
             android:maxLines="1"
             android:scrollHorizontally="false"
-            android:text="Item Name"
-            android:textStyle="bold" />
+            android:textStyle="bold"
+            tools:text="Item Name" />
 
         <LinearLayout
             android:layout_width="match_parent"
@@ -51,7 +54,7 @@
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:gravity="start"
-                android:text="Item Description" />
+                tools:text="Item Description" />
 
             <TextView
                 android:id="@+id/item_status"
```
-----------------------------------
