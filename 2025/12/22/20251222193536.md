# Commit: 4eba10858c8baf124bb8849c907f95566ece3eb9
## Message: Garmin: Register FitLocalMessageHandler on incoming FitDefinitionMessage

Also log the incoming FitDataMessage once it's parsed, without any further processing.
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/FitLocalMessageHandler.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/FitLocalMessageHandler.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/FitLocalMessageHandler.java
index 4df55b52e6..7a60ff2f52 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/FitLocalMessageHandler.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/FitLocalMessageHandler.java
@@ -43,6 +43,15 @@ public class FitLocalMessageHandler implements MessageHandler{
         return new FitDataMessage(this.recordDataList);
     }
 
+    private void parseIncomingFitDataMessage(FitDataMessage incoming) {
+        recordDataList = (incoming).applyDefinitions(recordDefinitionList);
+        for(RecordData d: recordDataList){
+            LOG.info("Incoming FitDataMessage: {}", d);
+        }
+        LOG.info("Incoming FitDataMessages are not processed any further, just logged.");
+        unregisterSelf();
+    }
+
     private void unregisterSelf() {
         deviceSupport.unregisterHandler(this);
     }
@@ -54,8 +63,7 @@ public class FitLocalMessageHandler implements MessageHandler{
         else if (message instanceof FitDataStatusMessage) {
             unregisterSelf();
         } else if (message instanceof  FitDataMessage) {
-            recordDataList = ((FitDataMessage) message).applyDefinitions(recordDefinitionList);
-            //TODO: do something
+            parseIncomingFitDataMessage((FitDataMessage) message);
         }
         return null;
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
index bdd6219824..bd2418913c 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/GarminSupport.java
@@ -448,9 +448,8 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
 
             currentlyDownloading = null;
         } else if (deviceEvent instanceof IncomingFitDefinitionDeviceEvent) {
-            //TODO: commented for now to avoid leaking
-//            final FitLocalMessageHandler fitLocalMessageHandler = new FitLocalMessageHandler(this, ((IncomingFitDefinitionDeviceEvent) deviceEvent).getRecordDefinitions());
-//            messageHandlers.add(fitLocalMessageHandler);
+            final FitLocalMessageHandler fitLocalMessageHandler = new FitLocalMessageHandler(this, ((IncomingFitDefinitionDeviceEvent) deviceEvent).getRecordDefinitions());
+            messageHandlers.add(fitLocalMessageHandler);
         } else {
             super.evaluateGBDeviceEvent(deviceEvent);
         }
@@ -611,9 +610,9 @@ public class GarminSupport extends AbstractBTLESingleDeviceSupport implements IC
         sendOutgoingMessage("send " + weatherLocalMessage.getDefinitions().size() + " weather definitions", weatherHandler.init());
     }
 
-    protected void unregisterHandler(MessageHandler registered) {
+    protected void unregisterHandler(final MessageHandler registered) {
         messageHandlers.remove(registered);
-        LOG.warn("handlers left: {}", messageHandlers.stream().count());
+        LOG.debug("{} handler removed, handlers left: {}", registered.getClass().getSimpleName(), messageHandlers.stream().count());
     }
 
     public static FitLocalMessageBuilder encodeWeather(final WeatherSpec weather) {
```
-----------------------------------
