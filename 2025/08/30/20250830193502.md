# Commit: 0e78261c5aa7583b3b0d7e9b7eca11ab020ff09e
## Message: Workout details: Add cadence chart
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/charts/DefaultWorkoutCharts.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java

app/src/main/res/values/strings.xml

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/charts/DefaultWorkoutCharts.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/charts/DefaultWorkoutCharts.java
index 7a39645ed8..aa620fcf44 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/charts/DefaultWorkoutCharts.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/charts/DefaultWorkoutCharts.java
@@ -7,7 +7,6 @@ import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_SECONDS_PER_KM;
 
 import android.content.Context;
-import android.graphics.Color;
 
 import com.github.mikephil.charting.components.YAxis;
 import com.github.mikephil.charting.data.Entry;
@@ -33,12 +32,15 @@ public class DefaultWorkoutCharts {
     public static List<WorkoutChart> buildDefaultCharts(final Context context,
                                                         final List<ActivityPoint> activityPoints,
                                                         final ActivityKind activityKind) {
+        final ActivityKind.CycleUnit cycleUnit = ActivityKind.getCycleUnit(activityKind);
         final List<WorkoutChart> charts = new LinkedList<>();
         final TimestampTranslation tsTranslation = new TimestampTranslation();
         final List<Entry> heartRateDataPoints = new ArrayList<>();
         final List<Entry> speedDataPoints = new ArrayList<>();
+        final List<Entry> cadenceDataPoints = new ArrayList<>();
         final List<Entry> elevationDataPoints = new ArrayList<>();
         boolean hasSpeedValues = false;
+        boolean hasCadenceValues = false;
 
         for (int i = 0; i <= activityPoints.size() - 1; i++) {
             final ActivityPoint point = activityPoints.get(i);
@@ -53,6 +55,10 @@ public class DefaultWorkoutCharts {
             if (!hasSpeedValues && point.getSpeed() > 0) {
                 hasSpeedValues = true;
             }
+            cadenceDataPoints.add(new Entry(tsShorten, point.getCadence()));
+            if (!hasCadenceValues && point.getCadence() > 0) {
+                hasCadenceValues = true;
+            }
         }
 
         if (!heartRateDataPoints.isEmpty()) {
@@ -79,6 +85,18 @@ public class DefaultWorkoutCharts {
             }
         }
 
+        if (hasCadenceValues && !cadenceDataPoints.isEmpty()) {
+            final String label = String.format("%s (%s)", context.getString(R.string.workout_cadence), getUnitString(context, getCadenceUnit(cycleUnit)));
+            final LineDataSet dataset = createDataSet(context, cadenceDataPoints, label, context.getResources().getColor(R.color.chart_line_speed));
+            final ValueFormatter integerFormatter = new ValueFormatter() {
+                @Override
+                public String getFormattedValue(float value) {
+                    return String.valueOf((int) value);
+                }
+            };
+            charts.add(new WorkoutChart("cadence", context.getString(R.string.workout_cadence), ActivitySummaryEntries.GROUP_CADENCE, new LineData(dataset), integerFormatter));
+        }
+
         if (!elevationDataPoints.isEmpty()) {
             final String label = String.format("%s (%s)", context.getString(R.string.Elevation), getUnitString(context, UNIT_METERS));
             LineDataSet dataset = createDataSet(context, elevationDataPoints, label, context.getResources().getColor(R.color.chart_line_elevation));
@@ -113,4 +131,14 @@ public class DefaultWorkoutCharts {
         dataSet.setDrawHorizontalHighlightIndicator(false);
         return dataSet;
     }
+
+    public static String getCadenceUnit(final ActivityKind.CycleUnit unit) {
+        return switch (unit) {
+            case STROKES -> ActivitySummaryEntries.UNIT_STROKES_PER_MINUTE;
+            case JUMPS -> ActivitySummaryEntries.UNIT_JUMPS_PER_MINUTE;
+            case REPS -> ActivitySummaryEntries.UNIT_REPS_PER_MINUTE;
+            case REVOLUTIONS -> ActivitySummaryEntries.UNIT_REVS_PER_MINUTE;
+            default -> ActivitySummaryEntries.UNIT_SPM;
+        };
+    }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
index 0dbf55f43c..945e89ab8b 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
@@ -108,6 +108,15 @@ object ActivitySummaryGroup {
                 )
             )
 
+            // Cadence
+            put(
+                ActivitySummaryEntries.GROUP_CADENCE, listOf<String>(
+                    ActivitySummaryEntries.CADENCE_AVG,
+                    ActivitySummaryEntries.CADENCE_MAX,
+                    ActivitySummaryEntries.CADENCE_MIN,
+                )
+            )
+
             // Elevation
             put(
                 ActivitySummaryEntries.GROUP_ELEVATION, listOf<String>(
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
index 49d66a24f0..c484c785e8 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
@@ -227,6 +227,7 @@ public class ActivitySummaryEntries {
     public static final String GROUP_PACE = "Pace";
     public static final String GROUP_ACTIVITY = "Activity";
     public static final String GROUP_SPEED = "Speed";
+    public static final String GROUP_CADENCE = "workout_cadence";
     public static final String GROUP_ELEVATION = "Elevation";
     public static final String GROUP_POWER = "workout_power";
     public static final String GROUP_HEART_RATE = "heart_rate";
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index c70bbf1e32..82828831bc 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -2496,6 +2496,7 @@
     <string name="distanceMeters">Distance</string>
     <string name="poolLength">Pool length</string>
     <string name="swim_avg_cadence">Avg Swim Cadence</string>
+    <string name="workout_cadence">Cadence</string>
     <string name="strokes_per_length">strokes/length</string>
     <string name="ascentMeters">Uphill</string>
     <string name="descentMeters">Downhill</string>
```
-----------------------------------
