# Commit: b297264b56b3772fcbdb84377e7ad9560c5ac4d4
## Message: Workout details: support display of values multiple times, add other category
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryEntry.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummarySimpleEntry.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java

app/src/main/res/values/strings.xml

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryEntry.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryEntry.java
index 1c64c845a8..f678c954b1 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryEntry.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryEntry.java
@@ -5,9 +5,11 @@ import android.widget.LinearLayout;
 import nodomain.freeyourgadget.gadgetbridge.activities.workouts.WorkoutValueFormatter;
 
 public abstract class ActivitySummaryEntry {
-    private final String group;
+    private String group;
 
-    public ActivitySummaryEntry(final String group) {
+    protected int columnSpan;
+
+    public ActivitySummaryEntry(String group) {
         this.group = group;
     }
 
@@ -15,7 +17,17 @@ public abstract class ActivitySummaryEntry {
         return group;
     }
 
-    public abstract int getColumnSpan();
+    public void setGroup(String group) {
+        this.group = group;
+    }
+
+    public int getColumnSpan() {
+        return columnSpan;
+    }
+
+    public void setColumnSpan(int columnSpan) {
+        this.columnSpan = columnSpan;
+    }
 
     public abstract void populate(final String key,
                                   final LinearLayout linearLayout,
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
index f5be0de5b1..ded1f98070 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummaryGroup.kt
@@ -16,11 +16,17 @@ object ActivitySummaryGroup {
             .forEach { key ->
                 val item = activitySummaryData[key]
                 // Use the group if specified in the entry, otherwise fallback to the default mapping from getDefaultGroup
-                val groupName = item.group ?: getDefaultGroup(key)
+                val groups: List<String> = item.group?.let { listOf(it) } ?: getDefaultGroups(key)
 
-                // If the group is not defined the default groups, it will be added to the end
-                val group = activeGroups.getOrPut(groupName) { mutableListOf() }
-                group.add(Pair.of<String, ActivitySummaryEntry>(key, item))
+                for (groupName in groups) {
+                    if (groupName == ActivitySummaryEntries.GROUP_OTHER) {
+                        item.columnSpan = 2;
+                    }
+
+                    // If the group is not defined the default groups, it will be added to the end
+                    val group = activeGroups.getOrPut(groupName) { mutableListOf() }
+                    group.add(Pair.of<String, ActivitySummaryEntry>(key, item))
+                }
             }
 
         // activeGroups is already ordered, discard empty ones
@@ -30,11 +36,11 @@ object ActivitySummaryGroup {
     /**
      * Find the default group key for a given entry. Defaults to Activity if not found.
      */
-    private fun getDefaultGroup(searchItem: String): String {
+    private fun getDefaultGroups(searchItem: String): List<String> {
         return DEFAULT_GROUPS.entries
-            .firstOrNull { (_, items) -> items.contains(searchItem) }
-            ?.key
-            ?: ActivitySummaryEntries.GROUP_ACTIVITY
+            .filter { (_, items) -> items.contains(searchItem) }
+            .map { (key, _) -> key }
+            .ifEmpty { listOf(ActivitySummaryEntries.GROUP_OTHER) }
     }
 
     /**
@@ -46,24 +52,50 @@ object ActivitySummaryGroup {
             // be shown.
             put(
                 ActivitySummaryEntries.GROUP_ACTIVITY, listOf<String>(
-                    ActivitySummaryEntries.DISTANCE_METERS,
-                    ActivitySummaryEntries.STEPS,
-                    ActivitySummaryEntries.STEP_RATE_SUM,
                     ActivitySummaryEntries.ACTIVE_SECONDS,
+                    ActivitySummaryEntries.DISTANCE_METERS,
                     ActivitySummaryEntries.CALORIES_BURNT,
+                    ActivitySummaryEntries.HR_AVG,
+                    ActivitySummaryEntries.STEPS,
                     ActivitySummaryEntries.STRIDE_TOTAL,
+                    ActivitySummaryEntries.STEP_RATE_SUM,
+                    ActivitySummaryEntries.STANDING_TIME,
+                    ActivitySummaryEntries.STANDING_COUNT,
+                    ActivitySummaryEntries.PACE_AVG_SECONDS_KM,
+                    ActivitySummaryEntries.SPEED_AVG,
+                    ActivitySummaryEntries.SPEED_AVG,
+                    ActivitySummaryEntries.ELEVATION_GAIN,
+                    ActivitySummaryEntries.ASCENT_METERS,
+                )
+            )
+
+            // Sets
+            put(ActivitySummaryEntries.SETS, listOf<String>())
+
+            // Intervals
+            put(ActivitySummaryEntries.GROUP_INTERVALS, listOf<String>())
+
+            // Heart rate
+            put(
+                ActivitySummaryEntries.GROUP_HEART_RATE, listOf<String>(
                     ActivitySummaryEntries.HR_AVG,
                     ActivitySummaryEntries.HR_MAX,
                     ActivitySummaryEntries.HR_MIN,
-                    ActivitySummaryEntries.STRIDE_AVG,
-                    ActivitySummaryEntries.STRIDE_MAX,
-                    ActivitySummaryEntries.STRIDE_MIN,
-                    ActivitySummaryEntries.STEP_LENGTH_AVG,
-                    ActivitySummaryEntries.STANDING_TIME,
-                    ActivitySummaryEntries.STANDING_COUNT,
-                    ActivitySummaryEntries.AVG_POWER,
-                    ActivitySummaryEntries.MAX_POWER,
-                    ActivitySummaryEntries.NORMALIZED_POWER,
+                )
+            )
+
+            // Heart rate zones
+            put(
+                ActivitySummaryEntries.GROUP_HEART_RATE_ZONES, listOf<String>(
+                    ActivitySummaryEntries.HR_ZONE_NA,
+                    ActivitySummaryEntries.HR_ZONE_WARM_UP,
+                    ActivitySummaryEntries.HR_ZONE_FAT_BURN,
+                    ActivitySummaryEntries.HR_ZONE_EASY,
+                    ActivitySummaryEntries.HR_ZONE_AEROBIC,
+                    ActivitySummaryEntries.HR_ZONE_ANAEROBIC,
+                    ActivitySummaryEntries.HR_ZONE_THRESHOLD,
+                    ActivitySummaryEntries.HR_ZONE_EXTREME,
+                    ActivitySummaryEntries.HR_ZONE_MAXIMUM,
                 )
             )
 
@@ -107,6 +139,26 @@ object ActivitySummaryGroup {
                 )
             )
 
+            // Power
+            put(
+                ActivitySummaryEntries.GROUP_POWER, listOf<String>(
+                    ActivitySummaryEntries.CYCLING_POWER_AVERAGE,
+                    ActivitySummaryEntries.CYCLING_POWER_MIN,
+                    ActivitySummaryEntries.CYCLING_POWER_MAX,
+                    ActivitySummaryEntries.AVG_POWER,
+                    ActivitySummaryEntries.MAX_POWER,
+                    ActivitySummaryEntries.MAX_POWER_SEATING,
+                    ActivitySummaryEntries.MAX_POWER_STANDING,
+                    ActivitySummaryEntries.NORMALIZED_POWER,
+                    ActivitySummaryEntries.AVG_LEFT_POWER_PHASE,
+                    ActivitySummaryEntries.AVG_LEFT_POWER_PHASE_PEAK,
+                    ActivitySummaryEntries.AVG_RIGHT_POWER_PHASE,
+                    ActivitySummaryEntries.AVG_RIGHT_POWER_PHASE_PEAK,
+                    ActivitySummaryEntries.AVG_POWER_SEATING,
+                    ActivitySummaryEntries.AVG_POWER_STANDING,
+                )
+            )
+
             // Strokes
             put(
                 ActivitySummaryEntries.GROUP_STROKES, listOf<String>(
@@ -207,21 +259,6 @@ object ActivitySummaryGroup {
                 )
             )
 
-            // Heart rate zones
-            put(
-                ActivitySummaryEntries.GROUP_HEART_RATE_ZONES, listOf<String>(
-                    ActivitySummaryEntries.HR_ZONE_NA,
-                    ActivitySummaryEntries.HR_ZONE_WARM_UP,
-                    ActivitySummaryEntries.HR_ZONE_FAT_BURN,
-                    ActivitySummaryEntries.HR_ZONE_EASY,
-                    ActivitySummaryEntries.HR_ZONE_AEROBIC,
-                    ActivitySummaryEntries.HR_ZONE_ANAEROBIC,
-                    ActivitySummaryEntries.HR_ZONE_THRESHOLD,
-                    ActivitySummaryEntries.HR_ZONE_EXTREME,
-                    ActivitySummaryEntries.HR_ZONE_MAXIMUM,
-                )
-            )
-
             // Diving
             put(
                 ActivitySummaryEntries.GROUP_DIVING, listOf<String>(
@@ -236,8 +273,21 @@ object ActivitySummaryGroup {
                 )
             )
 
-            // Sets
-            put(ActivitySummaryEntries.SETS, listOf<String>())
+            // Other
+            put(
+                ActivitySummaryEntries.GROUP_OTHER, listOf<String>(
+                    ActivitySummaryEntries.RESPIRATION_AVG,
+                    ActivitySummaryEntries.RESPIRATION_MIN,
+                    ActivitySummaryEntries.RESPIRATION_MAX,
+                    ActivitySummaryEntries.ESTIMATED_SWEAT_LOSS,
+                    ActivitySummaryEntries.CALORIES_ACTIVE,
+                    ActivitySummaryEntries.CALORIES_RESTING,
+                    ActivitySummaryEntries.STRIDE_AVG,
+                    ActivitySummaryEntries.STRIDE_MAX,
+                    ActivitySummaryEntries.STRIDE_MIN,
+                    ActivitySummaryEntries.STEP_LENGTH_AVG,
+                )
+            )
         }
     }
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummarySimpleEntry.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummarySimpleEntry.java
index 13beb38c42..dc2c41d59a 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummarySimpleEntry.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/entries/ActivitySummarySimpleEntry.java
@@ -12,7 +12,6 @@ import nodomain.freeyourgadget.gadgetbridge.activities.workouts.WorkoutValueForm
 public class ActivitySummarySimpleEntry extends ActivitySummaryEntry {
     private final Object value;
     private final String unit;
-    private final int columnSpan;
 
     public ActivitySummarySimpleEntry(final Object value, final String unit) {
         this(null, value, unit);
@@ -37,11 +36,6 @@ public class ActivitySummarySimpleEntry extends ActivitySummaryEntry {
         return unit;
     }
 
-    @Override
-    public int getColumnSpan() {
-        return columnSpan;
-    }
-
     @Override
     public void populate(final String key, final LinearLayout linearLayout, final WorkoutValueFormatter workoutValueFormatter) {
         final Context context = linearLayout.getContext();
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
index 53c58fb362..e5b0746595 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
@@ -248,7 +248,7 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
             if (!heartRateDataPoints.isEmpty()) {
                 String label = String.format("%s(%s)", context.getString(R.string.heart_rate), getUnitString(UNIT_BPM));
                 LineDataSet dataset = createDataSet(heartRateDataPoints, label, Color.RED);
-                charts.add(new WorkoutChart(context.getString(R.string.heart_rate), ActivitySummaryEntries.GROUP_HEART_RATE_ZONES, new LineData(dataset)));
+                charts.add(new WorkoutChart(context.getString(R.string.heart_rate), ActivitySummaryEntries.GROUP_HEART_RATE, new LineData(dataset)));
             }
             if (hasSpeedValues && !speedDataPoints.isEmpty()) {
                 if (ActivityKind.isPaceActivity(activityKind)) {
@@ -494,7 +494,6 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
             }
         }
 
-        summaryData.add(TRAINING_LOAD, safeRound(session.getTrainingLoadPeak()), UNIT_NONE);
         summaryData.add(AVG_POWER, session.getAvgPower(), UNIT_WATT);
         summaryData.add(MAX_POWER, session.getMaxPower(), UNIT_WATT);
         summaryData.add(NORMALIZED_POWER, session.getNormalizedPower(), UNIT_WATT);
@@ -709,6 +708,7 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
                 summaryData.add(LACTATE_THRESHOLD_HR, physiologicalMetrics.getLactateThresholdHeartRate(), UNIT_BPM);
             }
         }
+        summaryData.add(TRAINING_LOAD, safeRound(session.getTrainingLoadPeak()), UNIT_NONE);
 
         if (diveSummary != null) {
             if (diveSummary.getAvgDepth() != null) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
index d2ac28d528..a2fc470262 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
@@ -227,6 +227,9 @@ public class ActivitySummaryEntries {
     public static final String GROUP_ACTIVITY = "Activity";
     public static final String GROUP_SPEED = "Speed";
     public static final String GROUP_ELEVATION = "Elevation";
+    public static final String GROUP_POWER = "Power";
+    public static final String GROUP_HEART_RATE = "HeartRate";
+    public static final String GROUP_OTHER = "Other";
     public static final String GROUP_HEART_RATE_ZONES = "HeartRateZones";
     public static final String GROUP_STROKES = "Strokes";
     public static final String GROUP_JUMPS = "Jumps";
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index 570ab98c21..a09e854b46 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -2713,10 +2713,13 @@
     <string name="Swimming">Swimming</string>
     <string name="Distance">Distance</string>
     <string name="Elevation">Elevation</string>
+    <string name="Power">Power</string>
+    <string name="HeartRate">Heart rate</string>
     <string name="Speed">Speed</string>
     <string name="Activity">Activity</string>
     <string name="Steps">Steps</string>
     <string name="RunningForm">Running Form</string>
+    <string name="Other">Other</string>
     <!-- Sports Activity Detail -->
     <string name="activity_detail_start_label">Start</string>
     <string name="activity_detail_end_label">End</string>
```
-----------------------------------
