# Commit: aa7b98cb8b32e1bb7d28080289b2849ea07f4f35
## Message: Dashboard: Fix exception when device has no SampleProvider

Unfortunately having supportsActivityTracking does not mean that devices
have a sample provider (eg. scales). We need to rework the capabilities
in the coordinators, but for now avoid the NPE when the sample provider
does not exist.
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DailyTotals.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DashboardUtils.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DailyTotals.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DailyTotals.java
index 367c8258f8..02f6ab96d6 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DailyTotals.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/DailyTotals.java
@@ -22,6 +22,7 @@ import org.slf4j.LoggerFactory;
 
 import java.io.Serializable;
 import java.util.Calendar;
+import java.util.Collections;
 import java.util.List;
 
 import nodomain.freeyourgadget.gadgetbridge.GBApplication;
@@ -196,12 +197,12 @@ public class DailyTotals implements Serializable {
 
     protected static List<? extends ActivitySample> getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {
         SampleProvider<? extends ActivitySample> provider = getProvider(db, device);
-        return provider.getAllActivitySamples(tsFrom, tsTo);
+        return provider != null ? provider.getAllActivitySamples(tsFrom, tsTo) : Collections.emptyList();
     }
 
     public static ActivitySample getFirstSample(DBHandler db, GBDevice device) {
         SampleProvider<? extends ActivitySample> provider = getProvider(db, device);
-        return provider.getFirstActivitySample();
+        return provider != null ? provider.getFirstActivitySample() : null;
     }
 
 }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DashboardUtils.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DashboardUtils.java
index 807b44f9b2..6a86f9bb8d 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DashboardUtils.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/util/DashboardUtils.java
@@ -20,6 +20,7 @@ import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import java.util.Calendar;
+import java.util.Collections;
 import java.util.Date;
 import java.util.GregorianCalendar;
 import java.util.List;
@@ -226,7 +227,7 @@ public class DashboardUtils {
 
     public static List<? extends ActivitySample> getAllSamples(DBHandler db, GBDevice device, DashboardFragment.DashboardData dashboardData) {
         SampleProvider<? extends ActivitySample> provider = getProvider(db, device);
-        return provider.getAllActivitySamples(dashboardData.timeFrom, dashboardData.timeTo);
+        return provider != null ? provider.getAllActivitySamples(dashboardData.timeFrom, dashboardData.timeTo) : Collections.emptyList();
     }
 
     protected static SampleProvider<? extends AbstractActivitySample> getProvider(DBHandler db, GBDevice device) {
```
-----------------------------------
