# Commit: 67613a321c5ad747db905f0d8b62fc9a3eedded5
## Message: Garmin: Fix activity samples off by 1 minute
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminActivitySampleProvider.java

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminActivitySampleProvider.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminActivitySampleProvider.java
index 390f541890..db5935e048 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminActivitySampleProvider.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminActivitySampleProvider.java
@@ -100,12 +100,18 @@ public class GarminActivitySampleProvider extends AbstractSampleProvider<GarminA
 
         final long nanoStart = System.nanoTime();
 
+        // Each Garmin sample contains the cumulative value measured up until that specific timestamp. For example the
+        // sample at midnight will actually contain the number of steps taken in the entire previous day.
+        // This goes against what Gb expects (each sample actually corresponds to the value at the end of the minute).
+        // Therefore, we fetch the data with an offset and then adjust by 1 minute
         final List<GarminActivitySample> samples = fillGaps(
-                super.getGBActivitySamples(timestamp_from, timestamp_to),
-                timestamp_from,
-                timestamp_to
+                super.getGBActivitySamples(timestamp_from + 60, timestamp_to + 60),
+                timestamp_from + 60,
+                timestamp_to + 60
         );
 
+        samples.forEach(s -> s.setTimestamp(s.getTimestamp() - 60));
+
         if (!samples.isEmpty()) {
             convertCumulativeSteps(samples, GarminActivitySampleDao.Properties.Steps);
         }
```
-----------------------------------
