# Commit: bbcd09dae1101379c86510091c41104ce3310b58
## Message: Garmin: Parse extended running and cycling workout data
## Changed files:
app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutValueFormatter.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryData.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryJsonSummary.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/GlobalFITMessage.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitRecord.java

app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitSession.java

app/src/main/res/values/strings.xml

## Diff:
```
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutValueFormatter.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutValueFormatter.java
index 42df33add..ad98858ca 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutValueFormatter.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/workouts/WorkoutValueFormatter.java
@@ -5,6 +5,7 @@ import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_KILOMETERS;
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_METERS;
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_METERS_PER_SECOND;
+import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_MM;
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_SECONDS_PER_KM;
 import static nodomain.freeyourgadget.gadgetbridge.model.ActivitySummaryEntries.UNIT_SECONDS_PER_M;
 
@@ -67,6 +68,17 @@ public class WorkoutValueFormatter {
 
         if (!show_raw_data) {
             //special casing here + imperial units handling
+
+            if (UNIT_MM.equals(unit)) {
+                if (value > 1000) {
+                    unit = UNIT_METERS;
+                    value /= 1000d;
+                } else if (value > 100) {
+                    unit = UNIT_CM;
+                    value /= 10d;
+                }
+            }
+
             switch (unit) {
                 case UNIT_KG:
                     if (units.equals(UNIT_IMPERIAL)) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
index 7802c65a9..f9d9eff2a 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/devices/garmin/GarminWorkoutParser.java
@@ -188,6 +188,7 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
                 summaryData.addTotal(session.getTotalCycles(), cycleUnit);
             }
         }
+        summaryData.add(STEP_LENGTH_AVG, session.getAvgStepLength(), UNIT_MM);
         if (session.getTotalCalories() != null) {
             summaryData.add(CALORIES_BURNT, session.getTotalCalories(), UNIT_KCAL);
         }
@@ -221,12 +222,12 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
         if (session.getAvgStress() != null) {
             summaryData.add(STRESS_AVG, session.getAvgStress(), UNIT_NONE);
         }
-        if (session.getAverageCadence() != null) {
+        if (session.getAvgCadence() != null) {
             if (cycleUnit == ActivityKind.CycleUnit.STEPS) {
-                summaryData.addCadenceAvg(session.getAverageCadence() * 2, cycleUnit);
+                summaryData.addCadenceAvg(session.getAvgCadence() * 2, cycleUnit);
             } else {
                 // FIXME some of the rest might also need adjusting...
-                summaryData.addCadenceAvg(session.getAverageCadence(), cycleUnit);
+                summaryData.addCadenceAvg(session.getAvgCadence(), cycleUnit);
             }
         }
         if (session.getMaxCadence() != null) {
@@ -263,6 +264,141 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
             }
         }
 
+        summaryData.add(TRAINING_LOAD, safeRound(session.getTrainingLoadPeak()), UNIT_NONE);
+        summaryData.add(AVG_POWER, session.getAvgPower(), UNIT_WATT);
+        summaryData.add(MAX_POWER, session.getMaxPower(), UNIT_WATT);
+        summaryData.add(NORMALIZED_POWER, session.getNormalizedPower(), UNIT_WATT);
+
+        if (session.getStandTime() != null) {
+            summaryData.add(STANDING_TIME, session.getStandTime() / 1000, UNIT_SECONDS);
+        }
+        summaryData.add(STANDING_COUNT, session.getStandCount(), UNIT_NONE);
+        summaryData.add(AVG_LEFT_PCO, session.getAvgLeftPco(), UNIT_MM);
+        summaryData.add(AVG_RIGHT_PCO, session.getAvgRightPco(), UNIT_MM);
+
+        summaryData.add(AVG_VERTICAL_OSCILLATION, session.getAvgVerticalOscillation(), UNIT_MM);
+        summaryData.add(AVG_GROUND_CONTACT_TIME, session.getAvgStanceTime(), UNIT_MILLISECONDS);
+        summaryData.add(AVG_VERTICAL_RATIO, session.getAvgVerticalRatio(), UNIT_PERCENTAGE);
+        summaryData.add(AVG_GROUND_CONTACT_TIME_BALANCE, session.getAvgStanceTimeBalance(), UNIT_PERCENTAGE);
+
+        final Number[] avgLeftPowerPhase = session.getAvgLeftPowerPhase();
+        if (avgLeftPowerPhase != null && avgLeftPowerPhase.length == 4) {
+            final Number startAngle = avgLeftPowerPhase[0];
+            final Number endAngle = avgLeftPowerPhase[1];
+            if (startAngle != null && endAngle != null) {
+                summaryData.add(
+                        AVG_LEFT_POWER_PHASE,
+                        context.getString(
+                                R.string.range_degrees,
+                                Math.round(startAngle.floatValue() / 0.7111111),
+                                Math.round(endAngle.floatValue() / 0.7111111)
+                        )
+                );
+            }
+        }
+
+        final Number[] avgRightPowerPhase = session.getAvgRightPowerPhase();
+        if (avgRightPowerPhase != null && avgRightPowerPhase.length == 4) {
+            final Number startAngle = avgRightPowerPhase[0];
+            final Number endAngle = avgRightPowerPhase[1];
+            if (startAngle != null && endAngle != null) {
+                summaryData.add(
+                        AVG_RIGHT_POWER_PHASE,
+                        context.getString(
+                                R.string.range_degrees,
+                                Math.round(startAngle.floatValue() / 0.7111111),
+                                Math.round(endAngle.floatValue() / 0.7111111)
+                        )
+                );
+            }
+        }
+
+        final Number[] avgLeftPowerPhasePeak = session.getAvgLeftPowerPhasePeak();
+        if (avgLeftPowerPhasePeak != null && avgLeftPowerPhasePeak.length == 4) {
+            final Number startAngle = avgLeftPowerPhasePeak[0];
+            final Number endAngle = avgLeftPowerPhasePeak[1];
+            if (startAngle != null && endAngle != null) {
+                summaryData.add(
+                        AVG_LEFT_POWER_PHASE_PEAK,
+                        context.getString(
+                                R.string.range_degrees,
+                                Math.round(startAngle.floatValue() / 0.7111111),
+                                Math.round(endAngle.floatValue() / 0.7111111)
+                        )
+                );
+            }
+        }
+
+        final Number[] avgRightPowerPhasePeak = session.getAvgRightPowerPhasePeak();
+        if (avgRightPowerPhasePeak != null && avgRightPowerPhasePeak.length == 4) {
+            final Number startAngle = avgRightPowerPhasePeak[0];
+            final Number endAngle = avgRightPowerPhasePeak[1];
+            if (startAngle != null && endAngle != null) {
+                summaryData.add(
+                        AVG_RIGHT_POWER_PHASE_PEAK,
+                        context.getString(
+                                R.string.range_degrees,
+                                Math.round(startAngle.floatValue() / 0.7111111),
+                                Math.round(endAngle.floatValue() / 0.7111111)
+                        )
+                );
+            }
+        }
+
+        final Number[] avgPowerPosition = session.getAvgPowerPosition();
+        if (avgPowerPosition != null && avgPowerPosition.length == 2) {
+            summaryData.add(AVG_POWER_SEATING, avgPowerPosition[0], UNIT_WATT);
+            summaryData.add(AVG_POWER_STANDING, avgPowerPosition[1], UNIT_WATT);
+        }
+
+        final Number[] maxPowerPosition = session.getMaxPowerPosition();
+        if (maxPowerPosition != null && maxPowerPosition.length == 2) {
+            summaryData.add(MAX_POWER_SEATING, maxPowerPosition[0], UNIT_WATT);
+            summaryData.add(MAX_POWER_STANDING, maxPowerPosition[1], UNIT_WATT);
+        }
+
+        final Number[] avgCadencePosition = session.getAvgCadencePosition();
+        if (avgCadencePosition != null && avgCadencePosition.length == 2) {
+            summaryData.add(AVG_CADENCE_SEATING, avgCadencePosition[0], UNIT_RPM);
+            summaryData.add(AVG_CADENCE_STANDING, avgCadencePosition[1], UNIT_RPM);
+        }
+
+        final Number[] maxCadencePosition = session.getMaxCadencePosition();
+        if (maxCadencePosition != null && maxCadencePosition.length == 2) {
+            summaryData.add(MAX_CADENCE_SEATING, maxCadencePosition[0], UNIT_RPM);
+            summaryData.add(MAX_CADENCE_STANDING, maxCadencePosition[1], UNIT_RPM);
+        }
+
+        summaryData.add(FRONT_GEAR_SHIFTS, session.getFrontShifts(), UNIT_NONE);
+        summaryData.add(REAR_GEAR_SHIFTS, session.getRearShifts(), UNIT_NONE);
+
+        final Integer balance = session.getLeftRightBalance();
+        if (balance != null) {
+            summaryData.add(
+                    LEFT_RIGHT_BALANCE,
+                    (balance & 0x3fff) / 100f,
+                    UNIT_PERCENTAGE
+            );
+        }
+
+        final Float avgLeftPedalSmoothness = session.getAvgLeftPedalSmoothness();
+        final Float avgRightPedalSmoothness = session.getAvgRightPedalSmoothness();
+        if (avgLeftPedalSmoothness != null && avgRightPedalSmoothness != null) {
+            summaryData.add(
+                    AVG_PEDAL_SMOOTHNESS,
+                    context.getString(R.string.range_percentage, Math.round(avgLeftPedalSmoothness), Math.round(avgRightPedalSmoothness))
+            );
+        }
+
+        final Float avgLeftTorqueEffectiveness = session.getAvgLeftTorqueEffectiveness();
+        final Float avgRightTorqueEffectiveness = session.getAvgRightTorqueEffectiveness();
+        if (avgLeftTorqueEffectiveness != null && avgRightTorqueEffectiveness != null) {
+            summaryData.add(
+                    AVG_TORQUE_EFFECTIVENESS,
+                    context.getString(R.string.range_percentage, Math.round(avgLeftTorqueEffectiveness), Math.round(avgRightTorqueEffectiveness))
+            );
+        }
+
         for (final FitTimeInZone fitTimeInZone : timesInZone) {
             // Find the first time in zone for the session (assumes single-session)
             if (fitTimeInZone.getReferenceMessage() != null && fitTimeInZone.getReferenceMessage() == 18) {
@@ -321,6 +457,10 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
             }
         }
 
+        summaryData.add(TRAINING_LOAD, safeRound(session.getTrainingLoadPeak()), UNIT_NONE);
+        summaryData.add(INTENSITY_FACTOR, session.getIntensityFactor(), UNIT_NONE);
+        summaryData.add(TRAINING_STRESS_SCORE, session.getTrainingStressScore(), UNIT_NONE);
+
         if (!sets.isEmpty()) {
             final boolean anyReps = sets.stream().anyMatch(s -> s.getRepetitions() != null);
             final boolean anyWeight = sets.stream().anyMatch(s -> s.getWeight() != null);
@@ -387,6 +527,14 @@ public class GarminWorkoutParser implements ActivitySummaryParser {
         summary.setSummaryData(summaryData.toString());
     }
 
+    public Number safeRound(final Number number) {
+        if (number == null) {
+            return null;
+        }
+
+        return Math.round(number.doubleValue());
+    }
+
     private static ActivityKind getActivityKind(final Integer sport, final Integer subsport) {
         final Optional<GarminSport> garminSport = GarminSport.fromCodes(sport, subsport);
         if (garminSport.isPresent()) {
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryData.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryData.java
index 3baa9cc1b..65e0b2791 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryData.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryData.java
@@ -75,7 +75,7 @@ public class ActivitySummaryData {
     }
 
     public void add(final String group, final String key, final Number value, final String unit, boolean forceDisplay) {
-        if (value.doubleValue() != 0 || forceDisplay) {
+        if (value != null && (value.doubleValue() != 0 || forceDisplay)) {
             entries.put(key, new ActivitySummarySimpleEntry(group, value, unit));
         }
     }
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
index 983d0922d..2e3351886 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryEntries.java
@@ -66,6 +66,39 @@ public class ActivitySummaryEntries {
     public static final String EVERSION_ANGLE_AVG = "eversionAngleAvg";
     public static final String EVERSION_ANGLE_MAX = "eversionAngleMax";
 
+    public static final String TRAINING_LOAD = "training_load";
+    public static final String STANDING_TIME = "standing_time";
+    public static final String STANDING_COUNT = "standing_count";
+    public static final String AVG_LEFT_PCO = "average_left_platform_center_offset";
+    public static final String AVG_RIGHT_PCO = "average_right_platform_center_offset";
+    public static final String AVG_LEFT_POWER_PHASE = "average_left_power_phase";
+    public static final String AVG_LEFT_POWER_PHASE_PEAK = "average_left_power_phase_peak";
+    public static final String AVG_RIGHT_POWER_PHASE = "average_right_power_phase";
+    public static final String AVG_RIGHT_POWER_PHASE_PEAK = "average_right_power_phase_peak";
+    public static final String AVG_POWER = "average_power";
+    public static final String AVG_POWER_SEATING = "average_power_sitting";
+    public static final String AVG_POWER_STANDING = "average_power_standing";
+    public static final String AVG_CADENCE_SEATING = "average_cadence_sitting";
+    public static final String AVG_CADENCE_STANDING = "average_cadence_standing";
+    public static final String MAX_POWER = "max_power";
+    public static final String MAX_POWER_SEATING = "max_power_sitting";
+    public static final String MAX_POWER_STANDING = "max_power_standing";
+    public static final String MAX_CADENCE_SEATING = "max_cadence_sitting";
+    public static final String MAX_CADENCE_STANDING = "max_cadence_standing";
+    public static final String NORMALIZED_POWER = "normalized_power";
+    public static final String INTENSITY_FACTOR = "intensity_factor";
+    public static final String TRAINING_STRESS_SCORE = "training_stress_score";
+    public static final String LEFT_RIGHT_BALANCE = "left_right_balance";
+    public static final String AVG_PEDAL_SMOOTHNESS = "average_pedal_smoothness";
+    public static final String AVG_TORQUE_EFFECTIVENESS = "average_torque_effectiveness";
+    public static final String FRONT_GEAR_SHIFTS = "front_gear_shifts";
+    public static final String REAR_GEAR_SHIFTS = "rear_gear_shifts";
+
+    public static final String AVG_VERTICAL_OSCILLATION = "vertical_oscillation";
+    public static final String AVG_GROUND_CONTACT_TIME = "ground_contact_time";
+    public static final String AVG_VERTICAL_RATIO = "vertical_ratio";
+    public static final String AVG_GROUND_CONTACT_TIME_BALANCE = "ground_contact_time_balance";
+
     public static final String DISTANCE_METERS = "distanceMeters";
     public static final String POOL_LENGTH = "poolLength";
     public static final String ELEVATION_GAIN = "elevationGain";
@@ -175,6 +208,10 @@ public class ActivitySummaryEntries {
     public static final String UNIT_STRING = "string";
     public static final String UNIT_RAW_STRING = "raw_string";
     public static final String UNIT_KG = "kg";
+    public static final String UNIT_RPM = "unit_rpm";
+    public static final String UNIT_MM = "unit_millimeter";
+    public static final String UNIT_WATT = "unit_watt";
+    public static final String UNIT_JOULE = "unit_joule";
 
     public static final String GROUP_PACE = "Pace";
     public static final String GROUP_ACTIVITY = "Activity";
@@ -183,6 +220,7 @@ public class ActivitySummaryEntries {
     public static final String GROUP_HEART_RATE_ZONES = "HeartRateZones";
     public static final String GROUP_STROKES = "Strokes";
     public static final String GROUP_JUMPS = "Jumps";
+    public static final String GROUP_CYCLING = "cycling";
     public static final String GROUP_SWIMMING = "Swimming";
     public static final String GROUP_TRAINING_EFFECT = "TrainingEffect";
     public static final String GROUP_LAPS = "laps";
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryJsonSummary.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryJsonSummary.java
index 4cffcb72e..684819cda 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryJsonSummary.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/model/ActivitySummaryJsonSummary.java
@@ -170,7 +170,9 @@ public class ActivitySummaryJsonSummary {
             put(GROUP_ACTIVITY, Arrays.asList(
                     DISTANCE_METERS, STEPS, STEP_RATE_SUM, ACTIVE_SECONDS, CALORIES_BURNT,
                     STRIDE_TOTAL, HR_AVG, HR_MAX, HR_MIN, STRIDE_AVG, STRIDE_MAX, STRIDE_MIN,
-                    STEP_LENGTH_AVG
+                    STEP_LENGTH_AVG,
+                    STANDING_TIME, STANDING_COUNT,
+                    AVG_POWER, MAX_POWER, NORMALIZED_POWER
             ));
             put(GROUP_SPEED, Arrays.asList(
                     SPEED_AVG, SPEED_MAX, SPEED_MIN, PACE_AVG_SECONDS_KM, PACE_MIN,
@@ -193,8 +195,21 @@ public class ActivitySummaryJsonSummary {
                     POOL_LENGTH, SWIM_AVG_CADENCE,
                     SWOLF_INDEX, SWOLF_AVG, SWOLF_MAX, SWOLF_MIN, SWIM_STYLE
             ));
+            put(GROUP_CYCLING, Arrays.asList(
+                    LEFT_RIGHT_BALANCE,
+                    AVG_PEDAL_SMOOTHNESS, AVG_TORQUE_EFFECTIVENESS,
+                    AVG_LEFT_PCO, AVG_LEFT_POWER_PHASE, AVG_LEFT_POWER_PHASE_PEAK,
+                    AVG_RIGHT_PCO, AVG_RIGHT_POWER_PHASE, AVG_RIGHT_POWER_PHASE_PEAK,
+                    AVG_POWER_STANDING, MAX_POWER_STANDING,
+                    AVG_POWER_SEATING, MAX_POWER_SEATING,
+                    AVG_CADENCE_STANDING, AVG_CADENCE_SEATING,
+                    MAX_CADENCE_STANDING, MAX_CADENCE_SEATING,
+                    FRONT_GEAR_SHIFTS, REAR_GEAR_SHIFTS
+            ));
             put(GROUP_TRAINING_EFFECT, Arrays.asList(
                     TRAINING_EFFECT_AEROBIC, TRAINING_EFFECT_ANAEROBIC, WORKOUT_LOAD,
+                    TRAINING_LOAD,
+                    INTENSITY_FACTOR, TRAINING_STRESS_SCORE,
                     MAXIMUM_OXYGEN_UPTAKE, RECOVERY_TIME, LACTATE_THRESHOLD_HR
             ));
             put(GROUP_LAPS, Arrays.asList(
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/GlobalFITMessage.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/GlobalFITMessage.java
index c41a798cf..186ec2816 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/GlobalFITMessage.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/GlobalFITMessage.java
@@ -10,7 +10,9 @@ import java.util.Map;
 
 import nodomain.freeyourgadget.gadgetbridge.service.devices.garmin.fit.baseTypes.BaseType;
 
-/** @noinspection ArraysAsListWithZeroOrOneArgument*/
+/**
+ * @noinspection ArraysAsListWithZeroOrOneArgument
+ */
 public class GlobalFITMessage {
     public static GlobalFITMessage FILE_ID = new GlobalFITMessage(0, "FILE_ID", Arrays.asList(
             new FieldDefinitionPrimitive(0, BaseType.ENUM, "type", FieldDefinitionFactory.FIELD.FILE_TYPE),
@@ -103,10 +105,13 @@ public class GlobalFITMessage {
             new FieldDefinitionPrimitive(11, BaseType.UINT16, "total_calories"),
             new FieldDefinitionPrimitive(16, BaseType.UINT8, "average_heart_rate"),
             new FieldDefinitionPrimitive(17, BaseType.UINT8, "max_heart_rate"),
-            new FieldDefinitionPrimitive(18, BaseType.UINT8, "average_cadence"),
-            new FieldDefinitionPrimitive(19, BaseType.UINT8, "max_cadence"),
+            new FieldDefinitionPrimitive(18, BaseType.UINT8, "avg_cadence"), // rpm
+            new FieldDefinitionPrimitive(19, BaseType.UINT8, "max_cadence"), // rpm
+            new FieldDefinitionPrimitive(20, BaseType.UINT16, "avg_power"), // watt
+            new FieldDefinitionPrimitive(21, BaseType.UINT16, "max_power"), // watt
             new FieldDefinitionPrimitive(22, BaseType.UINT16, "total_ascent"),
             new FieldDefinitionPrimitive(23, BaseType.UINT16, "total_descent"),
+            new FieldDefinitionPrimitive(24, BaseType.UINT8, "total_training_effect", 10, 0),
             new FieldDefinitionPrimitive(25, BaseType.UINT16, "first_lap_index"),
             new FieldDefinitionPrimitive(26, BaseType.UINT16, "num_laps"),
             new FieldDefinitionPrimitive(29, BaseType.SINT32, "nec_latitude", FieldDefinitionFactory.FIELD.COORDINATE),
@@ -114,19 +119,53 @@ public class GlobalFITMessage {
             new FieldDefinitionPrimitive(31, BaseType.SINT32, "swc_latitude", FieldDefinitionFactory.FIELD.COORDINATE),
             new FieldDefinitionPrimitive(32, BaseType.SINT32, "swc_longitude", FieldDefinitionFactory.FIELD.COORDINATE),
             new FieldDefinitionPrimitive(33, BaseType.UINT16, "num_lengths"),
+            new FieldDefinitionPrimitive(34, BaseType.UINT16, "normalized_power"), // watt
+            new FieldDefinitionPrimitive(35, BaseType.UINT16, "training_stress_score", 10, 0), // tss
+            new FieldDefinitionPrimitive(36, BaseType.UINT16, "intensity_factor", 1000, 0), // if
+            new FieldDefinitionPrimitive(37, BaseType.UINT16, "left_right_balance"),
             new FieldDefinitionPrimitive(38, BaseType.SINT32, "end_latitude", FieldDefinitionFactory.FIELD.COORDINATE),
             new FieldDefinitionPrimitive(39, BaseType.SINT32, "end_longitude", FieldDefinitionFactory.FIELD.COORDINATE),
             new FieldDefinitionPrimitive(44, BaseType.UINT16, "pool_length", 100, 0), // m
+            new FieldDefinitionPrimitive(45, BaseType.UINT16, "threshold_power"), // watt
             new FieldDefinitionPrimitive(47, BaseType.UINT16, "num_active_lengths"),
+            new FieldDefinitionPrimitive(48, BaseType.UINT32, "total_work"), // joule
             new FieldDefinitionPrimitive(79, BaseType.UINT16, "avg_swim_cadence", 10, 0), // rpm
             new FieldDefinitionPrimitive(80, BaseType.UINT16, "avg_swolf"),
+            new FieldDefinitionPrimitive(89, BaseType.UINT16, "avg_vertical_oscillation", 10, 0), // mm
+            new FieldDefinitionPrimitive(90, BaseType.UINT16, "avg_stance_time_percent", 100, 0), // %
+            new FieldDefinitionPrimitive(91, BaseType.UINT16, "avg_stance_time", 10, 0), // ms
+            new FieldDefinitionPrimitive(92, BaseType.UINT8, "avg_fractional_cadence", 128, 0), // rpm
+            new FieldDefinitionPrimitive(93, BaseType.UINT8, "max_fractional_cadence", 128, 0), // rpm
+            new FieldDefinitionPrimitive(101, BaseType.UINT8, "avg_left_torque_effectiveness", 2, 0), // %
+            new FieldDefinitionPrimitive(102, BaseType.UINT8, "avg_right_torque_effectiveness", 2, 0), // %
+            new FieldDefinitionPrimitive(103, BaseType.UINT8, "avg_left_pedal_smoothness", 2, 0), // %
+            new FieldDefinitionPrimitive(104, BaseType.UINT8, "avg_right_pedal_smoothness", 2, 0), // %
+            new FieldDefinitionPrimitive(107, BaseType.UINT16, "front_shifts"),
+            new FieldDefinitionPrimitive(108, BaseType.UINT16, "rear_shifts"),
             new FieldDefinitionPrimitive(110, BaseType.STRING, 64, "sport_profile_name"),
+            new FieldDefinitionPrimitive(112, BaseType.UINT32, "stand_time"), // s
+            new FieldDefinitionPrimitive(113, BaseType.UINT16, "stand_count"),
+            new FieldDefinitionPrimitive(114, BaseType.SINT8, "avg_left_pco"), // mm
+            new FieldDefinitionPrimitive(115, BaseType.SINT8, "avg_right_pco"), // mm
+            new FieldDefinitionPrimitive(116, BaseType.UINT8, "avg_left_power_phase", FieldDefinitionFactory.FIELD.ARRAY), // degrees (start angle, end angle, arc length, center)
+            new FieldDefinitionPrimitive(117, BaseType.UINT8, "avg_left_power_phase_peak", FieldDefinitionFactory.FIELD.ARRAY), // degrees (start angle, end angle, arc length, center)
+            new FieldDefinitionPrimitive(118, BaseType.UINT8, "avg_right_power_phase", FieldDefinitionFactory.FIELD.ARRAY), // degrees (start angle, end angle, arc length, center)
+            new FieldDefinitionPrimitive(119, BaseType.UINT8, "avg_right_power_phase_peak", FieldDefinitionFactory.FIELD.ARRAY), // degrees (start angle, end angle, arc length, center)
+            new FieldDefinitionPrimitive(120, BaseType.UINT16, "avg_power_position", FieldDefinitionFactory.FIELD.ARRAY), // watt, 2 items (seat / stand)
+            new FieldDefinitionPrimitive(121, BaseType.UINT16, "max_power_position", FieldDefinitionFactory.FIELD.ARRAY), // watt, 2 items (seat / stand)
+            new FieldDefinitionPrimitive(122, BaseType.UINT8, "avg_cadence_position", FieldDefinitionFactory.FIELD.ARRAY), // watt, 2 items (seat / stand)
+            new FieldDefinitionPrimitive(123, BaseType.UINT8, "max_cadence_position", FieldDefinitionFactory.FIELD.ARRAY), // watt, 2 items (seat / stand)
             new FieldDefinitionPrimitive(124, BaseType.UINT32, "enhanced_avg_speed", 1000, 0), // m/s
             new FieldDefinitionPrimitive(125, BaseType.UINT32, "enhanced_max_speed", 1000, 0), // m/s
-            new FieldDefinitionPrimitive(169, BaseType.UINT16, "enhanced_avg_respiration_rate", 100, 0  ), // breaths/min
-            new FieldDefinitionPrimitive(170, BaseType.UINT16, "enhanced_max_respiration_rate", 100, 0  ), // breaths/min
+            new FieldDefinitionPrimitive(132, BaseType.UINT16, "avg_vertical_ratio", 100, 0), // %
+            new FieldDefinitionPrimitive(133, BaseType.UINT16, "avg_stance_time_balance", 100, 0), // %
+            new FieldDefinitionPrimitive(134, BaseType.UINT16, "avg_step_length", 10, 0), // mm
+            new FieldDefinitionPrimitive(137, BaseType.UINT8, "total_anaerobic_training_effect", 10, 0),
+            new FieldDefinitionPrimitive(168, BaseType.SINT32, "training_load_peak", 65536, 0),
+            new FieldDefinitionPrimitive(169, BaseType.UINT16, "enhanced_avg_respiration_rate", 100, 0), // breaths/min
+            new FieldDefinitionPrimitive(170, BaseType.UINT16, "enhanced_max_respiration_rate", 100, 0), // breaths/min
             new FieldDefinitionPrimitive(178, BaseType.UINT16, "estimated_sweat_loss"), // ml
-            new FieldDefinitionPrimitive(180, BaseType.UINT16, "enhanced_min_respiration_rate", 100, 0  ), // breaths/min
+            new FieldDefinitionPrimitive(180, BaseType.UINT16, "enhanced_min_respiration_rate", 100, 0), // breaths/min
             new FieldDefinitionPrimitive(188, BaseType.ENUM, "primary_benefit"), // 1 recovery
             new FieldDefinitionPrimitive(194, BaseType.UINT8, "avg_spo2"),
             new FieldDefinitionPrimitive(195, BaseType.UINT8, "avg_stress"),
@@ -185,6 +224,7 @@ public class GlobalFITMessage {
             new FieldDefinitionPrimitive(78, BaseType.UINT32, "enhanced_altitude", 5, 500), // m
             new FieldDefinitionPrimitive(83, BaseType.UINT16, "vertical_ratio", 100, 0), // %
             new FieldDefinitionPrimitive(85, BaseType.UINT16, "step_length", 10, 0), // mm
+            new FieldDefinitionPrimitive(108, BaseType.UINT16, "enhanced_respiration_rate"),
             new FieldDefinitionPrimitive(136, BaseType.UINT8, "wrist_heart_rate"),
             new FieldDefinitionPrimitive(143, BaseType.UINT8, "body_battery"),
             new FieldDefinitionPrimitive(253, BaseType.UINT32, "timestamp", FieldDefinitionFactory.FIELD.TIMESTAMP)
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitRecord.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitRecord.java
index 823e52bfa..f79e0c314 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitRecord.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitRecord.java
@@ -105,6 +105,11 @@ public class FitRecord extends RecordData {
         return (Float) getFieldByNumber(85);
     }
 
+    @Nullable
+    public Integer getEnhancedRespirationRate() {
+        return (Integer) getFieldByNumber(108);
+    }
+
     @Nullable
     public Integer getWristHeartRate() {
         return (Integer) getFieldByNumber(136);
diff --git a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitSession.java b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitSession.java
index 810d5b661..14fffc506 100644
--- a/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitSession.java
+++ b/app/src/main/java/nodomain/freeyourgadget/gadgetbridge/service/devices/garmin/fit/messages/FitSession.java
@@ -91,7 +91,7 @@ public class FitSession extends RecordData {
     }
 
     @Nullable
-    public Integer getAverageCadence() {
+    public Integer getAvgCadence() {
         return (Integer) getFieldByNumber(18);
     }
 
@@ -100,6 +100,16 @@ public class FitSession extends RecordData {
         return (Integer) getFieldByNumber(19);
     }
 
+    @Nullable
+    public Integer getAvgPower() {
+        return (Integer) getFieldByNumber(20);
+    }
+
+    @Nullable
+    public Integer getMaxPower() {
+        return (Integer) getFieldByNumber(21);
+    }
+
     @Nullable
     public Integer getTotalAscent() {
         return (Integer) getFieldByNumber(22);
@@ -110,6 +120,11 @@ public class FitSession extends RecordData {
         return (Integer) getFieldByNumber(23);
     }
 
+    @Nullable
+    public Float getTotalTrainingEffect() {
+        return (Float) getFieldByNumber(24);
+    }
+
     @Nullable
     public Integer getFirstLapIndex() {
         return (Integer) getFieldByNumber(25);
@@ -145,6 +160,26 @@ public class FitSession extends RecordData {
         return (Integer) getFieldByNumber(33);
     }
 
+    @Nullable
+    public Integer getNormalizedPower() {
+        return (Integer) getFieldByNumber(34);
+    }
+
+    @Nullable
+    public Float getTrainingStressScore() {
+        return (Float) getFieldByNumber(35);
+    }
+
+    @Nullable
+    public Float getIntensityFactor() {
+        return (Float) getFieldByNumber(36);
+    }
+
+    @Nullable
+    public Integer getLeftRightBalance() {
+        return (Integer) getFieldByNumber(37);
+    }
+
     @Nullable
     public Double getEndLatitude() {
         return (Double) getFieldByNumber(38);
@@ -160,11 +195,21 @@ public class FitSession extends RecordData {
         return (Float) getFieldByNumber(44);
     }
 
+    @Nullable
+    public Integer getThresholdPower() {
+        return (Integer) getFieldByNumber(45);
+    }
+
     @Nullable
     public Integer getNumActiveLengths() {
         return (Integer) getFieldByNumber(47);
     }
 
+    @Nullable
+    public Long getTotalWork() {
+        return (Long) getFieldByNumber(48);
+    }
+
     @Nullable
     public Float getAvgSwimCadence() {
         return (Float) getFieldByNumber(79);
@@ -175,11 +220,166 @@ public class FitSession extends RecordData {
         return (Integer) getFieldByNumber(80);
     }
 
+    @Nullable
+    public Float getAvgVerticalOscillation() {
+        return (Float) getFieldByNumber(89);
+    }
+
+    @Nullable
+    public Float getAvgStanceTimePercent() {
+        return (Float) getFieldByNumber(90);
+    }
+
+    @Nullable
+    public Float getAvgStanceTime() {
+        return (Float) getFieldByNumber(91);
+    }
+
+    @Nullable
+    public Float getAvgFractionalCadence() {
+        return (Float) getFieldByNumber(92);
+    }
+
+    @Nullable
+    public Float getMaxFractionalCadence() {
+        return (Float) getFieldByNumber(93);
+    }
+
+    @Nullable
+    public Float getAvgLeftTorqueEffectiveness() {
+        return (Float) getFieldByNumber(101);
+    }
+
+    @Nullable
+    public Float getAvgRightTorqueEffectiveness() {
+        return (Float) getFieldByNumber(102);
+    }
+
+    @Nullable
+    public Float getAvgLeftPedalSmoothness() {
+        return (Float) getFieldByNumber(103);
+    }
+
+    @Nullable
+    public Float getAvgRightPedalSmoothness() {
+        return (Float) getFieldByNumber(104);
+    }
+
+    @Nullable
+    public Integer getFrontShifts() {
+        return (Integer) getFieldByNumber(107);
+    }
+
+    @Nullable
+    public Integer getRearShifts() {
+        return (Integer) getFieldByNumber(108);
+    }
+
     @Nullable
     public String getSportProfileName() {
         return (String) getFieldByNumber(110);
     }
 
+    @Nullable
+    public Long getStandTime() {
+        return (Long) getFieldByNumber(112);
+    }
+
+    @Nullable
+    public Integer getStandCount() {
+        return (Integer) getFieldByNumber(113);
+    }
+
+    @Nullable
+    public Integer getAvgLeftPco() {
+        return (Integer) getFieldByNumber(114);
+    }
+
+    @Nullable
+    public Integer getAvgRightPco() {
+        return (Integer) getFieldByNumber(115);
+    }
+
+    @Nullable
+    public Number[] getAvgLeftPowerPhase() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(116);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getAvgLeftPowerPhasePeak() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(117);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getAvgRightPowerPhase() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(118);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getAvgRightPowerPhasePeak() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(119);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getAvgPowerPosition() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(120);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getMaxPowerPosition() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(121);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getAvgCadencePosition() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(122);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
+    @Nullable
+    public Number[] getMaxCadencePosition() {
+        final Object[] objectsArray = (Object[]) getFieldByNumber(123);
+        final Number[] ret = new Number[objectsArray.length];
+        for (int i = 0; i < objectsArray.length; i++) {
+            ret[i] = (Number) objectsArray[i];
+        }
+        return ret;
+    }
+
     @Nullable
     public Double getEnhancedAvgSpeed() {
         return (Double) getFieldByNumber(124);
@@ -190,6 +390,31 @@ public class FitSession extends RecordData {
         return (Double) getFieldByNumber(125);
     }
 
+    @Nullable
+    public Float getAvgVerticalRatio() {
+        return (Float) getFieldByNumber(132);
+    }
+
+    @Nullable
+    public Float getAvgStanceTimeBalance() {
+        return (Float) getFieldByNumber(133);
+    }
+
+    @Nullable
+    public Float getAvgStepLength() {
+        return (Float) getFieldByNumber(134);
+    }
+
+    @Nullable
+    public Float getTotalAnaerobicTrainingEffect() {
+        return (Float) getFieldByNumber(137);
+    }
+
+    @Nullable
+    public Double getTrainingLoadPeak() {
+        return (Double) getFieldByNumber(168);
+    }
+
     @Nullable
     public Float getEnhancedAvgRespirationRate() {
         return (Float) getFieldByNumber(169);
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
index 83ace7874..9d0d3dc98 100644
--- a/app/src/main/res/values/strings.xml
+++ b/app/src/main/res/values/strings.xml
@@ -39,6 +39,8 @@
     <string name="controlcenter_find_device">Find lost device</string>
     <string name="search">Search</string>
     <string name="find_lost_device_message">Search for %1$s?</string>
+    <string name="range_percentage">%1$d%% - %2$d%%</string>
+    <string name="range_degrees">%1$dº - %2$dº</string>
     <string name="controlcenter_take_screenshot">Take Screenshot</string>
     <string name="controlcenter_power_off">Power Off</string>
     <string name="controlcenter_power_off_confirm_title">Power Off</string>
@@ -2268,6 +2270,7 @@
     <string name="hrv_rmssd">HRV RMSSD</string>
     <string name="breaths_per_min">breaths/min</string>
     <string name="TrainingEffect">Training Effect</string>
+    <string name="cycling">Cycling</string>
     <string name="aerobicTrainingEffect">Aerobic Effect</string>
     <string name="anaerobicTrainingEffect">Anaerobic Effect</string>
     <string name="currentWorkoutLoad">Workout Load</string>
@@ -2351,6 +2354,40 @@
     <string name="unit_revolutions">revs</string>
     <string name="unit_repetitions_per_minute">reps/min</string>
     <string name="unit_revolutions_per_minute">revs/min</string>
+    <string name="unit_rpm">rpm</string>
+    <string name="unit_millimeter">mm</string>
+    <string name="unit_watt">Watt</string>
+    <string name="unit_joule">Joule</string>
+    <string name="training_load">Training Load</string>
+    <string name="standing_count">Standing count</string>
+    <string name="average_left_platform_center_offset">Avg Left Platform Center Offset</string>
+    <string name="average_right_platform_center_offset">Avg Right Platform Center Offset</string>
+    <string name="average_left_power_phase">Avg Left Power Phase</string>
+    <string name="average_left_power_phase_peak">Avg Left Power Phase Peak</string>
+    <string name="average_right_power_phase">Avg Right Power Phase</string>
+    <string name="average_right_power_phase_peak">Avg Right Power Phase Peak</string>
+    <string name="average_power">Average Power</string>
+    <string name="average_power_sitting">Avg Power (Sitting)</string>
+    <string name="average_power_standing">Avg Power (Standing)</string>
+    <string name="average_cadence_sitting">Avg Cadence (Sitting)</string>
+    <string name="average_cadence_standing">Avg Cadence (Standing)</string>
+    <string name="max_power">Max Power</string>
+    <string name="max_power_sitting">Max Power (Sitting)</string>
+    <string name="max_power_standing">Max Power (Standing)</string>
+    <string name="max_cadence_sitting">Max Cadence (Sitting)</string>
+    <string name="max_cadence_standing">Max Cadence (Standing)</string>
+    <string name="normalized_power">Normalized power</string>
+    <string name="intensity_factor">Intensity Factor (IF)</string>
+    <string name="training_stress_score">Training Stress Score (TSS)</string>
+    <string name="left_right_balance">Balance</string>
+    <string name="average_pedal_smoothness">Smoothness</string>
+    <string name="average_torque_effectiveness">Torque Effectiveness</string>
+    <string name="front_gear_shifts">Front shifts</string>
+    <string name="rear_gear_shifts">Rear shifts</string>
+    <string name="vertical_oscillation">Vertical Oscillation</string>
+    <string name="ground_contact_time">Ground Contact Time</string>
+    <string name="vertical_ratio">Vertical Ratio</string>
+    <string name="ground_contact_time_balance">Ground Contact Time Balance</string>
     <string name="workout_repetitions">Repetitions</string>
     <string name="workout_revolutions">Revolutions</string>
     <string name="seconds">sec</string>
```
-----------------------------------
